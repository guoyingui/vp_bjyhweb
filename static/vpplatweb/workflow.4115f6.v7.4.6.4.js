webpackJsonp([1,7,8,9,10],{949:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function l(){return[{name:"全部",value:"alltime"},{name:"已超时",value:"overtime"},{name:"未超时",value:"innotime"}]}function i(){return[{name:"全部",value:""},{name:"运行中",value:"unfinished"},{name:"已完成",value:"finished"},{name:"已终止",value:"deleted"}]}function o(){return[{name:"全部",value:""},{name:"运行中",value:"unfinished"},{name:"已完成",value:"finished"},{name:"已终止",value:"deleted"}]}function r(){return[{name:"全部",value:""},{name:"已生效授权",value:"valid"},{name:"未生效授权",value:"novalid"},{name:"已失效授权",value:"invalid"}]}Object.defineProperty(t,"__esModule",{value:!0});var s=a(688),c=n(s),u=a(54),d=n(u),p=a(55),f=n(p),m=a(59),h=n(m),v=a(93),k=n(v),g=a(8),y=n(g),w=a(4),b=a(652);a(950);var E=a(952),C=n(E),S=a(953),V=n(S),x=a(954),I=n(x),N=a(955),T=n(N),R=a(956),M=n(R),D=function(e){function t(e){(0,d["default"])(this,t);var a=(0,h["default"])(this,(t.__proto__||(0,c["default"])(t)).call(this,e));return a.queryFilter=function(){var e=a.state.tab,t=[];t="1"==e?l():"2"==e?i():o(),a.setState({filterData:t})},a.queryFilter2=function(){var e=a.state.current,t=[];t="1"==e?l():"2"==e?i():o(),a.setState({filterData:t})},a.filterChange=function(e){a.setState({filtervalue:e.target.value})},a.handlesearch=function(e){var t=e.replace(/\s/g,"");a.setState({quickvalue:t})},a.tabsChange=function(e){a.setState({tab:e},function(){a.queryFilter()})},a.shrinkLeft=function(e){a.setState({shrinkShow:!a.state.shrinkShow},function(){})},a.handleClick=function(e){a.setState({current:e.key,openKeys:e.keyPath.slice(1),currentkey:e.keyPath.slice(1)[0]})},a.onToggle=function(e){a.setState({openKeys:e.open?e.keyPath:e.keyPath.slice(1)})},a.toolBarAddClick=function(){a.setState({visible:!0})},a.cancelModal=function(){a.setState({visible:!1})},a.okModal=function(){a.table.getTableData()},a.batchSelect=function(){a.processflow.batchSelect()},a.state={filtervalue:"",quickvalue:"",filterData:[],tab:"1",current:"alltime",openKeys:["sub1"],shrinkShow:!0,currentkey:"sub1",visible:!1},a}return(0,k["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){if(this.props.location.state!=undefined){var e=this.props.location.state.currentkey;if(""!=e&&e!=undefined&&null!=e){var t="sub1"==e?"alltime":"";this.setState({currentkey:e,openKeys:[e],current:t})}}}},{key:"componentDidMount",value:function(){this.queryFilter()}},{key:"render",value:function(){var e=this;return y["default"].createElement("div",{className:"business-container pr full-height workflow"},y["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},y["default"].createElement(w.VpRow,{gutter:10},y["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:4},y["default"].createElement("div",{className:"m-b-sm search"},y["default"].createElement(b.SeachInput,{onSearch:this.handlesearch}))),y["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:20},"sub1"==this.state.currentkey?y["default"].createElement(w.VpTooltip,{placement:"top",title:"批量审批"},y["default"].createElement(w.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",onClick:function(){return e.batchSelect()}},y["default"].createElement(w.VpIcon,{className:"m-r-xs",type:"vpicon-users"}))):"","sub4"==this.state.currentkey?y["default"].createElement("div",{style:{display:"inline-block"},onClick:function(){return e.toolBarAddClick()}},y["default"].createElement(b.QuickCreate,null)):""))),y["default"].createElement("div",{className:"business-wrapper p-t-sm full-height"},y["default"].createElement("div",{className:"bg-white p-sm full-height"},y["default"].createElement(w.VpRow,{gutter:16,className:"full-height"},y["default"].createElement(w.VpCol,{span:this.state.shrinkShow?"4":"0",className:"full-height pr menuleft"},y["default"].createElement(w.VpMenu,{className:"full-height scroll-y",onClick:this.handleClick,openKeys:this.state.openKeys,onOpen:this.onToggle,onClose:this.onToggle,selectedKeys:[this.state.current],mode:"inline"},y["default"].createElement(w.VpSubMenu,{key:"sub1",title:y["default"].createElement("span",null,y["default"].createElement(w.VpIconFont,{type:"vpicon-clock",className:"m-r-xs"}),y["default"].createElement("span",null,"待处理"))},l().map(function(e,t){return y["default"].createElement(w.VpMenuItem,{key:e.value},e.name)})),y["default"].createElement(w.VpSubMenu,{key:"sub2",title:y["default"].createElement("span",null,y["default"].createElement(w.VpIconFont,{type:"vpicon-check-circle-o",className:"m-r-xs"}),y["default"].createElement("span",null,"已处理"))},i().map(function(e,t){return y["default"].createElement(w.VpMenuItem,{key:e.value},e.name)})),y["default"].createElement(w.VpSubMenu,{key:"sub3",title:y["default"].createElement("span",null,y["default"].createElement(w.VpIconFont,{type:"vpicon-clock",className:"m-r-xs"}),y["default"].createElement("span",null,"我发起"))},o().map(function(e,t){return y["default"].createElement(w.VpMenuItem,{key:e.value},e.name)})),y["default"].createElement(w.VpSubMenu,{key:"sub4",title:y["default"].createElement("span",null,y["default"].createElement(w.VpIconFont,{type:"vpicon-users",className:"m-r-xs"}),y["default"].createElement("span",null,"我授权"))},r().map(function(e,t){return y["default"].createElement(w.VpMenuItem,{key:e.value},e.name)}))),this.state.shrinkShow?y["default"].createElement("div",{className:"navswitch cursor text-center",onClick:this.shrinkLeft},y["default"].createElement(w.VpIconFont,{type:"vpicon-navclose"})):""),y["default"].createElement(w.VpCol,{span:this.state.shrinkShow?"20":"24",className:"full-height scroll-y"},this.state.shrinkShow?null:y["default"].createElement("div",{className:"shrink p-tb-sm cursor text-center",onClick:this.shrinkLeft},y["default"].createElement(w.VpIconFont,{type:"vpicon-navopen"})),"sub1"==this.state.currentkey?y["default"].createElement(C["default"],{setBreadCrumb:function(t){e.props.setBreadCrumb(t)},setBreadCrumb2:function(){return e.props.setBreadCrumb()},batchSelect:function(t){e.processflow=t},filtervalue:this.state.current,quickvalue:this.state.quickvalue}):"sub2"==this.state.currentkey?y["default"].createElement(I["default"],{setBreadCrumb:function(t){e.props.setBreadCrumb(t)},setBreadCrumb2:function(){return e.props.setBreadCrumb()},filtervalue:this.state.current,quickvalue:this.state.quickvalue}):"sub3"==this.state.currentkey?y["default"].createElement(V["default"],{setBreadCrumb:function(t){e.props.setBreadCrumb(t)},setBreadCrumb2:function(){return e.props.setBreadCrumb()},filtervalue:this.state.current,quickvalue:this.state.quickvalue}):"sub4"==this.state.currentkey?y["default"].createElement(T["default"],{bindTable:function(t){return e.table=t},filtervalue:this.state.current,quickvalue:this.state.quickvalue}):"")))),y["default"].createElement(b.RightBox,{show:this.state.visible,button:y["default"].createElement("div",{className:"icon p-xs",onClick:function(){return e.cancelModal()}},y["default"].createElement(w.VpTooltip,{placement:"top",title:""},y["default"].createElement(w.VpIcon,{type:"right"})))},y["default"].createElement(M["default"],{okModal:function(){return e.okModal()},cancelModal:function(){return e.cancelModal()}})))}}]),t}(g.Component);t["default"]=D=(0,w.VpFormCreate)(D)},950:function(e,t,a){var n=a(951);"string"==typeof n&&(n=[[e.id,n,""]]);var l={hmr:!0};l.transform=void 0;a(439)(n,l);n.locals&&(e.exports=n.locals)},951:function(e,t){},952:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(155),i=n(l),o=a(688),r=n(o),s=a(54),c=n(s),u=a(55),d=n(u),p=a(59),f=n(p),m=a(93),h=n(m),v=a(8),k=n(v),g=a(4),y=a(826),w=n(y),b=a(919),E=n(b),C=a(652),S=function(e){function t(e){(0,c["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.getHeader=function(){var e=[{title:"状态",dataIndex:"taskState",key:"taskState",width:50,render:function(e,t){return k["default"].createElement("span",null,0==t.taskState?k["default"].createElement(g.VpTooltip,{placement:"top",title:"未超时"},k["default"].createElement(g.VpIcon,{className:"m-r-xs",type:"vpicon-clock"})):k["default"].createElement(g.VpTooltip,{placement:"top",title:"已超时"},k["default"].createElement(g.VpIcon,{className:"m-r-xs",type:"vpicon-handle"})))}},{title:"流程名称",dataIndex:"flowName",key:"flowName",sorter:function(e,t){return e.flowName.localeCompare(t.flowName)}},{title:"流程版本",dataIndex:"version",key:"version",sorter:function(e,t){return e.version.localeCompare(t.version)}},{title:"对象名称",dataIndex:"objectName",key:"objectName",sorter:function(e,t){return e.objectName.localeCompare(t.objectName)}},{title:"当前步骤",dataIndex:"taskName",key:"taskName",sorter:function(e,t){return e.taskName.localeCompare(t.taskName)}},{title:"到达时间",dataIndex:"createTime",key:"createTime",sorter:function(e,t){return e.createTime.localeCompare(t.createTime)}},{title:"发起人",dataIndex:"startUsername",key:"startUsername",sorter:function(e,t){return e.startUsername.localeCompare(t.startUsername)}},{title:"发起时间",dataIndex:"startTime",key:"startTime",sorter:function(e,t){return e.startTime.localeCompare(t.startTime)}}];e.push({title:"操作",fixed:"right",width:120,key:"operation",render:function(e,t){return k["default"].createElement("div",{className:"full-height"},k["default"].createElement(g.VpTooltip,{placement:"top",title:"查看"},k["default"].createElement(g.VpIconFont,{onClick:function(e){return a.viewTaskClick(e,t)},className:"cursor text-primary m-lr-xs",type:"vpicon-see-o"})),null==t.assign||""==t.assign?"":k["default"].createElement(g.VpTooltip,{placement:"top",title:"归还"},k["default"].createElement(g.VpIconFont,{onClick:function(e){return a.returnTaskClick(e,t)},className:"cursor text-primary m-lr-xs",type:"vpicon-chehui"})))}}),a.setState({tableHeader:e})},a.onSelectChange=function(e,t){var n=t.map(function(e){return e.taskId}).join();a.setState({selectedRowKeys:e,selectedRows:t,taskids:n})},a.batchSelect=function(){var e=!0,t="";return 0==a.state.selectedRows.length?void(0,g.VpAlertMsg)({message:"消息提示",description:"请选择相关记录!",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5):(a.state.selectedRows.map(function(a){""==t&&(t=a.pdId+a.stepkey),a.pdId+a.stepkey!=t&&(e=!1)}),e?(a.setState({showFlowBatch:!0}),void a.props.setBreadCrumb(a.state.selectedRows[0].flowName)):void(0,g.VpAlertMsg)({message:"消息提示",description:"请选择相同版本相同步骤批量提交!",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5))},a.getData=function(){(0,g.vpQuery)("/{vpflow}/rest/process/processflow",{curr:a.state.curr,limit:a.state.limit,quickvalue:a.state.quickvalue,filtervalue:a.state.filtervalue}).then(function(e){if(e.data==undefined)return void(0,g.VpAlertMsg)({message:"消息提示",description:e.msg,type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);var t=e.data,n=function(){return"共"+t.count+"条"},l=vp.computedHeight(t.count,".processflow");a.setState({tableHeight:l,tableData:t.result,curr:t.curr,total_rows:t.count,limit:t.limit,pagination:{total:t.count,showTotal:n,pageSize:t.limit,onShowSizeChange:a.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})},a.onShowSizeChange=function(e){},a.handlesearch=function(e){var t=e.replace(/\s/g,"");a.setState({quickvalue:t},function(){a.getData()})},a.tableChange=function(e,t,n){var l="";"descend"===n.order?l="desc":"ascend"===n.order&&(l="asc"),a.setState({curr:e.current||a.state.curr,sortfield:n.field,sorttype:l,limit:e.pageSize||a.state.limit},function(){a.getData()})},a.closeRightModal=function(){a.setState({showRightBox:!1,showFlowBatch:!1,increaseData:{}},function(){a.getData()}),a.props.setBreadCrumb()},a.tabsChange=function(e){a.state.tabs_array[e]},a.filterChange=function(e){a.setState({filtervalue:e.target.value},function(){a.getData()})},a.cancelModal=function(){a.setState({visible:!1})},a.closeRight=function(e){a.setState({showFlowBatch:e,showRightBox:e,staskid:""}),a.props.setBreadCrumb2()},a.returnTaskClick=function(e,t){e.stopPropagation(),(0,g.vpAdd)("/{vpflow}/rest/task/return-task",{taskId:t.taskId}).then(function(e){a.getData()})},a.viewTaskClick=function(e,t){a.onRowClick(t)},a.onRowClick=function(e){(0,g.vpQuery)("/{vpflow}/rest/process/task-info",{taskId:e.taskId}).then(function(t){if(t.data==undefined)return void(0,g.VpAlertMsg)({message:"消息提示",description:t.msg,type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);var n=t.data;a.setState((0,i["default"])({showRightBox:!0,operrole:n.operrole,record:n.record,staskid:n.taskId,iid:n.objectId,usermode:2!=n.usermode,entityid:n.entityId},"iid",n.objectId)),a.props.setBreadCrumb(e.flowName)})},a.addNewDom=function(){var e=a.state.record;return k["default"].createElement(w["default"],{activityName:e.activityName,usermode:a.state.usermode,operrole:a.state.operrole,stepkey:e.activityId,staskid:a.state.staskid,piid:e.piId,pdid:e.pdId,iobjectentityid:a.state.entityid,iobjectid:a.state.iid,entityid:e.iflowentityid,endTime:e.endTime,closeRight:function(e){return a.closeRight(e)},getData:function(){return a.getData()}})},a.state={tableHeader:[],tableData:[],curr:1,limit:10,filtervalue:"",quickvalue:"",showRightBox:!1,showFlowBatch:!1,total_rows:"",pagination:{},visible:!1,staskid:"",entityid:"",iid:"",record:{},usermode:"",tableHeight:"",selectedRowKeys:[],selectedRows:[]},a}return(0,h["default"])(t,e),(0,d["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({filtervalue:e.filtervalue,quickvalue:e.quickvalue},function(){t.getData()})}},{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){this.props.batchSelect(this)}},{key:"render",value:function(){var e=this,t={onChange:this.onSelectChange};return k["default"].createElement("div",{className:"full-height"},k["default"].createElement(g.VpTable,{className:"processflow",rowSelection:t,rowKey:function(e){return e.taskId},columns:this.state.tableHeader,dataSource:this.state.tableData,onChange:this.tableChange,pagination:this.state.pagination,onRowClick:this.onRowClick,scroll:{y:this.state.tableHeight},resize:!0}),k["default"].createElement(C.RightBox,{max:!0,button:k["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightModal},k["default"].createElement(g.VpTooltip,{placement:"top",title:""},k["default"].createElement(g.VpIcon,{type:"right"}))),tips:k["default"].createElement("div",{className:"tips p-xs"},k["default"].createElement(g.VpTooltip,{placement:"top",title:"0000"},k["default"].createElement(g.VpIcon,{type:"exclamation-circle text-muted m-r-xs"}))),show:this.state.showRightBox||this.state.showFlowBatch},this.state.showRightBox?this.addNewDom():null,this.state.showFlowBatch?k["default"].createElement(E["default"],{taskids:this.state.taskids,closeRight:function(){return e.closeRightModal()},getData:function(){return e.getData()}}):null))}}]),t}(v.Component);t["default"]=S=(0,g.VpFormCreate)(S)},953:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(14),i=n(l),o=a(688),r=n(o),s=a(54),c=n(s),u=a(55),d=n(u),p=a(59),f=n(p),m=a(93),h=n(m),v=a(8),k=n(v),g=a(4),y=a(826),w=n(y),b=a(652),E=function(e){function t(e){(0,c["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.getHeader=function(){var e=[{title:"状态",dataIndex:"taskState",key:"taskState",width:80,render:function(e,t){var a="";return-1==t.taskState&&(a=k["default"].createElement(g.VpTooltip,{placement:"top",title:"进行中 已超时"},k["default"].createElement(g.VpIcon,{className:"m-r-xs",type:"vpicon-handle"}))),0==t.taskState?a=k["default"].createElement(g.VpTooltip,{placement:"top",title:"进行中 未超时"},k["default"].createElement(g.VpIcon,{className:"m-r-xs",type:"vpicon-clock"})):1==t.taskState?a=k["default"].createElement(g.VpTooltip,{placement:"top",title:"已终止"},k["default"].createElement(g.VpIcon,{className:"m-r-xs",type:"vpicon-close"})):2==t.taskState&&(a=k["default"].createElement(g.VpTooltip,{placement:"top",title:"已完成"},k["default"].createElement(g.VpIcon,{className:"m-r-xs",type:"vpicon-check"}))),k["default"].createElement("span",null,a)}},{title:"流程名称",dataIndex:"flowName",key:"flowName"},{title:"对象名称",dataIndex:"objectName",key:"objectName"},{title:"当前步骤",dataIndex:"activityName",key:"activityName"},{title:"发起时间",dataIndex:"startTime",key:"startTime"},{title:"处理人",dataIndex:"handlers",key:"handlers"},{title:"到达时间",dataIndex:"createTime",key:"createTime"}];e.push({title:"操作",fixed:"right",width:120,key:"operation",render:function(e,t){return k["default"].createElement("span",null,k["default"].createElement(g.VpTooltip,{placement:"top",title:"查看"},k["default"].createElement(g.VpIconFont,{className:"cursor text-primary m-lr-xs",type:"vpicon-see-o"})),null!=t.endTime?"":k["default"].createElement("span",null,k["default"].createElement(g.VpTooltip,{placement:"top",title:"终止"},k["default"].createElement(g.VpIconFont,{onClick:function(e){return a.handleStop(e,t)},className:"cursor text-primary m-lr-xs",type:"vpicon-stop"})),k["default"].createElement(g.VpTooltip,{placement:"top",title:"催办"},k["default"].createElement(g.VpIconFont,{onClick:function(e){return a.handleUrge(e,t)},className:"cursor text-primary m-lr-xs",type:"vpicon-msgs"}))))}}),a.setState({tableHeader:e})},a.getData=function(){(0,g.vpQuery)("/{vpflow}/rest/process/myflow",{curr:a.state.curr,limit:a.state.limit,quickvalue:a.state.quickvalue,filtervalue:a.state.filtervalue}).then(function(e){var t=e.data,n=function(){return"共"+t.count+"条"},l=vp.computedHeight(t.count,".myflow");a.setState({tableHeight:l,tableData:t.result,curr:t.curr,total_rows:t.count,limit:t.limit,pagination:{total:t.count,showTotal:n,pageSize:t.limit,onShowSizeChange:a.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})},a.onShowSizeChange=function(e){},a.handleStop=function(e,t){e.stopPropagation();var n={pdId:t.pdId,piId:t.piId};(0,g.vpQuery)("/{vpflow}/rest/process/end-process",(0,i["default"])({},n)).then(function(e){a.getData()})},a.handleUrge=function(e,t){e.stopPropagation();var n={pdId:t.pdId,piId:t.piId};(0,g.vpQuery)("/{vpflow}/rest/process/urge-process",(0,i["default"])({},n)).then(function(e){if(e.data==undefined)return void(0,g.VpAlertMsg)({message:"消息提示",description:e.msg,type:"error",closeText:"关闭",showIcon:!0},5);(0,g.VpAlertMsg)({message:"消息提示",description:"催办成功!",type:"success",onClose:a.onClose,closeText:"关闭",showIcon:!0},5),a.getData()})},a.handlesearch=function(e){var t=e.replace(/\s/g,"");a.setState({quickvalue:t},function(){a.getData()})},a.tableChange=function(e,t,n){var l="";"descend"===n.order?l="desc":"ascend"===n.order&&(l="asc"),a.setState({curr:e.current||a.state.curr,sortfield:n.field,sorttype:l,limit:e.pageSize||a.state.limit},function(){a.getData()})},a.closeRightModal=function(){a.setState({showRightBox:!1,increaseData:{}}),a.props.setBreadCrumb2()},a.tabsChange=function(e){a.state.tabs_array[e]},a.filterChange=function(e){a.setState({filtervalue:e.target.value},function(){a.getData()})},a.cancelModal=function(){a.setState({visible:!1})},a.closeRight=function(e){a.setState({showRightBox:e,staskid:""})},a.onRowClick=function(e,t){var n=e.piId;(0,g.vpQuery)("/{vpflow}/rest/process/activitytask",{piId:n}).then(function(t){var n=t.data.taskId||"",l=t.data.formkey||"",i=t.data.usermode||"",o=t.data.entityId||"",r=t.data.objectId||"",s=t.data.record||{piId:e.piId,pdId:e.pdId,endTime:e.endTime};a.setState({showRightBox:!0,record:s,staskid:n,iid:r,usermode:2!=i,entityid:o,formkey:l}),a.props.setBreadCrumb(e.flowName)})},a.addNewDom=function(){var e=a.state.record;return k["default"].createElement(w["default"],{usermode:a.state.usermode,stepkey:e.activityId,staskid:a.state.staskid,piid:e.piId,pdid:e.pdId,iobjectentityid:a.state.entityid,iobjectid:a.state.iid,entityid:e.iflowentityid,endTime:e.endTime,formkey:a.state.formkey,closeRight:function(e){return a.closeRight(e)},getData:function(){return a.getData()}})},a.state={tableHeader:[],tableData:[],curr:1,limit:10,filtervalue:"",quickvalue:"",showRightBox:!1,total_rows:"",pagination:{},visible:!1,staskid:"",entityid:"",iid:"",record:{},usermode:"",formkey:"",tableHeight:0},a}return(0,h["default"])(t,e),(0,d["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({filtervalue:e.filtervalue,quickvalue:e.quickvalue},function(){t.getData()})}},{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){var e=$(window).height()-255;$(".myflow").find(".ant-table-body").css({height:e})}},{key:"render",value:function(){return k["default"].createElement("div",{className:"full-height"},k["default"].createElement(g.VpTable,{className:"myflow",columns:this.state.tableHeader,dataSource:this.state.tableData,onChange:this.tableChange,pagination:this.state.pagination,onRowClick:this.onRowClick,scroll:{y:this.state.tableHeight},resize:!0}),k["default"].createElement(b.RightBox,{max:!0,button:k["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightModal},k["default"].createElement(g.VpTooltip,{placement:"top",title:""},k["default"].createElement(g.VpIcon,{type:"right"}))),tips:k["default"].createElement("div",{className:"tips p-xs"},k["default"].createElement(g.VpTooltip,{placement:"top",title:"0000"},k["default"].createElement(g.VpIcon,{type:"exclamation-circle text-muted m-r-xs"}))),show:this.state.showRightBox},this.state.showRightBox?this.addNewDom():null))}}]),t}(v.Component);t["default"]=E=(0,g.VpFormCreate)(E)},954:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(688),i=n(l),o=a(54),r=n(o),s=a(55),c=n(s),u=a(59),d=n(u),p=a(93),f=n(p),m=a(8),h=n(m),v=a(4),k=a(826),g=n(k),y=a(652),w=function(e){function t(e){(0,r["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.getHeader=function(){var e=[{title:"状态",dataIndex:"taskState",key:"taskState",width:80,render:function(e,t){var a="";return-1==t.taskState&&(a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"进行中 已超时"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-handle"}))),0==t.taskState?a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"进行中 未超时"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-clock"})):1==t.taskState?a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"已终止"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-close"})):2==t.taskState&&(a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"已完成"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-check"}))),h["default"].createElement("span",null,a)}},{title:"流程名称",dataIndex:"flowName",key:"flowName"},{title:"对象名称",dataIndex:"objectName",key:"objectName"},{title:"当前步骤",dataIndex:"activityName",key:"activityName"},{title:"发起时间",dataIndex:"startTime",key:"startTime"},{title:"处理人",dataIndex:"handlers",key:"handlers"},{title:"到达时间",dataIndex:"createTime",key:"createTime"}];e.push({title:"操作",fixed:"right",width:120,key:"operation",render:function(e,t){return h["default"].createElement("span",null,h["default"].createElement(v.VpTooltip,{placement:"top",title:"查看"},h["default"].createElement(v.VpIconFont,{className:"cursor text-primary m-lr-xs",type:"vpicon-see-o"})))}}),a.setState({tableHeader:e})},a.getData=function(){(0,v.vpQuery)("/{vpflow}/rest/process/processedflow",{curr:a.state.curr,limit:a.state.limit,quickvalue:a.state.quickvalue,filtervalue:a.state.filtervalue}).then(function(e){var t=e.data,n=function(){return"共"+t.count+"条"},l=vp.computedHeight(t.count,".processedflow");a.setState({tableHeight:l,tableData:t.result,curr:t.curr,total_rows:t.count,limit:t.limit,pagination:{total:t.count,showTotal:n,pageSize:t.limit,onShowSizeChange:a.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})},a.onShowSizeChange=function(e){},a.handlesearch=function(e){var t=e.replace(/\s/g,"");a.setState({quickvalue:t},function(){a.getData()})},a.tableChange=function(e,t,n){var l="";"descend"===n.order?l="desc":"ascend"===n.order&&(l="asc"),a.setState({curr:e.current||a.state.curr,sortfield:n.field,sorttype:l,limit:e.pageSize||a.state.limit},function(){a.getData()})},a.closeRightModal=function(){a.setState({showRightBox:!1,increaseData:{}}),a.props.setBreadCrumb2()},a.tabsChange=function(e){a.state.tabs_array[e]},a.filterChange=function(e){a.setState({filtervalue:e.target.value},function(){a.getData()})},a.cancelModal=function(){a.setState({visible:!1})},a.closeRight=function(e){a.setState({showRightBox:e,staskid:""})},a.onRowClick=function(e,t){var n=e.piId;(0,v.vpQuery)("/{vpflow}/rest/process/activitytask",{piId:n}).then(function(t){var n=t.data.taskId||"",l=t.data.formkey||"",i=t.data.usermode||"",o=t.data.entityId||"",r=t.data.objectId||"",s=t.data.record||{piId:e.piId,pdId:e.pdId,endTime:e.endTime};a.setState({showRightBox:!0,record:s,staskid:n,iid:r,usermode:2!=i,entityid:o,formkey:l}),a.props.setBreadCrumb(e.flowName)})},a.addNewDom=function(){var e=a.state.record;return h["default"].createElement(g["default"],{usermode:a.state.usermode,stepkey:e.activityId,staskid:a.state.staskid,piid:e.piId,pdid:e.pdId,iobjectentityid:a.state.entityid,iobjectid:a.state.iid,entityid:e.iflowentityid,endTime:e.endTime,formkey:a.state.formkey,closeRight:function(e){return a.closeRight(e)},getData:function(){return a.getData()}})},a.state={tableHeader:[],tableData:[],curr:1,limit:10,filtervalue:"",quickvalue:"",showRightBox:!1,total_rows:"",pagination:{},visible:!1,staskid:"",entityid:"",iid:"",record:{},usermode:"",formkey:"",tableHeight:""},a}return(0,f["default"])(t,e),(0,c["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({filtervalue:e.filtervalue,quickvalue:e.quickvalue},function(){t.getData()})}},{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){var e=$(window).height()-255;$(".processedflow").find(".ant-table-body").css({height:e})}},{key:"render",value:function(){return h["default"].createElement("div",{className:"full-height"},h["default"].createElement(v.VpTable,{className:"processedflow",columns:this.state.tableHeader,dataSource:this.state.tableData,onChange:this.tableChange,pagination:this.state.pagination,onRowClick:this.onRowClick,scroll:{y:this.state.tableHeight},resize:!0}),h["default"].createElement("div",{className:"drawer-fixed p-sm hide"},h["default"].createElement("div",{className:"pr full-height"},h["default"].createElement("div",{className:"spin-icon",onclick:"closeDrawer"},h["default"].createElement(v.VpIcon,{type:"verticle-left"})),h["default"].createElement("div",{className:"drawer-box"}))),h["default"].createElement(y.RightBox,{max:!0,button:h["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightModal},h["default"].createElement(v.VpTooltip,{placement:"top",title:""},h["default"].createElement(v.VpIcon,{type:"right"}))),tips:h["default"].createElement("div",{className:"tips p-xs"},h["default"].createElement(v.VpTooltip,{placement:"top",title:"0000"},h["default"].createElement(v.VpIcon,{type:"exclamation-circle text-muted m-r-xs"}))),show:this.state.showRightBox},this.state.showRightBox?this.addNewDom():null))}}]),t}(m.Component);t["default"]=w=(0,v.VpFormCreate)(w)},955:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(688),i=n(l),o=a(54),r=n(o),s=a(55),c=n(s),u=a(59),d=n(u),p=a(93),f=n(p),m=a(8),h=n(m),v=a(4),k=function(e){function t(e){(0,r["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.queryHeader=function(){var e=[{title:"授权者",dataIndex:"assigneeName",key:"assigneeName"},{title:"被授予者",dataIndex:"delegateeName",key:"delegateeName"},{title:"创建时间",dataIndex:"createtime",key:"createtime"},{title:"开始时间",dataIndex:"starttime",key:"starttime"},{title:"结束时间",dataIndex:"endtime",key:"endtime"},{title:"授权类型",dataIndex:"typeName",key:"typeName"},{title:"流程",dataIndex:"flowname",key:"flowname",width:160,render:function(e,t){var a=""==t.piid?t.flowname:t.piName;return h["default"].createElement("span",null,a)}},{title:"状态",dataIndex:"flagName",key:"flagName",width:50},{title:"操作",fixed:"right",width:120,key:"operation",render:function(e,t){return h["default"].createElement("div",null,0==t.flag?h["default"].createElement(v.VpIcon,{title:"启用",onClick:function(e){return a.handleFlag(e,t)},className:"cursor m-lr-xs",type:"vpicon-check-circle-o"}):h["default"].createElement(v.VpIcon,{title:"禁用",onClick:function(e){return a.handleFlag(e,t)},className:"cursor m-lr-xs",type:"vpicon-refuse-o"}))}}];a.setState({tableHeader:e})},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.handleFlag=function(e,t){(0,v.vpAdd)("/{vpflow}/rest/flowgrant/flag",{id:t.id}).then(function(e){a.setState({tableHeader:[]},function(){a.queryHeader(),a.tableRef.getTableData()})})},a.toolBarAddClick=function(){a.setState({visible:!0})},a.onRowClick=function(e,t){},a.controlAddButton=function(e,t){var n=vp.computedHeight(t.length,".flowgrant");a.setState({tableHeight:n})},a.state={filtervalue:"",filters:[],quickvalue:"",tableHeader:[],visible:!1,record:[],tableHeight:""},a}return(0,f["default"])(t,e),(0,c["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({filtervalue:e.filtervalue,quickvalue:e.quickvalue},function(){t.tableRef.getTableData()})}},{key:"componentWillMount",value:function(){this.queryHeader()}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return h["default"].createElement("div",{className:"bg-white"},h["default"].createElement(v.VpTable,{className:"flowgrant",ref:function(t){e.tableRef=t,e.props.bindTable(t)},controlAddButton:function(t,a){e.controlAddButton(t,a)},dataUrl:"/{vpflow}/rest/flowgrant/page2",scroll:{y:this.state.tableHeight},params:{quickvalue:this.state.quickvalue,filtervalue:this.state.filtervalue},columns:this.state.tableHeader,onRowClick:this.onRowClick,bindThis:this,resize:!0}))}}]),t}(m.Component);t["default"]=k=(0,v.VpFormCreate)(k)},956:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(688),i=n(l),o=a(54),r=n(o),s=a(55),c=n(s),u=a(59),d=n(u),p=a(93),f=n(p),m=a(8),h=n(m),v=a(4),k=a(810),g=n(k),y=function(e){function t(e){(0,r["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.showUserModal=function(){a.setState({visible:!0})},a.cancelModal=function(){a.setState({visible:!1})},a.okUserModal=function(e){var t=e.map(function(e){return e.iid}).join();t.length>0?a.cancelModal():(0,v.VpAlertMsg)({message:"消息提示",description:"请选择需要添加的用户！",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);var n=e.map(function(e){return e.sname}).join();a.setState({usernames:n,userids:t})},a.changeType=function(e){a.setState({type:e},function(){if(0==e&&a.setState({options:[]}),1==e)return void(0,v.vpQuery)("/{vpflow}/rest/workflow/list",{}).then(function(e){var t=e.data.map(function(e){return h["default"].createElement(v.VpOption,{key:e.skey},e.sname)});a.setState({options:t})});(0,v.vpQuery)("/{vpflow}/rest/process/list",{}).then(function(e){var t=e.data.map(function(e){return h["default"].createElement(v.VpOption,{key:e.piId},e.piName)});a.setState({options:t})})})},a.okModal=function(){var e=a.state.userids,t=a.state.type,n=a.state.flow;if(""==e)return void(0,v.VpAlertMsg)({message:"消息提示",description:"所选用户不能为空！",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);if("0"!=t&&""==n)return void(0,v.VpAlertMsg)({message:"消息提示",description:"流程不能为空！",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);a.props.cancelModal();var l=a.state.starttime,i=a.state.endtime,o={delegatee:e,type:t,flow:n,starttime:l,endtime:i};(0,v.vpAdd)("/{vpflow}/rest/flowgrant/save",o).then(function(e){a.props.okModal()})},a.state={visible:!1,usernames:"",userids:"",options:[],visible_flow:!1,type:"0",flow:"",starttime:"",endtime:""},a}return(0,f["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"render",value:function(){var e=this;this.props.form.getFieldProps;return h["default"].createElement("div",{style:{marginTop:100}},h["default"].createElement(v.VpForm,{horizontal:!0,onSubmit:this.handleSubmit},h["default"].createElement("div",null,h["default"].createElement(v.VpRow,{style:{marginTop:15}},h["default"].createElement(v.VpCol,{span:6,className:"text-right p-lr-sm"},h["default"].createElement("label",null," 授予 :")),h["default"].createElement(v.VpCol,{span:14},h["default"].createElement(v.VpInput,{placeholder:"选择相关用户",value:this.state.usernames,onClick:this.showUserModal}))),h["default"].createElement(v.VpRow,{style:{marginTop:15}},h["default"].createElement(v.VpCol,{span:6,className:"text-right p-lr-sm"},h["default"].createElement("label",null," 授权方式 :")),h["default"].createElement(v.VpCol,{span:14},h["default"].createElement(v.VpSelect,{defaultValue:this.state.type,onChange:this.changeType},h["default"].createElement(v.VpOption,{value:"0"},"所有"),h["default"].createElement(v.VpOption,{value:"1"},"流程"),h["default"].createElement(v.VpOption,{value:"2"},"运行中的流程")))),h["default"].createElement(v.VpRow,{style:{marginTop:15}},h["default"].createElement(v.VpCol,{span:6,className:"text-right p-lr-sm"},h["default"].createElement("label",null," 流程 :")),h["default"].createElement(v.VpCol,{span:14},h["default"].createElement(v.VpSelect,{defaultValue:this.state.flow,onChange:function(t){return e.setState({flow:t})}},h["default"].createElement(v.VpOption,{value:""},"请选择"),this.state.options))),h["default"].createElement(v.VpRow,{style:{marginTop:15}},h["default"].createElement(v.VpCol,{span:6,className:"text-right p-lr-sm"},h["default"].createElement("label",null," 授权时间 :")),h["default"].createElement(v.VpCol,{span:14},h["default"].createElement(v.VpRow,null,h["default"].createElement(v.VpCol,{span:11},h["default"].createElement(v.VpDatePicker,{defaultValue:this.state.starttime,onChange:function(t,a){return e.setState({starttime:a})},placeholder:"开始时间"})),h["default"].createElement(v.VpCol,{span:2}),h["default"].createElement(v.VpCol,{span:11},h["default"].createElement(v.VpDatePicker,{defaultValue:this.state.endtime,onChange:function(t,a){return e.setState({endtime:a})},placeholder:"结束时间"}))))),h["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer"},h["default"].createElement(v.VpButton,{className:"m-r-xs",type:"primary",onClick:function(){return e.okModal()}},"保存"),h["default"].createElement(v.VpButton,{className:"m-r-xs",onClick:function(){return e.props.cancelModal()}},"取消")))),h["default"].createElement(v.VpModal,{title:"选择用户",visible:this.state.visible,onCancel:function(){return e.cancelModal()},width:"70%",wrapClassName:"modal-no-footer",footer:null},this.state.visible?h["default"].createElement(g["default"],{item:{irelationentityid:"2"},initValue:[],params:{},onCancel:function(){return e.cancelModal()},onOk:function(t){return e.okUserModal(t)}}):""))}}]),t}(m.Component);t["default"]=y=(0,v.VpFormCreate)(y)}});