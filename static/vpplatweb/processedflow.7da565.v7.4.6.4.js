webpackJsonp([8],{954:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(688),n=i(l),o=a(54),r=i(o),s=a(55),c=i(s),d=a(59),u=i(d),p=a(93),m=i(p),f=a(8),h=i(f),v=a(4),g=a(826),k=i(g),y=a(652),w=function(e){function t(e){(0,r["default"])(this,t);var a=(0,u["default"])(this,(t.__proto__||(0,n["default"])(t)).call(this,e));return a.getHeader=function(){var e=[{title:"状态",dataIndex:"taskState",key:"taskState",width:80,render:function(e,t){var a="";return-1==t.taskState&&(a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"进行中 已超时"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-handle"}))),0==t.taskState?a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"进行中 未超时"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-clock"})):1==t.taskState?a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"已终止"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-close"})):2==t.taskState&&(a=h["default"].createElement(v.VpTooltip,{placement:"top",title:"已完成"},h["default"].createElement(v.VpIcon,{className:"m-r-xs",type:"vpicon-check"}))),h["default"].createElement("span",null,a)}},{title:"流程名称",dataIndex:"flowName",key:"flowName"},{title:"对象名称",dataIndex:"objectName",key:"objectName"},{title:"当前步骤",dataIndex:"activityName",key:"activityName"},{title:"发起时间",dataIndex:"startTime",key:"startTime"},{title:"处理人",dataIndex:"handlers",key:"handlers"},{title:"到达时间",dataIndex:"createTime",key:"createTime"}];e.push({title:"操作",fixed:"right",width:120,key:"operation",render:function(e,t){return h["default"].createElement("span",null,h["default"].createElement(v.VpTooltip,{placement:"top",title:"查看"},h["default"].createElement(v.VpIconFont,{className:"cursor text-primary m-lr-xs",type:"vpicon-see-o"})))}}),a.setState({tableHeader:e})},a.getData=function(){(0,v.vpQuery)("/{vpflow}/rest/process/processedflow",{curr:a.state.curr,limit:a.state.limit,quickvalue:a.state.quickvalue,filtervalue:a.state.filtervalue}).then(function(e){var t=e.data,i=function(){return"共"+t.count+"条"},l=vp.computedHeight(t.count,".processedflow");a.setState({tableHeight:l,tableData:t.result,curr:t.curr,total_rows:t.count,limit:t.limit,pagination:{total:t.count,showTotal:i,pageSize:t.limit,onShowSizeChange:a.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})},a.onShowSizeChange=function(e){},a.handlesearch=function(e){var t=e.replace(/\s/g,"");a.setState({quickvalue:t},function(){a.getData()})},a.tableChange=function(e,t,i){var l="";"descend"===i.order?l="desc":"ascend"===i.order&&(l="asc"),a.setState({curr:e.current||a.state.curr,sortfield:i.field,sorttype:l,limit:e.pageSize||a.state.limit},function(){a.getData()})},a.closeRightModal=function(){a.setState({showRightBox:!1,increaseData:{}}),a.props.setBreadCrumb2()},a.tabsChange=function(e){a.state.tabs_array[e]},a.filterChange=function(e){a.setState({filtervalue:e.target.value},function(){a.getData()})},a.cancelModal=function(){a.setState({visible:!1})},a.closeRight=function(e){a.setState({showRightBox:e,staskid:""})},a.onRowClick=function(e,t){var i=e.piId;(0,v.vpQuery)("/{vpflow}/rest/process/activitytask",{piId:i}).then(function(t){var i=t.data.taskId||"",l=t.data.formkey||"",n=t.data.usermode||"",o=t.data.entityId||"",r=t.data.objectId||"",s=t.data.record||{piId:e.piId,pdId:e.pdId,endTime:e.endTime};a.setState({showRightBox:!0,record:s,staskid:i,iid:r,usermode:2!=n,entityid:o,formkey:l}),a.props.setBreadCrumb(e.flowName)})},a.addNewDom=function(){var e=a.state.record;return h["default"].createElement(k["default"],{usermode:a.state.usermode,stepkey:e.activityId,staskid:a.state.staskid,piid:e.piId,pdid:e.pdId,iobjectentityid:a.state.entityid,iobjectid:a.state.iid,entityid:e.iflowentityid,endTime:e.endTime,formkey:a.state.formkey,closeRight:function(e){return a.closeRight(e)},getData:function(){return a.getData()}})},a.state={tableHeader:[],tableData:[],curr:1,limit:10,filtervalue:"",quickvalue:"",showRightBox:!1,total_rows:"",pagination:{},visible:!1,staskid:"",entityid:"",iid:"",record:{},usermode:"",formkey:"",tableHeight:""},a}return(0,m["default"])(t,e),(0,c["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({filtervalue:e.filtervalue,quickvalue:e.quickvalue},function(){t.getData()})}},{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){var e=$(window).height()-255;$(".processedflow").find(".ant-table-body").css({height:e})}},{key:"render",value:function(){return h["default"].createElement("div",{className:"full-height"},h["default"].createElement(v.VpTable,{className:"processedflow",columns:this.state.tableHeader,dataSource:this.state.tableData,onChange:this.tableChange,pagination:this.state.pagination,onRowClick:this.onRowClick,scroll:{y:this.state.tableHeight},resize:!0}),h["default"].createElement("div",{className:"drawer-fixed p-sm hide"},h["default"].createElement("div",{className:"pr full-height"},h["default"].createElement("div",{className:"spin-icon",onclick:"closeDrawer"},h["default"].createElement(v.VpIcon,{type:"verticle-left"})),h["default"].createElement("div",{className:"drawer-box"}))),h["default"].createElement(y.RightBox,{max:!0,button:h["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightModal},h["default"].createElement(v.VpTooltip,{placement:"top",title:""},h["default"].createElement(v.VpIcon,{type:"right"}))),tips:h["default"].createElement("div",{className:"tips p-xs"},h["default"].createElement(v.VpTooltip,{placement:"top",title:"0000"},h["default"].createElement(v.VpIcon,{type:"exclamation-circle text-muted m-r-xs"}))),show:this.state.showRightBox},this.state.showRightBox?this.addNewDom():null))}}]),t}(f.Component);t["default"]=w=(0,v.VpFormCreate)(w)}});