webpackJsonp([13],{980:function(e,t,o){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(14),a=l(n),s=o(688),i=l(s),r=o(54),c=l(r),u=o(55),d=l(u),p=o(59),f=l(p),h=o(93),m=l(h),g=o(8),w=l(g),b=o(4),v=o(652),y=o(981),x=l(y),R=function(e){function t(e){(0,c["default"])(this,t);var o=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return o.handlesearch=function(e){var t=e.replace(/\s/g,"");o.setState({quickvalue:t})},o.closeRightBox=function(){o.setState({showRightBox:!1})},o.showRightBox=function(){o.setState({showRightBox:!0,showRightBoxTab:!1,flowgroup:{}})},o.delSelectClick=function(){var e=o.state.selectedRows;e.length>0?(0,b.vpAdd)("/{vpflow}/rest/flowgroup/delete",{ids:e.map(function(e){return e.iid}).join()}).then(function(e){if(e.data==undefined)return void(0,b.VpAlertMsg)({message:"消息提示",description:e.msg,type:"error",onClose:o.onClose,closeText:"关闭",showIcon:!0},5);o.tableRef.getTableData()}):(0,b.VpAlertMsg)({message:"消息提示",description:"请选择需要删除的数据！",type:"error",onClose:o.onClose,closeText:"关闭",showIcon:!0},5)},o.handleDelete=function(e,t){e.stopPropagation(),(0,b.vpAdd)("/{vpflow}/rest/flowgroup/delete",{ids:t.iid}).then(function(e){if(e.data==undefined)return void(0,b.VpAlertMsg)({message:"消息提示",description:e.msg,type:"error",onClose:o.onClose,closeText:"关闭",showIcon:!0},5);o.tableRef.getTableData()})},o.onRowClick=function(e,t){o.setState({flowgroup:e,showRightBoxTab:!0,showRightBox:!0})},o.controlAddButton=function(e,t){var l=vp.computedHeight(t.length,".flowGroup");t.length&&(l+=200),o.setState({tableHeight:l})},o.onSelectChange=function(e,t){o.setState({selectedRowKeys:e,selectedRows:t})},o.state={tableHeight:"",quickvalue:"",tableHeader:[],selectedRows:[],selectedRowKeys:[],showRightBox:!1,flowgroup:{},showRightBoxTab:!1},o}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){$(".ant-table-body").height($(window).height()-200)}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({quickvalue:e.quickvalue},function(){t.tableRef.getTableData()})}},{key:"componentWillMount",value:function(){var e=this,t=[{title:"组名",dataIndex:"sname",key:"sname",width:"",fixed:""},{title:"描述",dataIndex:"sdescription",key:"sdescription",width:"",fixed:""},{title:"操作",fixed:"right",width:120,key:"operation",render:function(t,o){return w["default"].createElement("span",null,w["default"].createElement(b.VpIcon,{title:"查看",style:{cursor:"pointer",color:"#1c84c6",fontWeight:"bold",fontSize:14,margin:"0 5px"},type:"edit"}),w["default"].createElement(b.VpIcon,{title:"删除",onClick:function(t){return e.handleDelete(t,o)},className:"cursor m-lr-xs",type:"vpicon-close"}))}}];this.setState({tableHeader:t})}},{key:"render",value:function(){var e=this,t={onChange:this.onSelectChange};return w["default"].createElement("div",{className:"business-container pr full-height"},w["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},w["default"].createElement(b.VpRow,{gutter:10},w["default"].createElement(b.VpCol,{className:"gutter-row",span:4},w["default"].createElement(v.SeachInput,{onSearch:this.handlesearch})),w["default"].createElement(b.VpCol,{className:"gutter-row text-right",span:20},w["default"].createElement(b.VpTooltip,{placement:"top",title:"新建"},w["default"].createElement(b.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",icon:"plus",onClick:this.showRightBox})),w["default"].createElement(b.VpTooltip,{placement:"top",title:"删除"},w["default"].createElement(b.VpButton,{type:"ghost",style:{margin:"0 3px"},shape:"circle",icon:"cross",onClick:this.delSelectClick}))))),w["default"].createElement("div",{className:"business-wrapper p-t-sm full-height overflow"},w["default"].createElement("div",{className:"p-sm bg-white full-height scroll-y"},w["default"].createElement(b.VpTable,{className:"flowGroup",controlAddButton:function(t,o){e.controlAddButton(t,o)},rowSelection:t,ref:function(t){return e.tableRef=t},dataUrl:"/{vpflow}/rest/flowgroup/page2",params:{quickvalue:this.state.quickvalue},columns:this.state.tableHeader,onRowClick:this.onRowClick,bindThis:this,rowKey:function(e){return e.iid},resize:!0,scroll:{y:this.state.tableHeight}}))),w["default"].createElement(v.RightBox,{button:w["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightBox},w["default"].createElement(b.VpTooltip,{placement:"top",title:""},w["default"].createElement(b.VpIcon,{type:"right"}))),show:this.state.showRightBox},this.state.showRightBox?w["default"].createElement(E,{tableRef:this.tableRef,flowgroup:this.state.flowgroup,showRightBoxTab:this.state.showRightBoxTab,closeRightBox:function(){return e.closeRightBox()},handleSave:function(){return e.handleSave()}}):null))}}]),t}(g.Component),E=function(e){function t(e){(0,c["default"])(this,t);var o=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return o.handleSave=function(){o.props.form.validateFields(function(e,t){if(null==e){if(""==t.sname.replace(/\s+/g,""))return void(0,b.VpAlertMsg)({message:"消息提示",description:"组名不能为空！",type:"error",closeText:"关闭",showIcon:!0},5);null!=t.sdescription&&t.sdescription!=undefined||(t.sdescription=""),(0,b.vpAdd)("/{vpflow}/rest/flowgroup/save",(0,a["default"])({},t,{iid:o.state.iid})).then(function(e){o.props.tableRef.getTableData(),o.props.closeRightBox()})}})},o.state={iid:o.props.flowgroup.iid,sname:o.props.flowgroup.sname,sdescription:o.props.flowgroup.sdescription,showRightBoxTab:o.props.showRightBoxTab},o}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props.form.getFieldProps,t={labelCol:{span:6},wrapperCol:{span:14}};return w["default"].createElement("div",{className:"full-height"},w["default"].createElement(b.VpTabs,{defaultActiveKey:"0",onChange:this.tabsChange},w["default"].createElement(b.VpTabPane,{tab:"属性",key:"0"},w["default"].createElement(b.VpForm,{style:{paddingTop:50}},w["default"].createElement(b.VpFInput,(0,a["default"])({},t,{label:"组名",type:"text"},e("sname",{initialValue:this.state.sname,rules:[{required:!0,message:"组名不能为空!"}]}))),w["default"].createElement(b.VpFInput,(0,a["default"])({},t,{label:"描述",type:"textarea"},e("sdescription",{initialValue:this.state.sdescription}))),w["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer",style:{bottom:"10px",zIndex:10}},w["default"].createElement(b.VpButton,{className:"m-r-xs",type:"primary",onClick:this.handleSave},"保存"),w["default"].createElement(b.VpButton,{className:"m-r-xs",onClick:this.props.closeRightBox},"取消")))),this.state.showRightBoxTab?w["default"].createElement(b.VpTabPane,{tab:"用户列表",key:1},w["default"].createElement(x["default"],{groupId:this.state.iid})):w["default"].createElement(b.VpTabPane,{tab:"用户列表",key:1,disabled:!0})))}}]),t}(w["default"].Component);E=(0,b.VpFormCreate)(E),t["default"]=R=(0,b.VpFormCreate)(R)},981:function(e,t,o){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function n(){return[{title:"用户名称",dataIndex:"sname",key:"sname",width:"",fixed:""},{title:"用户编码",dataIndex:"scode",key:"scode",width:"",fixed:""},{title:"用户登录名",dataIndex:"sloginname",key:"sloginname",width:"",fixed:""}]}Object.defineProperty(t,"__esModule",{value:!0});var a=o(688),s=l(a),i=o(54),r=l(i),c=o(55),u=l(c),d=o(59),p=l(d),f=o(93),h=l(f),m=o(8),g=l(m),w=o(4),b=o(810),v=l(b),y=function(e){function t(e){(0,r["default"])(this,t);var o=(0,p["default"])(this,(t.__proto__||(0,s["default"])(t)).call(this,e));return o.cancelModal=function(){o.setState({choseUser:!1},function(){$(".users").find(".ant-table-body").height(o.state.bodyheight)})},o.handleAddUser=function(){o.setState({choseUser:!0})},o.handleUserDelete=function(){var e=o.state.selectedUserRows,t=[];e.map(function(e,o){t.push(e.iid)}),t.length>0?(0,w.vpAdd)("/{vpflow}/rest/flowgroup/user/delete",{userids:t.join(),groupId:o.props.groupId}).then(function(e){if(e.data==undefined)return void(0,w.VpAlertMsg)({message:"消息提示",description:e.msg,type:"error",onClose:o.onClose,closeText:"关闭",showIcon:!0},5);o.setState({selected:[],selectedRowKeys:[]},function(){o.tableRefs.getTableData()})}):(0,w.VpAlertMsg)({message:"消息提示",description:"请选择需要删除的数据！",type:"error",onClose:o.onClose,closeText:"关闭",showIcon:!0},5)},o.controlAddButton=function(e,t){var l=vp.computedHeight(t.length,".users");t.length?l-=70:l-=100,o.setState({tableHeight:l})},o.okUserModal=function(e){var t=[];e.map(function(e,o){t.push(e.iid)}),t.length>0?(0,w.vpAdd)("/{vpflow}/rest/flowgroup/user/save",{userids:t.join(),groupId:o.props.groupId}).then(function(e){o.setState({selectedUserRows:[],selectedRowKeys:[]},function(){o.cancelModal()})}):(0,w.VpAlertMsg)({message:"消息提示",description:"请选择需要添加的用户！",type:"error",onClose:o.onClose,closeText:"关闭",showIcon:!0},5)},o.state={selectedUserRows:[],selectedRowKeys:[],selected:"",choseUser:!1,tableHeight:""},o}return(0,h["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=$(window).height()-260;$(".users").find(".ant-table-body").css({height:e}),this.setState({bodyheight:e})}},{key:"render",value:function(){var e=this,t=this,o={onChange:function(e,o){t.setState({selectedUserRows:o,selectedRowKeys:e})},onSelect:function(e,t,o){},onSelectAll:function(e,o,l){t.setState({selected:e})}};return g["default"].createElement("div",{className:"business-container pr full-height"},g["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},g["default"].createElement(w.VpRow,{gutter:1},g["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:30},g["default"].createElement(w.VpTooltip,{placement:"top",title:"新建"},g["default"].createElement(w.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",icon:"plus",onClick:function(t){return e.handleAddUser()}})),g["default"].createElement(w.VpTooltip,{placement:"top",title:"删除"},g["default"].createElement(w.VpButton,{onClick:function(t){return e.handleUserDelete()},type:"ghost",style:{margin:"0 3px"},shape:"circle",icon:"cross"}))))),g["default"].createElement("div",{className:"business-wrapper p-t-sm full-height"},g["default"].createElement("div",{className:"p-sm bg-white"},this.state.choseUser?null:g["default"].createElement(w.VpTable,{rowKey:function(e){return e.iid},rowSelection:o,ref:function(t){return e.tableRefs=t},params:{groupId:this.props.groupId},controlAddButton:function(t,o){e.controlAddButton(t,o)},dataUrl:"/{vpflow}/rest/flowgroup/user/page2",columns:n(),bindThis:this,className:"users",scroll:{y:this.state.tableHeight}}))),g["default"].createElement(w.VpModal,{title:"选择用户",visible:this.state.choseUser,onCancel:function(){return e.cancelModal()},width:"70%",wrapClassName:"modal-no-footer",footer:null},this.state.choseUser?g["default"].createElement(v["default"],{item:{irelationentityid:"2"},initValue:[],params:{},onCancel:function(){return t.cancelModal()},onOk:function(e){return t.okUserModal(e)}}):null))}}]),t}(m.Component);t["default"]=y=(0,w.VpFormCreate)(y)}});