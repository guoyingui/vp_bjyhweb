webpackJsonp([17],{996:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(14),d=l(n),i=a(688),o=l(i),s=a(54),u=l(s),r=a(55),c=l(r),p=a(59),f=l(p),m=a(93),b=l(m),v=a(8),h=l(v),V=a(4);a(997);var E=function(e){function t(e){(0,u["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,o["default"])(t)).call(this,e));return a.getData=function(){var e=a;(0,V.vpAdd)("/{vpplat}/vfrm/license/getlicense").then(function(t){var a=JSON.parse(t.data),l={},n={};a.modulelist.forEach(function(e,t){l[e.field]?l[e.field]+=1:l[e.field]=1,n[e.process]?n[e.process]+=1:n[e.process]=1}),e.setState({data:a,tabledata:a.modulelist,field:(0,d["default"])({},l),process:(0,d["default"])({},n)},function(){e.getheader()})})["catch"](function(e){"function"!=typeof e||e()})},a.change=function(){a.setState({entityVisible:!0})},a.downloadlicense=function(){(0,V.vpDownLoad)("/{vpplat}/vfrm/license/exportlicense").then(function(e){})},a.uploadSuccess=function(e,t){(0,V.VpAlertMsg)({message:"消息提示",description:"导入成功！",type:"success",onClose:a.onClose,closeText:"关闭",showIcon:!0},5),a.setState({entityVisible:!1},function(){return a.getData()})},a.cancelModal=function(){a.setState({entityVisible:!1,tabledata:[],tableheader:[]},function(){return a.getData()})},a.getheader=function(){var e=a,t=function(e,t,a){return{children:e,props:{}}},l=[{title:"过程",dataIndex:"process",render:function(t,a,l){var n={children:t,props:{}};return e.state.process[t]?(n.props.rowSpan=e.state.process[t],e.state.process[t]=0):(e.state.process[t],n.props.rowSpan=0),n}},{title:"模块",dataIndex:"modular",render:t},{title:"用户数",dataIndex:"iusernum",width:"120",render:t},{title:"实际用户数",dataIndex:"actualnum",width:"120",render:t}];a.setState({tableheader:l})},a.uploadClick=function(){a.inputUploader.upload.on("beforeFileQueued",function(e){a.props.form.setFieldsValue({lic_label:e.name})})},a.onChange=a.onChange.bind(a),a.state={tabledata:[],data:{macaddress:"",startdate:"",expiresdate:""},entityVisible:!1,field:{},process:{},tableheader:[],filename:""},a}return(0,b["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){this.getData()}},{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(){}},{key:"onChange",value:function(e,t){}},{key:"handleSubmit",value:function(e){"upload"==e&&this.inputUploader.upload.upload()}},{key:"render",value:function(){var e=this,t=this,a=(t.state.data,{labelCol:{span:6},wrapperCol:{span:14}});return h["default"].createElement("div",{className:"license-container full-height p-b-xxlg"},h["default"].createElement("div",{className:"full-height license-box scroll"},h["default"].createElement(V.VpForm,null,h["default"].createElement("div",{className:"bg-white p-sm m-b-sm"},h["default"].createElement(V.VpRow,null,h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"公司名称",disabled:!0,value:t.state.data.company}))),h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"产品名称",disabled:!0,value:t.state.data.product}))),h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"产品简称",disabled:!0,value:t.state.data.abbreviation}))),h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"授权类型",disabled:!0,value:t.state.data.authorization})))),h["default"].createElement(V.VpRow,{className:"vp-form-item"},h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"期限",disabled:!0,value:t.state.data.startdate+"至"+t.state.data.expiresdate}))),h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"系统用户",disabled:!0,value:t.state.data.name}))),h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"mac地址",disabled:!0,value:t.state.data.macaddress}))),h["default"].createElement(V.VpCol,{span:6},h["default"].createElement(V.VpFInput,(0,d["default"])({},a,{label:"IP地址",disabled:!0,value:t.state.data.ipaddress})))))),h["default"].createElement("div",{className:"bg-white p-sm"},h["default"].createElement(V.VpTable,{columns:this.state.tableheader,dataSource:this.state.tabledata,pagination:!1})),h["default"].createElement("div",{className:"footFixed p-sm b-t text-center"},h["default"].createElement(V.VpButton,{className:"m-r-xs",type:"primary",onClick:function(){return e.change()}},"更新平台"),h["default"].createElement(V.VpButton,{className:"m-r-xs",type:"primary",onClick:function(){return e.downloadlicense()}},"下载License"))),h["default"].createElement(V.VpModal,{title:"更新平台",visible:this.state.entityVisible,onCancel:function(){return e.cancelModal()},width:"70%",footer:null,wrapClassName:"modal-no-footer"},this.state.entityVisible?h["default"].createElement("div",{onClick:this.uploadClick},h["default"].createElement(V.VpInputUploader,{form:this.props.form,item:{field_name:"lic",widget_type:"inputupload",field_label:"选择文件",all_line:2,tips:"请选择文件（*.lic)",auto:!1,widget:{accept:{title:"lic",extensions:"lic"},upload_url:window.vp.config.URL.localHost+"/zuul/{vpplat}/vfrm/license/importfile"}},ref:function(t){return e.inputUploader=t},onUploadAccept:this.uploadSuccess})):null,h["default"].createElement("div",{className:"footFixed p-sm b-t text-center"},h["default"].createElement(V.VpButton,{type:"primary",onClick:function(){return e.handleSubmit("upload")}},"更新License"))))}}]),t}(v.Component);t["default"]=E=(0,V.VpFormCreate)(E)},997:function(e,t,a){var l=a(998);"string"==typeof l&&(l=[[e.id,l,""]]);var n={hmr:!0};n.transform=void 0;a(439)(l,n);l.locals&&(e.exports=l.locals)},998:function(e,t){}});