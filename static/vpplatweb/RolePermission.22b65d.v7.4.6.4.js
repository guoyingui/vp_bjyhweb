webpackJsonp([34],{979:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(363),l=n(i),s=a(802),o=n(s),r=a(688),d=n(r),u=a(54),c=n(u),p=a(55),f=n(p),h=a(59),m=n(h),g=a(93),v=n(g),y=a(8),b=n(y),w=a(4),C=a(810),V=n(C),x=a(652),k=function(e){function t(e){(0,c["default"])(this,t);var a=(0,m["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.getHeader=function(){var e=a;(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListHeader",{pageType:"rolegroupuser"}).then(function(t){var a=t.data;if(a&&(e.setState({loading:!1}),a.hasOwnProperty("grid"))){var n=[];a.grid.hasOwnProperty("fields")&&(a.grid.fields.map(function(e,t){var a=void 0,i=void 0,l=void 0,s=void 0;for(var o in e)"title"==o?a=e[o]:"field"==o&&(i=e[o]),"fixed"==o&&(s=e[o]),"width"==o&&(l=e[o]);a&&i&&("left"==s||"right"==s?n.push({title:a,dataIndex:i,key:i,width:l,fixed:s}):n.push({title:a,dataIndex:i,key:i,fixed:s}))}),e.setState({table_headers:n}))}})["catch"](function(e){})},a.getData=function(){var e=a,t={type:1,pageType:"rolegroupuser",idepartmentid:0,irolegroupid:a.props.groupid};t.curr=a.state.cur_page,t.limit=a.state.num_perpage,(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListData",{sparam:(0,o["default"])(t)}).then(function(t){var a=t.data.data,n=function(){return"共"+a.totalRows+"条"};e.setState({table_array:a.resultList,cur_page:a.currentPage,total_rows:a.totalRows,num_perpage:a.numPerPage,pagination:{total:a.totalRows,showTotal:n,pageSize:a.numPerPage,onShowSizeChange:e.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})["catch"](function(e){"function"!=typeof e||e()})},a.onRowClick=function(e){var t=a;(0,w.vpQuery)("/{vpplat}/vfrm/entity/getform",{entityid:2,iid:e.iid}).then(function(a){a&&a.hasOwnProperty("data")&&a.data.hasOwnProperty("form")&&a.data.form.hasOwnProperty("groups")&&t.setState({iid:e.iid,modaltitle:"用户>"+e.sname,increaseData:a.data.form,visible:!0})})["catch"](function(e){})},a.cancelChoosen=function(){a.setState({updateCharer:!1})},a.submitChoosen=function(e){var t=a,n="",i="";e.map(function(e,t){t>0&&(n+=",",i+=","),n+=e.sname,i+=e.iid});var l={userids:i,irolegroupid:a.props.groupid};(0,w.vpAdd)("/{vpplat}/cfgrolegroup/addUser",{sparam:(0,o["default"])(l)}).then(function(e){e.data.success&&t.setState({selectedRowKeys:[]},function(){t.getData(),t.cancelChoosen()})})},a.handleModal=function(){a.setState({updateCharer:!0})},a.handleCancel=function(){a.setState({visible:!1,increaseData:[]})},a.state={groupid:0,updateCharer:!1,visible:!1,increaseData:[],modaltitle:"",filters:[],table_headers:[],table_array:[],cur_page:1,num_perpage:10,selectedRowKeys:[],pagination:{}},a.handleSelect=a.handleSelect.bind(a),a.handleSelectAll=a.handleSelectAll.bind(a),a.onSelectChange=a.onSelectChange.bind(a),a.tableChange=a.tableChange.bind(a),a}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){$(".ant-table-body").height($(window).height()-260)}},{key:"tableChange",value:function(e,t,a){var n=this;this.setState({cur_page:e.current||this.state.cur_page,num_perpage:e.pageSize||this.state.num_perpage},function(){n.getData()})}},{key:"handleSelect",value:function(e,t,a){var n=0;t?this.setState({selectedRowKeys:[].concat((0,l["default"])(this.state.selectedRowKeys),[e.iid])}):(this.state.selectedRowKeys.forEach(function(t,a){t===e.iid&&(n=a)}),this.setState({selectedRowKeys:[].concat((0,l["default"])(this.state.selectedRowKeys.slice(0,n)),(0,l["default"])(this.state.selectedRowKeys.slice(n+1)))}))}},{key:"onSelectChange",value:function(e){this.setState({selectedRowKeys:e})}},{key:"handleSelectAll",value:function(e,t,a){this.setState({selectItem:t})}},{key:"toolBarClick",value:function(e){var t=this,a={delType:"delUser",userids:this.state.selectedRowKeys.join(),irolegroupid:this.props.groupid};"add"==e?this.handleModal():"del"==e&&(this.state.selectedRowKeys.length>0?(0,w.vpAdd)("/{vpplat}/cfgrolegroup/delete",{sparam:(0,o["default"])(a)}).then(function(e){e.data.success&&t.setState({selectedRowKeys:[]},t.getData())}):VpAlertMsg({message:"消息提示",description:"请至少选择一条数据！",type:"error",closeText:"关闭",showIcon:!0},5))}},{key:"render",value:function(){var e=this,t=this.state.selectedRowKeys,a={type:"checkbox",selectedRowKeys:t,onSelect:this.handleSelect,onSelectAll:this.handleSelectAll,onChange:this.onSelectChange},n={entityrole:!1};return b["default"].createElement("div",{className:"business-container pr full-height"},b["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},b["default"].createElement(w.VpRow,{gutter:1},b["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:30},b["default"].createElement(w.VpTooltip,{placement:"top",title:"新建"},b["default"].createElement(w.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",icon:"plus",onClick:function(){return e.toolBarClick("add")}})),b["default"].createElement(w.VpTooltip,{placement:"top",title:"删除"},b["default"].createElement(w.VpPopconfirm,{placement:"bottomLeft",title:"确认删除所选记录?",onConfirm:function(){return e.toolBarClick("del")},onCancel:this.cancel},b["default"].createElement(w.VpButton,{type:"ghost",style:{margin:"0 3px"},shape:"circle",icon:"cross"})))))),b["default"].createElement("div",{className:"business-wrapper p-t-sm full-height"},b["default"].createElement("div",{className:"p-sm bg-white"},b["default"].createElement(w.VpTable,{columns:this.state.table_headers,dataSource:this.state.table_array,onChange:this.tableChange,onRowClick:this.onRowClick,pagination:this.state.pagination,rowSelection:a,rowKey:function(e){return e.iid},resize:!0}))),b["default"].createElement(w.VpModal,{title:"添加用户",visible:this.state.updateCharer,width:"70%",footer:null,wrapClassName:"modal-no-footer",onCancel:function(){return e.cancelChoosen()}},this.state.updateCharer?b["default"].createElement(V["default"],{item:{irelationentityid:"2"},initValue:[],params:{},onCancel:function(){return e.cancelChoosen()},onOk:function(t){return e.submitChoosen(t)}}):""),b["default"].createElement(w.VpModal,{title:this.state.modaltitle,visible:this.state.visible,width:"70%",footer:null,wrapClassName:"modal-no-footer",onCancel:function(){return e.handleCancel()}},this.state.visible?b["default"].createElement(x.VpDynamicForm,{className:"p-sm full-height scroll p-b-xxlg",ref:function(t){return e.dynamic=t},bindThis:this,formData:this.state.increaseData,params:n}):""))}}]),t}(y.Component);t["default"]=k=(0,w.VpFormCreate)(k)},1050:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(363),l=n(i),s=a(802),o=n(s),r=a(688),d=n(r),u=a(54),c=n(u),p=a(55),f=n(p),h=a(59),m=n(h),g=a(93),v=n(g),y=a(8),b=n(y),w=a(4),C=a(652),V=a(1051),x=n(V),k=a(1054),E=n(k),S=a(1055),R=(n(S),a(979)),_=n(R),T=a(784),N=(n(T),w.VpSteps.Step,function(e){function t(e){(0,c["default"])(this,t);var a=(0,m["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.systemRole=function(){var e=a;(0,w.vpQuery)("/{vpplat}/api/pur/point",{saccesskey:"system"}).then(function(t){var a=!0;t.data.system>0&&(a=!1),e.setState({disabled:a})})},a.getHeader=function(){var e=a;(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListHeader",{pageType:"rolegroup"}).then(function(t){var a=t.data;if(a&&(e.setState({loading:!1}),a.hasOwnProperty("grid"))){var n=[];a.grid.hasOwnProperty("fields")&&(a.grid.fields.map(function(e,t){var a=void 0,i=void 0,l=void 0,s=void 0;for(var o in e)"title"==o?a=e[o]:"field"==o&&(i=e[o]),"fixed"==o&&(s=e[o]),"width"==o&&(l=e[o]);a&&i&&("left"==s||"right"==s?n.push({title:a,dataIndex:i,key:i,width:l,fixed:s}):n.push({title:a,dataIndex:i,key:i,fixed:s}))}),e.setState({table_headers:n}))}})["catch"](function(e){})},a.getData=function(){var e=a,t={type:1,pageType:"rolegroup",idepartmentid:0};t.curr=a.state.cur_page,t.limit=a.state.num_perpage,(0,w.vpAdd)("/{vpplat}/cfgrolegroup/getListData",{sparam:(0,o["default"])(t)}).then(function(t){var a=t.data.data,n=!0;t.data.accesslevel>0&&(n=!1);var i=function(){return"共"+a.totalRows+"条"};e.setState({disabled:n,table_array:a.resultList,cur_page:a.currentPage,total_rows:a.totalRows,num_perpage:a.numPerPage,pagination:{total:a.totalRows,showTotal:i,pageSize:a.numPerPage,onShowSizeChange:e.onShowSizeChange,showSizeChanger:!0,showQuickJumper:!0}})})["catch"](function(e){"function"!=typeof e||e()})},a.onRowClick=function(e){a.showRightBox(e)},a.closeRightBox=function(e){a.setState({showRightBox:!1},function(){a.getData()})},a.showRightBox=function(e){a.setState({showRightBox:!0,groupid:e.iid,iid:e.iid,edit:!0})},a.tabsChange=function(e){a.setState({VpTabsValue:e})},a.nextbox=function(e){a.setState({VpTabsValue:e})},a.nextiidhuoqu=function(e){a.setState({groupid:1*e}),a.forceUpdate()},a.loadRightWindow=function(){return a.state.groupid>0?b["default"].createElement(w.VpTabs,{activeKey:a.state.VpTabsValue,onChange:a.tabsChange},b["default"].createElement(w.VpTabPane,{tab:"功能权限",key:"0"},b["default"].createElement(E["default"],{groupid:a.state.groupid,edit:a.state.edit,activeValue:a.state.VpTabsValue,nextbox:a.nextbox.bind(a),closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"数据权限",key:"1"},b["default"].createElement(x["default"],{groupid:a.state.groupid,edit:a.state.edit,activeValue:a.state.VpTabsValue,nextbox:a.nextbox.bind(a),closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"选择用户",key:"2"},b["default"].createElement(_["default"],{disabled:a.state.disabled,groupid:a.state.groupid}))):a.state.groupid<=0&&0!=a.state.VpTabsValue?b["default"].createElement(w.VpTabs,{activeKey:a.state.VpTabsValue,onChange:a.tabsChange},b["default"].createElement(w.VpTabPane,{tab:"功能权限",key:"0"},b["default"].createElement(E["default"],{groupid:a.state.groupid,edit:a.state.edit,iid:a.state.iid,nextiidhuoqu:a.nextiidhuoqu.bind(a),activeValue:a.state.VpTabsValue,nextbox:a.nextbox.bind(a),closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"数据权限",key:"1"},b["default"].createElement(x["default"],{groupid:a.state.groupid,edit:a.state.edit,iid:a.state.iid,activeValue:a.state.VpTabsValue,nextbox:a.nextbox.bind(a),closeRightBox:a.closeRightBox})),b["default"].createElement(w.VpTabPane,{tab:"选择用户",key:"2"},b["default"].createElement(_["default"],{disabled:a.state.disabled}))):b["default"].createElement(w.VpTabs,{activeKey:a.state.VpTabsValue,onChange:a.tabsChange},b["default"].createElement(w.VpTabPane,{tab:"功能权限",key:"0"},b["default"].createElement(E["default"],{groupid:a.state.groupid,iid:a.state.iid,nextiidhuoqu:a.nextiidhuoqu.bind(a),activeValue:a.state.VpTabsValue,nextbox:a.nextbox.bind(a),closeRightBox:a.closeRightBox})))},a.state={groupid:0,visible:!1,filters:[],table_headers:[],table_array:[],cur_page:1,num_perpage:10,pagination:{},selectedRowKeys:[],showRightBox:!1,disabled:!0,VpTabsValue:"0",iid:"",edit:!1},a.handleSelect=a.handleSelect.bind(a),a.handleSelectAll=a.handleSelectAll.bind(a),a.onSelectChange=a.onSelectChange.bind(a),a.tableChange=a.tableChange.bind(a),a}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){this.getHeader(),this.getData()}},{key:"componentDidMount",value:function(){$(".ant-table-body").height($(window).height()-232),this.systemRole()}},{key:"tableChange",value:function(e,t,a){var n=this;this.setState({cur_page:e.current||this.state.cur_page,num_perpage:e.pageSize||this.state.num_perpage},function(){n.getData()})}},{key:"onShowSizeChange",value:function(e){}},{key:"handleSelect",value:function(e,t,a){var n=0;t?this.setState({selectedRowKeys:[].concat((0,l["default"])(this.state.selectedRowKeys),[e.iid])}):(this.state.selectedRowKeys.forEach(function(t,a){t===e.iid&&(n=a)}),this.setState({selectedRowKeys:[].concat((0,l["default"])(this.state.selectedRowKeys.slice(0,n)),(0,l["default"])(this.state.selectedRowKeys.slice(n+1)))}))}},{key:"onSelectChange",value:function(e){this.setState({selectedRowKeys:e})}},{key:"handleSelectAll",value:function(e,t,a){this.setState({selectItem:t})}},{key:"toolBarClick",value:function(e){var t=this;if("add"==e)this.setState({groupid:0,showRightBox:!0,mockData:[],targetKeys:[],sname:"",sdescription:"",idepartmentid:0,idepartmentname:"",VpTabsValue:"0"});else if("del"==e){var a={delType:"delGroup",ids:this.state.selectedRowKeys.join()};this.state.selectedRowKeys.length>0?(0,w.vpAdd)("/{vpplat}/cfgrolegroup/delete",{sparam:(0,o["default"])(a)}).then(function(e){e.data.success&&t.setState({selectedRowKeys:[]},t.getData())}):(0,w.VpAlertMsg)({message:"消息提示",description:"请至少选择一条数据！",type:"error",closeText:"关闭",showIcon:!0},5)}}},{key:"render",value:function(){var e=this,t=this.state.selectedRowKeys,a={type:"checkbox",selectedRowKeys:t,onSelect:this.handleSelect,onSelectAll:this.handleSelectAll,onChange:this.onSelectChange};return b["default"].createElement("div",{className:"business-container pr full-height"},b["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},b["default"].createElement(w.VpRow,{gutter:1},b["default"].createElement(w.VpCol,{className:"gutter-row text-right",span:30},this.state.disabled?null:b["default"].createElement(w.VpTooltip,{placement:"top",title:"新建"},b["default"].createElement(w.VpButton,{type:"primary",style:{margin:"0 3px"},shape:"circle",icon:"plus",onClick:function(){return e.toolBarClick("add")},disabled:this.state.disabled})),b["default"].createElement(w.VpTooltip,{placement:"top",title:"删除"},b["default"].createElement(w.VpPopconfirm,{placement:"bottomLeft",title:"确认删除所选记录?",onConfirm:function(){return e.toolBarClick("del")},onCancel:this.cancel},b["default"].createElement(w.VpButton,{type:"ghost",style:{margin:"0 3px"},shape:"circle",icon:"cross",disabled:this.state.disabled})))))),b["default"].createElement("div",{className:"business-wrapper full-height p-t-sm"},b["default"].createElement("div",{className:"p-sm bg-white full-height scroll-y"},b["default"].createElement(w.VpTable,{columns:this.state.table_headers,dataSource:this.state.table_array,onChange:this.tableChange,onRowClick:this.onRowClick,pagination:this.state.pagination,rowSelection:a,rowKey:function(e){return e.iid},resize:!0}))),b["default"].createElement(C.RightBox,{max:!0,button:b["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightBox},b["default"].createElement(w.VpTooltip,{placement:"top",title:""},b["default"].createElement(w.VpIcon,{type:"right"}))),tips:b["default"].createElement("div",{className:"tips p-xs"},b["default"].createElement(w.VpTooltip,{placement:"top",title:"0000"},b["default"].createElement(w.VpIcon,{type:"exclamation-circle text-muted m-r-xs"}))),show:this.state.showRightBox},this.state.showRightBox?this.loadRightWindow():null),b["default"].createElement(w.VpModal,{title:this.state.modaltitle,visible:this.state.visible,onOk:function(){return e.cancelModal()},onCancel:function(){return e.cancelModal()},width:"80%",height:"100%",maskClosable:!1,footer:null,wrapClassName:"modal-no-footer"}))}}]),t}(y.Component));t["default"]=N=(0,w.VpFormCreate)(N)},1051:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(802),l=n(i),s=a(688),o=n(s),r=a(54),d=n(r),u=a(55),c=n(u),p=a(59),f=n(p),h=a(93),m=n(h),g=a(8),v=n(g),y=a(4),b=a(810);n(b);a(1052);for(var w=[],C=0;C<46;C++)w.push({key:C,name:"李大嘴"+C,age:32,address:"西湖区湖底公园"+C+"号"});var V=function(e){function t(e){(0,d["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,o["default"])(t)).call(this,e));return a.nextiidhuoqu=function(e){a.setState({groupid:1*e}),a.forceUpdate()},a.onChange1=function(e,t){var n=["","","","",""];if("["==e[0]);else for(var i in e)"0"==e[i]?n[0]="0":"1"==e[i]?n[1]="1":"2"==e[i]?n[2]="2":"3"==e[i]&&(n[3]="3");e=n;var l=a.state.data,s=function d(e,t){e.datavalue&&(e.datavalue=t),e.children&&e.children.map(function(e,a){d(e,t)})};!function u(t,a){t&&t.map(function(t,n){a.key==t.key?s(t,e):u(t.children,a)})}(l,t);var o=0,r=function c(a){for(var n=o;n<t.parents.length;n++)a.key==t.parents[n]&&(a.datavalue&&(a.datavalue=e),a.children&&(o+1<t.parents.length&&(o+=1),a.children.map(function(e,t){c(e)})))};!function(e){e.map(function(e,t){r(e)})}(l),a.tableRef.getTableData(l),a.forceUpdate()},a.state={groupid:e.groupid,sname:"",idepartmentid:0,idepartmentname:"",sdescription:"",mockData:[],targetKeys:[],titles:[],operations:[],isOnly:!1,updateCharer:!1,rolewidth:400,roleheight:200,disabled:!1,value:["0-0-0"],expandedKeys:["0-0-0","0-0-1"],autoExpandParent:!0,checkedKeys:["0-0-0"],selectedKeys:[],treeData:[],selectId:"",visible:!1,treeKeys:[],loading:!1,data:[]},a}return(0,m["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this;(0,y.vpQuery)("/{vpplat}/cfgfunction/datatree",{iid:e.state.groupid}).then(function(t){e.setState({data:t.data.data,treeKeys:t.data.treekeys})})}},{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillReceiveProps",value:function(e){var t=this;1==e.activeValue&&(0,y.vpQuery)("/{vpplat}/cfgfunction/datatree",{iid:e.groupid}).then(function(a){t.setState({data:a.data.data,groupid:e.groupid,treeKeys:a.data.treekeys})})}},{key:"handleSubmit1",value:function(){this.props.nextbox(1*this.props.activeValue-1+"")}},{key:"handleSubmit",value:function(){var e=this,t=this;this.props.form.validateFields(function(a,n){var i={iid:t.state.groupid,treedata:t.state.data};0!=t.props.groupid&&(t.setState({loading:!0}),(0,y.vpAdd)("/{vpplat}/cfgfunction/savedata",{sparam:(0,l["default"])(i)}).then(function(a){a.data.success?(t.setState({loading:!1}),(0,y.VpAlertMsg)({message:"消息提示",description:1==t.props.edit?"修改成功":"保存成功",type:"success",onClose:e.onClose,closeText:"关闭",showIcon:!0},5),0==t.props.edit&&t.props.nextbox(1*t.props.activeValue+1+"")):(t.setState({loading:!1}),(0,y.VpAlertMsg)({message:"消息提示",description:1==t.props.edit?"修改失败":"保存失败",type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5))}))})}},{key:"render",value:function(){var e=this,t=(this.props.form.getFieldProps,[{title:"",dataIndex:"name",key:"name",width:300},{title:"数据权限",key:"operation",width:400,render:function(t,a,n){if(a.datavalue)return v["default"].createElement(y.VpCheckbox,{value:a.datavalue,options:vp.config.vpplat==undefined||vp.config.vpplat.dataAuthority==undefined?[{label:"负责人",value:"0"},{label:"部门负责人",value:"2"},{label:"全部",value:"3"}]:vp.config.vpplat.dataAuthority,onChange:function(t){return e.onChange1(t,a)}})}}]);return v["default"].createElement("div",{className:"business-container full-height scroll RolePermissionForm"},v["default"].createElement(y.VpSpin,{spinning:this.state.loading},v["default"].createElement("div",{className:"bg-white p-sm"},v["default"].createElement("h4",{className:"p-b-sm fw b-b",style:{marginTop:-40}},"基本信息")),v["default"].createElement("div",{className:"baseDiv",key:"baseDiv"},v["default"].createElement(y.VpForm,{horizontal:!0},v["default"].createElement("div",{className:"bg-white full-height"},v["default"].createElement(y.VpRow,{style:{marginTop:20},className:"full-height"},v["default"].createElement(y.VpCol,{sm:3,className:"text-right p-lr-sm"},v["default"].createElement("label",{className:"ant-form-item-required ant-form-item-label label body label"},"数据列表:")),v["default"].createElement(y.VpCol,{key:"transfer",sm:21,className:"full-height"},v["default"].createElement("div",{className:"VpTableBox"},v["default"].createElement(y.VpTable,{ref:function(t){return e.tableRef=t},defaultExpandedRowKeys:this.state.treeKeys,pagination:!1,columns:t,dataSource:this.state.data}))))))),v["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer",style:{position:"absolute"}},(this.props.edit,v["default"].createElement(y.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",size:"large",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"保存")))))}}]),t}(g.Component);t["default"]=V=(0,y.VpFormCreate)(V)},1052:function(e,t,a){var n=a(1053);"string"==typeof n&&(n=[[e.id,n,""]]);var i={hmr:!0};i.transform=void 0;a(439)(n,i);n.locals&&(e.exports=n.locals)},1053:function(e,t){},1054:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(155),l=n(i),s=a(802),o=n(s),r=a(688),d=n(r),u=a(54),c=n(u),p=a(55),f=n(p),h=a(59),m=n(h),g=a(93),v=n(g),y=a(8),b=n(y),w=a(4),C=a(810);n(C);a(1052);var V=function(e){function t(e){(0,c["default"])(this,t);var a=(0,m["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.loadForm=function(){(0,w.vpAdd)("/{vpplat}/cfgrolegroup/get",{sparam:(0,o["default"])({irolegroupid:a.state.groupid})}).then(function(e){if(e.data.success){var t=e.data.data,n={sname:t.sname,sdescription:t.sdescription,idepartmentid:t.idepartmentid,idepartmentname:t.idepartmentname},i=[];""!=t.idepartmentid&&"0"!=t.idepartmentid&&""!=t.idepartmentid&&(i=[{iid:t.idepartmentid,sname:t.idepartmentname}]),a.setState({initValue:i}),a.setState(n,function(){a.getMock()})}})},a.getMock=function(){},a.nextiidhuoqu=function(e){a.setState({groupid:1*e}),a.forceUpdate()},a.onChange=function(e,t){var n=["",""];if("["==e[0]);else for(var i in e)"0"==e[i]?n[0]="0":"1"==e[i]&&(n[0]="0",n[1]="1");e=n;var l=a.state.data,s=function d(e,t){e.value=t,e.children&&e.children.map(function(e,a){d(e,t)})};!function u(t,a){t&&t.map(function(t,n){a.key==t.key?s(t,e):u(t.children,a)})}(l,t);var o=0,r=function c(a){for(var n=o;n<t.parents.length;n++)a.key==t.parents[n]&&(a.value=e,a.children&&(o+1<t.parents.length&&(o+=1),a.children.map(function(e,t){c(e)})))};!function(e){e.map(function(e,t){r(e)})}(l),a.tableRef.getTableData(l),a.forceUpdate()},a.state={groupid:a.props.groupid?a.props.groupid:"",sname:"",idepartmentid:0,idepartmentname:"",sdescription:"",mockData:[],targetKeys:[],titles:[],operations:[],isOnly:!1,updateCharer:!1,rolewidth:400,roleheight:200,disabled:!1,value:["0-0-0"],expandedKeys:["0-0-0","0-0-1"],autoExpandParent:!0,checkedKeys:["0-0-0"],selectedKeys:[],treeData:[],selectId:"",visible:!1,loading:!1,loadingList:!0,treeKeys:[],data:[]},a}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){this.loadForm();var e=this;e.state.groupid,(0,w.vpQuery)("/{vpplat}/cfgfunction/funtree",0==this.props.groupid?"":{iid:this.props.groupid}).then(function(t){e.setState({data:t.data.data,treeKeys:t.data.treekeys,loadingList:!1},function(){e.forceUpdate()})})}},{key:"componentWillReceiveProps",value:function(e){var t=this;0==e.activeValue&&(0,w.vpQuery)("/{vpplat}/cfgfunction/funtree",{iid:e.groupid}).then(function(e){t.setState({data:e.data.data,treeKeys:e.data.treekeys})})}},{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"handleSubmit",value:function(){var e=this,t=this,a=!0;this.props.form.validateFields(function(n,i){var s=$("#sname").val(),r=void 0;r=0==e.props.groupid?{iid:e.props.groupid,sname:s,treedata:t.state.data}:(0,l["default"])({iid:e.props.groupid,sname:s,treedata:t.state.data},"iid",t.state.groupid),""==s||s==undefined?(a=!1,(0,w.VpAlertMsg)({message:"消息提示",description:'"名称不能为空！',type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5)):s.length>200&&(a=!1,(0,w.VpAlertMsg)({message:"消息提示",description:"名称长度不能超过200个字符！",type:"error",closeText:"关闭",showIcon:!0},5)),a&&(t.setState({loading:!0}),0==e.props.groupid?(0,w.vpAdd)("/{vpplat}/cfgfunction/savetree",{sparam:(0,o["default"])(r)}).then(function(a){a.data.success?(t.setState({loading:!1,groupid:a.data.iid}),(0,w.VpAlertMsg)({message:"消息提示",description:1==t.props.edit?"修改成功":"保存成功",type:"success",onClose:e.onClose,closeText:"关闭",showIcon:!0},5),t.props.nextbox(1*t.props.activeValue+1+""),t.props.nextiidhuoqu(a.data.iid),t.forceUpdate()):(t.setState({loading:!1}),(0,w.VpAlertMsg)({message:"消息提示",description:1==t.props.edit?"修改失败":"保存失败",type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5))}):(0,w.vpAdd)("/{vpplat}/cfgfunction/savetree",{sparam:(0,o["default"])(r)}).then(function(a){a.data.success?(t.setState({loading:!1}),(0,w.VpAlertMsg)({message:"消息提示",description:1==t.props.edit?"修改成功":"保存成功",type:"success",onClose:e.onClose,closeText:"关闭",showIcon:!0},5),0==t.props.edit&&t.props.nextbox(1*t.props.activeValue+1+""),t.forceUpdate()):(t.setState({loading:!1}),(0,w.VpAlertMsg)({message:"消息提示",description:1==t.props.edit?"修改失败":"保存失败",type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5))}))})}},{key:"render",value:function(){var e=this,t=(this.props.form.getFieldProps,[{title:"",dataIndex:"name",key:"name",width:300},{title:"操作权限",key:"operation",width:400,render:function(t,a,n){return b["default"].createElement(w.VpCheckbox,{value:a.value,options:vp.config.vpplat==undefined||vp.config.vpplat.authorize==undefined?[{label:"查看",value:"0"},{label:"编辑",value:"1"}]:vp.config.vpplat.authorize,onChange:function(t){return e.onChange(t,a)}})}}]);return b["default"].createElement("div",{className:"business-container full-height scroll RolePermissionForm"},b["default"].createElement(w.VpSpin,{spinning:this.state.loading},b["default"].createElement("div",{className:"bg-white p-sm"},b["default"].createElement("h4",{className:"p-b-sm fw b-b",style:{marginTop:-40}},"基本信息")),b["default"].createElement("div",{className:"baseDiv",key:"baseDiv"},b["default"].createElement(w.VpForm,{horizontal:!0},""!=this.state.sname?b["default"].createElement("div",null,b["default"].createElement(w.VpRow,null,b["default"].createElement(w.VpCol,{span:3,className:"text-right p-lr-sm "},b["default"].createElement("label",{className:"ant-form-item-required ant-form-item-label label body label"},"角色名称:")),b["default"].createElement(w.VpCol,{span:21},b["default"].createElement(w.VpInput,{id:"sname",defaultValue:this.state.sname,placeholder:"请输入角色名称",ref:"vpsname"})))):"",b["default"].createElement("div",{className:"bg-white full-height"},b["default"].createElement(w.VpRow,{style:{marginTop:20},className:"full-height"},b["default"].createElement(w.VpCol,{sm:3,className:"text-right p-lr-sm"},b["default"].createElement("label",{className:"ant-form-item-required ant-form-item-label label body label"},"功能列表:")),b["default"].createElement(w.VpCol,{key:"transfer",sm:21,className:"full-height"},b["default"].createElement("div",{className:"VpTableBox"},b["default"].createElement(w.VpTable,{ref:function(t){return e.tableRef=t},defaultExpandedRowKeys:this.state.treeKeys,pagination:!1,columns:t,dataSource:this.state.data,loading:this.state.loadingList}))))))),b["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer",style:{position:"absolute"}},(this.props.edit,b["default"].createElement(w.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",size:"large",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"保存")))))}}]),t}(y.Component);t["default"]=V=(0,w.VpFormCreate)(V)},1055:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(14),l=n(i),s=a(785),o=n(s),r=a(802),d=n(r),u=a(688),c=n(u),p=a(54),f=n(p),h=a(55),m=n(h),g=a(59),v=n(g),y=a(93),b=n(y),w=a(8),C=n(w),V=a(4),x=a(810);n(x);a(1052);var k=function(e){function t(e){(0,f["default"])(this,t);var a=(0,v["default"])(this,(t.__proto__||(0,c["default"])(t)).call(this,e));return a.loadForm=function(){(0,V.vpAdd)("/{vpplat}/cfgrolegroup/get",{sparam:(0,d["default"])({irolegroupid:a.state.groupid})}).then(function(e){if(e.data.success){var t=e.data.data,n={sname:t.sname,sdescription:t.sdescription,idepartmentid:t.idepartmentid,idepartmentname:t.idepartmentname},i=[];""!=t.idepartmentid&&"0"!=t.idepartmentid&&""!=t.idepartmentid&&(i=[{iid:t.idepartmentid,sname:t.idepartmentname}]),a.setState({initValue:i}),a.setState(n,function(){a.getMock()})}})},a.getMock=function(){var e=[],t=[],n=["待选角色列表","已选角色列表"],i=["添加","移除"],l={scode:"role",irolegroupid:a.state.groupid>0?a.state.groupid:0};(0,V.vpAdd)("/{vpplat}/cfgrolegroup/geDataList",{sparam:(0,d["default"])(l)}).then(function(l){if(l.data.success){for(var s=l.data.data.inlist,o=l.data.data.outlist,r=0;r<s.length;r++){var d={key:s[r].iid,title:s[r].sname,description:s[r].sname,chosen:!0};t.push(d),e.push(d.key)}for(var u=0;u<o.length;u++){var c={key:o[u].iid,title:o[u].sname,description:o[u].sname,chosen:!1};t.push(c)}a.setState({targetKeys:e,mockData:t,titles:n,operations:i})}else(0,V.VpAlertMsg)({message:"消息提示",description:"加载角色列表失败！",type:"error",closeText:"关闭",showIcon:!0},5)})},a.getTreeData=function(){(0,V.vpAdd)("http://devtest.yf.vpsoft.cn/vpgatway/vpplatprovider/vfm/cfgDictionary/getDictionaryDataTree").then(function(e){a.setState({treeData:e.data})})["catch"](function(e){})},a.loadData=function(e){return 1==e.props.async?(0,V.vpQuery)("http://www.vpsoft.cn:8082/apistatic/Json/asyncTree.json").then(function(t){a.treeRef.addChildren(e.props.eventKey,t.data)}):o["default"].resolve()},a.titleNode=function(e){return C["default"].createElement("div",null,C["default"].createElement(V.VpIcon,{className:"tree-icon",type:e.icon||"file-text text-primary"}),e.level," ",e.name,null!=e.propertys?C["default"].createElement("span",{style:{background:"#2db7f5",margin:"0px 5px",padding:" 0 3px",color:"#fff"}},"管控点"):null)},a.onCheck=function(e,t){},a.state={groupid:0,sname:"",idepartmentid:0,idepartmentname:"",sdescription:"",mockData:[],targetKeys:[],titles:[],operations:[],isOnly:!1,updateCharer:!1,rolewidth:400,roleheight:200,disabled:!1,value:["0-0-0"],expandedKeys:["0-0-0","0-0-1"],autoExpandParent:!0,checkedKeys:["0-0-0"],selectedKeys:[],treeData:[],selectId:"",visible:!1},a}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({groupid:this.props.groupid},function(){e.loadForm(),e.getTreeData()})}},{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){var e=this;$("#description").val(this.state.sdescription),this.state.titles.length>0&&400==this.state.rolewidth&&setTimeout(function(){var t=.47*$("#description").width(),a=.35*$(window).height();e.setState({rolewidth:t,roleheight:a})},500)}},{key:"handleSubmit1",value:function(){this.props.nextbox(1*this.props.activeValue-1+"")}},{key:"handleSubmit",value:function(){var e=this,t=this,a=!0;this.props.form.validateFields(function(n,i){var l=t.treeRef.checkedKeys;i.sname;if(""==i.sname||i.sname==undefined?(a=!1,(0,V.VpAlertMsg)({message:"消息提示",description:'"名称不能为空！',type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5)):i.sname.length>200?(a=!1,(0,V.VpAlertMsg)({message:"消息提示",description:"名称长度不能超过200个字符！",type:"error",closeText:"关闭",showIcon:!0},5)):l.length<=0&&(a=!1,(0,V.VpAlertMsg)({message:"消息提示",description:'"至少选择一个权限',type:"error",onClose:e.onClose,closeText:"关闭",showIcon:!0},5)),a)return void t.props.closeRightBox()})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldProps;return C["default"].createElement("div",{className:"business-container full-height scroll RolePermissionForm"},C["default"].createElement("div",{className:"bg-white p-sm"},C["default"].createElement("h4",{className:"p-b-sm fw b-b",style:{marginTop:-40}},"基本信息")),C["default"].createElement("div",{className:"baseDiv",key:"baseDiv"},C["default"].createElement(V.VpForm,{horizontal:!0},""!=this.state.sname?C["default"].createElement("div",null,C["default"].createElement(V.VpRow,null,C["default"].createElement(V.VpCol,{span:3,className:"text-right p-lr-sm "},C["default"].createElement("label",{className:"ant-form-item-required ant-form-item-label label body label"},"角色名称:")),C["default"].createElement(V.VpCol,{span:21},C["default"].createElement(V.VpInput,(0,l["default"])({id:"sname",defaultValue:this.state.sname,placeholder:"请输入角色名称"},t("sname",{initialValue:this.state.sname,rules:[{required:!0,message:"角色名称不能为空!"}]})))))):"",C["default"].createElement("div",{className:"bg-white full-height"},C["default"].createElement(V.VpRow,{style:{marginTop:20},className:"full-height"},C["default"].createElement(V.VpCol,{sm:3,className:"text-right p-lr-sm"},C["default"].createElement("label",{className:"ant-form-item-required ant-form-item-label label body label"},"功能列表:")),C["default"].createElement(V.VpCol,{key:"transfer",sm:21,className:"full-height"},C["default"].createElement(V.VpTree,{checkable:!0,ref:function(t){return e.treeRef=t},treeData:this.state.treeData,loadData:this.loadData,titleNode:this.titleNode,onCheck:this.onCheck,hasSearch:!0,textCheck:!0})))))),C["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer",style:{position:"absolute"}},C["default"].createElement(V.VpButton,{className:"vp-btn-br",key:"saveBat1",type:"primary",size:"large",onClick:function(){return e.handleSubmit1()},disabled:this.state.disabled},"上一步"),C["default"].createElement(V.VpButton,{className:"vp-btn-br",key:"saveBat",type:"primary",size:"large",onClick:function(){return e.handleSubmit()},disabled:this.state.disabled},"完成")))}}]),t}(w.Component);t["default"]=k=(0,V.VpFormCreate)(k)}});