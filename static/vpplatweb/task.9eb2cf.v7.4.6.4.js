webpackJsonp([19],{1002:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var a=e.length-t.length;return a>=0&&e.lastIndexOf(t)==a}Object.defineProperty(t,"__esModule",{value:!0});var l=a(363),r=n(l),o=a(802),s=n(o),c=a(14),d=n(c),u=a(688),p=n(u),f=a(54),m=n(f),h=a(55),v=n(h),y=a(59),g=n(y),b=a(93),w=n(b),E=a(8),k=n(E),x=a(4),S=a(835),C=n(S),V=a(1003),N=n(V);a(1016);var T=a(832),R=n(T),D=a(652),I=function(e){function t(e){(0,m["default"])(this,t);var a=(0,g["default"])(this,(t.__proto__||(0,p["default"])(t)).call(this,e));return a.loadDocType=function(){(0,x.vpQuery)("/{vpplat}/vfrm/entity/doctype",{entityid:a.state.entityid}).then(function(e){a.setState({doctypelist:e.data,selectType:e.data[0].value})})},a.openupload=function(e){var t=e.iid;a.state.editrowdata[t]=e,a.setState({VpUploader:!0,currentiid:e.iid,editrowdata:a.state.editrowdata})},a.queryEntityType=function(){(0,x.vpQuery)("/{vpplat}/vfrm/entity/entitytype",{entityid:a.state.entityid}).then(function(e){var t=e.data.flowtype;a.setState({entitytype:e.data.entitytype,flowtype:t})})},a.handleViewChange=function(e){a.setState({view:e.target.value,viewtype:e.target.value},function(){"card"==e.target.value?a.defaultConfig():a.getHeader()})},a.querySearchFormData=function(){(0,x.vpQuery)("/{vpplat}/vfrm/entity/searchForm",{entityid:a.state.entityid,scode:"search"}).then(function(e){a.setState({SearchFormData:e.data.form})})},a.chooseModalVisible=function(e){a.chooseVisible=e},a.getconfig=function(){var e=a;(0,x.vpQuery)("/{vpplat}/vfrm/entity/getConfig",{entityid:e.state.entityid}).then(function(t){if(t.hasOwnProperty("data")){if(t.data.hasOwnProperty("search")){var a=t.data.lastview;a=""==a||a==undefined?"0":a;var n=t.data.search.filters;e.setState({filtervalue:a,widget_show_none:t.data.search,filters:n,statusFilters:t.data.search.statusFilters,classFilters:t.data.search.classFilters})}t.data.hasOwnProperty("toolbar")&&(e.setState({widget_show_none_tool:t.data.toolbar}),t.data.toolbar.hasOwnProperty("formSearch")&&t.data.toolbar.formSearch.hasOwnProperty("form")&&t.data.toolbar.formSearch.form.hasOwnProperty("groups")&&t.data.toolbar.formSearch.form.groups[0].hasOwnProperty("fields")&&(t.data.toolbar.formSearch.form.groups[0].fields[0].field_name="form_sname",e.setState({formSearch_data:t.data.toolbar.formSearch.form.groups[0].fields})),t.data.toolbar.hasOwnProperty("tabs")&&e.setState({tabs:t.data.toolbar.tabs}),t.data.hasOwnProperty("entityrole")&&e.setState({entityaddrole:t.data.entityrole}))}})},a.callBack=function(e){var t=e.iid;a.state.editrowdata[t]=e,a.setState({editrowdata:a.state.editrowdata})},a.getEditHeader=function(){var e=a,t={entityid:e.state.entityid,viewcode:"initeditlist"};(0,x.vpQuery)("/{vpplat}/vfrm/entity/initEditGrids",(0,d["default"])({},t)).then(function(t){if(t&&t.hasOwnProperty("data")){var a=[],n=t.data.fields;if(0==n.length)return(0,x.VpAlertMsg)({message:"消息提示",description:"未查询到编辑列表视图！",type:"error",onClose:this.onClose,closeText:"关闭",showIcon:!0},5),void e.setState({table_headers:[]});n.length;n.map(function(t,n){var i=void 0,l=void 0,r=void 0,o=void 0;for(var s in t)"field_label"==s?i=t[s]:"field_name"==s&&(l=t[s]),"fixed"==s&&(o=t[s]),"iwidth"==s&&(r=t[s]);i&&l&&("left"==o||"right"==o?a.push({title:i,dataIndex:l,key:l,width:r,fixed:o}):a.push({title:i,dataIndex:l,key:l,width:r,fixed:o,render:t.edit_col?function(a,n){return k["default"].createElement(D.EditTableCol,{callBack:e.callBack,record:n,widget:t.widget,item:(0,d["default"])({},t.widget,{irelationentityid:t.irelationentityid}),value:a})}:null}))}),a.push({title:"操作",fixed:"right",width:120,key:"operation",render:function(t,a){return k["default"].createElement("span",null,k["default"].createElement(x.VpTooltip,{placement:"top",title:"附件"},k["default"].createElement(x.VpIconFont,{onClick:function(){return e.openupload(a)},className:"text-primary m-lr-xs cursor",type:"vpicon-paperclip"})),"0"==a.istatusflag&&e.state.entityaddrole?k["default"].createElement(x.VpTooltip,{placement:"top",title:"删除"},k["default"].createElement(x.VpPopconfirm,{title:"确定要删除这条信息吗？",onConfirm:function(){return e.confirm(a.ientityid,a.iid)},onCancel:e.cancel},k["default"].createElement(x.VpIconFont,{className:"cursor m-lr-xs text-danger",type:"vpicon-shanchu"}))):null,a.iid>0?k["default"].createElement(x.VpTooltip,{placement:"top",title:"查看详情"},k["default"].createElement(x.VpIconFont,{onClick:function(){return e.onRowClick(a,"")},className:"text-primary m-lr-xs cursor",type:"vpicon-navopen"})):null)}}),e.setState({table_headers:a,tableloading:!1})}})["catch"](function(t){e.setState({tableloading:!1})})},a.barEvent=function(e,t,n,i,l){"summary"==e?(a.setState({isClickMenu:!0}),(0,x.vpAdd)("/{vpplat}/vfrm/entity/summary",{entityid:n,iid:i}).then(function(e){a.setState({isClickMenu:!1}),(0,x.VpAlertMsg)({message:"消息提示",description:"计算汇总成功!",type:"success",onClose:a.onClose,closeText:"关闭",showIcon:!0},5)})):"weekreport"==e?(a.setState({isClickMenu:!0}),(0,x.vpQuery)("/{vpmprovider}/weekport/addweekreport",{projectid:i,startdate:"",enddate:""}).then(function(e){a.setState({isClickMenu:!1}),(0,x.VpAlertMsg)({message:"消息提示",description:"生成周报成功!",type:"success",onClose:a.onClose,closeText:"关闭",showIcon:!0},5)})):"delete"==e?a.confirm(n,i):"discuss"==e?a.discuss(t,n,i):"collect"==e?a.handleLike(t,n,i,l):("7"==n&&"pjtree"==a.state.viewtype&&(i=i.substr(0,i.length-1)),a.jumpTabs(e,n,i));try{t.stopPropagation()}catch(t){}},a.menuClick=function(e,t,n,i){a.barEvent(e.key,e,t,n,i)},a.discuss=function(e,t,n){try{e.stopPropagation()}catch(e){}var i="entity"+t+"_discuss";a.jumpTabs(i,t,n)},a.document=function(e,t,n){try{e.stopPropagation()}catch(e){}var i="entity"+t+"_file";a.jumpTabs(i,t,n)},a.jumpTabs=function(e,t,n){a.setState({defaultActiveKey:e+"tab",showRightBox:!0,entityiid:n,row_entityid:t,row_id:n})},a.documentList=function(e,t,n){try{e.stopPropagation()}catch(e){}var i="entity"+t+"_doclist";a.jumpDocListTabs(i,t,n)},a.jumpDocListTabs=function(e,t,n){(0,x.vpQuery)("/{vpmprovider}/project/getProjectBySub",{subiid:n}).then(function(i){a.setState({defaultActiveKey:e+"tab",showRightBox:!0,subItemProjectId:i.data.iprojectid,entityiid:n,row_entityid:t,row_id:n})})},a.getExpandedRowa=function(e,t){var n=a,i=t;if(e.length){var l=[];e.map(function(e){i.push(e.key),e.hasOwnProperty("children")&&"pjtree"!=n.state.viewtype&&(l=n.getExpandedRowa(e.children,i),l.map(function(e){-1==i.findIndex(function(t){return e===t})&&i.push(e)}))})}return i},a.handleSearchForm=function(e){a.setState({searchData:e,s_visible:!1})},a.confirm=function(e,t){var n=a;(0,x.vpAdd)("/{vpplat}/vfrm/entity/deleteData",{iid:t,entityid:e}).then(function(e){n.tableRef.getTableData()})},a.queryentityRole=function(e,t){(0,x.vpQuery)("/{vpplat}/vfrm/entity/entityRole",{entityid:e,iid:t}).then(function(e){a.setState({entityrole:e.data.entityRole})})},a.handleStatus=function(e,t,a){},a.uploadSuccess=function(e,t){(0,x.VpAlertMsg)({message:"消息提示",description:"导入成功！",type:"success",onClose:a.onClose,closeText:"关闭",showIcon:!0},5),a.setState({entityVisible:!1},function(){return a.tableRef.getTableData()})},a.uploadClick=function(){a.inputUploader.upload.on("beforeFileQueued",function(e){a.props.form.setFieldsValue({xls_label:e.name})})},a.inputUploaderChange=function(e){},a.cancelSearch=function(){a.setState({s_visible:!1})},a.handleLike=function(e,t,n){try{e.stopPropagation()}catch(e){}(0,x.vpAdd)("/{vpplat}/vfrm/entity/handleLike",{ientityid:t,iid:n}).then(function(e){a.tableRef.getTableData()})},a.shrinkLeft=function(e){a.setState({shrinkShow:!a.state.shrinkShow},function(){})},a.handleClick=function(e){var t=e.key,n=e.keyPath.slice(1),i=e.keyPath.slice(1)[0];a.state.filtervalue==t&&a.state.currentkey==i||a.setState({filtervalue:t,openKeys:n,currentkey:i,tableloading:!0})},a.onToggle=function(e){a.setState({openKeys:e.open?e.keyPath:e.keyPath.slice(1)})},a.queryclassList=function(){(0,x.vpQuery)("/{vpplat}/vfrm/tasks/classList",{entityid:a.state.entityid}).then(function(e){a.setState({classList:e.data})})},a.handleNewClick=function(e){var t=e.key.split(",")[1],n=e.key.split(",")[0],i=e.domEvent.currentTarget.innerText;a.setState({showRightBox:!0,row_entityid:a.state.entityid,row_id:"",add:!0,entityiid:"",statusList:[],defaultActiveKey:"0",viewcode:t,currentclassid:n,currentclassname:i})},a.defaultConfig=function(){(0,x.vpQuery)("/{vpplat}/vfrm/tasks/initview",{mainentityid:a.state.mainentityid,mainentityiid:a.state.mainentityiid}).then(function(e){var t=[];""==e.data&&null==e.data||e.data.map(function(e,a){t.push({istatusid:e})}),a.setState({defaultStatusList:e.data,multiSelect:e.data,cardStatusList:t})})},a.handleStatusConfig=function(){a.setState({cardconfig:!a.state.cardconfig})},a.queryTaskStatus=function(){(0,x.vpQuery)("/{vpplat}/vfrm/tasks/statusList",{entityid:114}).then(function(e){a.setState({statusboardlist:e.data})})},a.handleMultiSelect=function(e){a.setState({multiSelect:e})},a.statusDom=function(){var e={labelCol:{span:5},wrapperCol:{span:17}};return k["default"].createElement("div",{className:"task-boardform bg-white p-sm"},a.state.statusboardlist.length?k["default"].createElement(x.VpForm,{horizontal:!0,ref:"form",style:{marginTop:3}},k["default"].createElement(x.VpRow,null,k["default"].createElement(x.VpFSelect,(0,d["default"])({label:"状态"},e),k["default"].createElement(x.VpSelect,{multiple:!0,placeholder:"请选择状态",defaultValue:a.state.defaultStatusList,onChange:a.handleMultiSelect},a.state.statusboardlist.map(function(e,t){return k["default"].createElement(x.VpOption,{key:t,value:e.iid},e.sname)}))),k["default"].createElement(x.VpCol,{sm:24,className:"text-center"},k["default"].createElement(x.VpButton,{className:"vp-btn-br",style:{marginTop:10},type:"primary",onClick:a.okStatusConfig},"保存"),k["default"].createElement(x.VpButton,{className:"vp-btn-br",style:{marginTop:10,marginLeft:5},type:"ghost",onClick:a.cancleStatusConfig},"取消")))):"")},a.cancleStatusConfig=function(){a.setState({cardconfig:!1})},a.okStatusConfig=function(){var e=a.state.multiSelect;if(0==e.length)(0,x.VpAlertMsg)({message:"消息提示",description:"请选择需要配置的状态列！",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);else{var t={multiSelect:e};(0,x.vpAdd)("/{vpplat}/vfrm/tasks/changeInitView",{param:(0,s["default"])(t)}).then(function(t){var n=[];e.map(function(e,t){n.push({istatusid:e})}),a.board.queryCardData(n),a.setState({cardStatusList:n,cardconfig:!1})})}},a.onRef=function(e){a.board=e},a.handleEditAdd=function(){a.tableRef.addTableRow({iid:a.objectid--});var e=vp.computedHeight(1,".taskTable");a.setState({tableHeight:e})},a.handleEditSave=function(){var e=a.state.editrowdata;if($.isEmptyObject(e))return void(0,x.VpAlertMsg)({message:"消息提示",description:"暂无可保存的数据！",type:"error",onClose:a.onClose,closeText:"关闭",showIcon:!0},5);var t=[];for(var n in e)if(e.hasOwnProperty(n)){var l=e[n];delete l.undefined,delete l.className;var r=a.state.filearr[l.iid];""!=r&&r!=undefined&&(l.fileinfo=r);for(var o in l)if(i(o,"val")){var c=o.replace("val","");l[c]=l[o]}l.iid=l.iid>0?l.iid:"",t.push(l)}(0,x.vpAdd)("/{vpplat}/vfrm/entity/saveEditData",{entityid:a.state.entityid,editData:(0,s["default"])(t)}).then(function(e){a.tableRef.getTableData(),a.setState({editrowdata:{},filearr:{}})})},a.handleReload=function(){a.setState({tableloading:!0}),a.tableRef.getTableData()},a.controlAddButton=function(e,t){var n=vp.computedHeight(t.length,".taskTable"),i=a.getExpandedRowa(t,[]);a.setState({tableloading:!1,expandedRowKeys:i,tableHeight:n})},a.onUploadAccept=function(e,t){var n=a,i={fileid:t.data.fileid,doctype:t.data.doctype};n.state.filearr[n.state.currentiid]!=undefined&&null!=n.state.filearr[n.state.currentiid]?n.state.filearr[n.state.currentiid]=[].concat((0,r["default"])(n.state.filearr[n.state.currentiid]),[i]):n.state.filearr[n.state.currentiid]=[i],a.setState({filearr:n.state.filearr})},a.handleFileCancel=function(){a.setState({VpUploader:!1})},a.state={filters:[],visible2:!1,visible:!1,showRightBox:!1,widget_show_none:"",widget_show_none_tool:"",table_headers:[],quickvalue:"",activeKey:"1",increaseData:[],tabs_array:[],tabs:null,isAdd:!1,formSearch_data:[],form_data:[],formdata:[],entityid:"",iids:"",row_id:"",row_entityid:"",entityiid:"",add:!0,statusList:[],varilsForm:{},viewtype:"",entityrole:!1,exShow:!1,exList:[],entityVisible:!1,toolbar:{},rowbar:[],SearchFormData:{},searchData:[],loading:!1,expandedRowKeys:[],tableHeight:"",tips:"",defaultActiveKey:"0",shrinkShow:!0,openKeys:["filter"],view:"tree",classList:[],statusFilters:[],classFilters:[],currentkey:"filter",scode:"",sname:"",subItemProjectId:"",entitytype:!1,cardconfig:!1,defaultStatusList:[],statusboardlist:[],cardStatusList:[],multiSelect:[],flowtype:"",currentclassid:"",viewcode:"",tableloading:!0,editrowdata:{},VpUploader:!1,filearr:{},doctypelist:[],selectType:""},a.objectid=0,a.closeRightModal=a.closeRightModal.bind(a),a.handleOk=a.handleOk.bind(a),a.handlesearch=a.handlesearch.bind(a),a.handleVisibleChange=a.handleVisibleChange.bind(a),a.onRowClick=a.onRowClick.bind(a),a.getHeader=a.getHeader.bind(a),a.cancelModal=a.cancelModal.bind(a),a.exTypeData=a.exTypeData.bind(a),a.handleMenuClick=a.handleMenuClick.bind(a),a.onExpand=a.onExpand.bind(a),a.handleDropDown=a.handleDropDown.bind(a),a}return(0,w["default"])(t,e),(0,v["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.params?(e.params.entityid!=this.props.params.entityid&&this.setState({entityid:e.params.entityid,showRightBox:!1,viewtype:""},function(){t.getHeader(),t.querySearchFormData(),t.queryclassList(),t.getconfig(),t.queryEntityType()}),e.params.type!=this.props.params.type&&this.setState({viewtype:e.params.type,showRightBox:!1},function(){t.getHeader(),t.querySearchFormData(),t.getconfig(),t.queryclassList(),t.queryEntityType()})):this.setState({viewtype:e.viewtype,entityid:e.entityid,toolbar:e.toolbar,rowbar:e.rowbar,showRightBox:!1},function(){t.getHeader(),t.getconfig(),t.tableRef.getTableData()})}},{key:"componentWillMount",value:function(){var e=this;this.setState({entityid:this.props.params?this.props.params.entityid:this.props.entityid,viewtype:this.props.params?this.props.params.type:this.props.type,toolbar:this.props.toolbar,rowbar:this.props.rowbar},function(){e.getHeader(),e.exTypeData(),e.getconfig(),e.querySearchFormData(),e.queryclassList(),e.queryEntityType(),e.queryTaskStatus(),e.loadDocType()})}},{key:"componentDidMount",value:function(){$(".search").find("input").attr("maxlength",400)}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"getHeader",value:function(){this.setState({tableloading:!0});var e=this;if("edit"==e.state.viewtype)return void this.getEditHeader();(0,x.vpQuery)("/{vpplat}/vfrm/entity/getheaders",{entityid:e.state.entityid}).then(function(t){if(t&&t.hasOwnProperty("data")&&(e.setState({loading:!1}),t.data.hasOwnProperty("grid"))){var a=[];if(t.data.grid.hasOwnProperty("fields")){t.data.grid.fields.map(function(e,t){var n=void 0,i=void 0,l=void 0,r=void 0;for(var o in e)"field_label"==o?n=e[o]:"field_name"==o&&(i=e[o]),"fixed"==o&&(r=e[o]),"iwidth"==o&&(l=e[o]);n&&i&&("left"==r||"right"==r?a.push({title:n,dataIndex:i,key:i,width:l,fixed:r}):a.push({title:n,dataIndex:i,key:i,width:l,fixed:r,sorter:!0}))});var n=["bg-success","bg-warning","bg-danger"],i=k["default"].createElement("div",null,k["default"].createElement(x.VpTooltip,{title:"进度"},k["default"].createElement(x.VpIconFont,{type:"vpicon-tip",className:"m-r-xs text-success"})),k["default"].createElement(x.VpTooltip,{title:"状态"},k["default"].createElement(x.VpIconFont,{type:"vpicon-check",className:"m-r-xs text-success"})),k["default"].createElement(x.VpTooltip,{title:"文档"},k["default"].createElement(x.VpIconFont,{type:"vpicon-wenben",className:"m-r-xs text-success"}))),l={title:i,width:115,dataIndex:"indicator",key:"indicator",render:function(e,t){var a=t.lights&&1==t.lights.scheduleflag?0:1,i=t.lights&&1==t.lights.statusflag?1:0,l=t.lights?t.lights.fileflag:"";return k["default"].createElement("div",{className:"indic-wrapper inline-display"},k["default"].createElement(x.VpTooltip,{title:0==a?"正常进度":"进度逾期"},k["default"].createElement("span",{key:0,className:n[a]})),1==i?k["default"].createElement(x.VpTooltip,{title:"已完成"},k["default"].createElement(x.VpIconFont,{type:"vpicon-check",className:"m-r-xs text-success"})):null,1==l?k["default"].createElement(x.VpTooltip,{title:"文档"},k["default"].createElement("span",{key:3,className:"bg-success"})):"")}},r=a,o=e.state,s=o.entityid;o.viewtype;114==s&&r.unshift(l),r.map(function(e,t){if("icontrolmode"==e.key){var a=k["default"].createElement("div",{className:"inline-display"},"管控模式");e.title=a,e.width=120,e.render=function(e,t){return k["default"].createElement("div",{className:"indic-wrapper",style:{textAlign:"center"}},"2"==t.icontroltype?k["default"].createElement(x.VpTag,{color:"blue"},"敏捷"):k["default"].createElement(x.VpTag,{color:"yellow"},"瀑布"))}}}),r.push({title:"操作",fixed:"right",width:100,key:"operation",render:function(t,a){var n=[],i=!1;i=!("0"!=a.istatusflag||!e.state.entityaddrole||"0"==a.principal&&"2"!=e.state.entityid),null!=vp.config.vpplat&&null!=vp.config.vpplat.operation&&vp.config.vpplat.operation.oprlist!=undefined&&vp.config.vpplat.operation.oprlist.map(function(e,t){if("collect"==e.key){var l=e.sname==undefined?"关注":e.sname;n.push({key:"collect",sname:0==a.ilike?l:"取消"+l,classname:"text-primary m-lr-xs cursor",type:1==a.ilike?"vpicon-star":"vpicon-star-o"})}else if("discuss"==e.key){var r=e.sname==undefined?"评论":e.sname;n.push({key:"discuss",sname:r,classname:"text-primary m-lr-xs cursor",type:"vpicon-pinglun"})}else if("delete"==e.key&&1==i){var o=e.sname==undefined?"删除":e.sname;n.push({key:"delete",sname:o,classname:"cursor m-r-xs f16 text-danger",type:"vpicon-shanchu"})}}),0==n.length&&(n.push({key:"collect",sname:0==a.ilike?"关注":"取消关注",classname:"text-primary m-lr-xs cursor",type:1==a.ilike?"vpicon-star":"vpicon-star-o"}),n.push({key:"discuss",sname:"评论",classname:"text-primary m-lr-xs cursor",type:"vpicon-pinglun"}),1==i&&n.push({key:"delete",sname:"删除",classname:"cursor m-r-xs f16 text-danger",type:"vpicon-shanchu"}));var l=[],r=vp.config.vpplat!=undefined&&vp.config.vpplat.operation!=undefined&&vp.config.vpplat.operation.count!=undefined?vp.config.vpplat.operation.count:2;return k["default"].createElement("span",null,n.map(function(t,n){if(n<r)return"delete"==t.key?k["default"].createElement(x.VpTooltip,{placement:"top",title:"删除"},k["default"].createElement(x.VpPopconfirm,{title:"确定要删除吗？",onConfirm:function(){return e.confirm(a.ientityid,a.iid)}},k["default"].createElement(x.VpIconFont,{onClick:function(e){e.stopPropagation()},className:t.classname,type:t.type}))):k["default"].createElement(x.VpTooltip,{placement:"top",title:t.sname},k["default"].createElement(x.VpIconFont,{onClick:function(n){return e.barEvent(t.key,n,a.ientityid,a.iid,a)},className:t.classname,type:t.type}));l.push(t)}),l.length>0?k["default"].createElement(x.VpTooltip,{placement:"top",title:"更多"},e.state.isClickMenu?null:k["default"].createElement(x.VpDropdown,{overlay:k["default"].createElement(x.VpMenu,{onClick:function(t){return e.menuClick(t,a.ientityid,a.iid)}},l.map(function(e,t){return k["default"].createElement(x.VpMenuItem,{key:e.key},k["default"].createElement(x.VpIconFont,{className:e.classname,type:e.type}),e.sname)})),trigger:["click"],getPopupContainer:function(){return document.body}},k["default"].createElement(x.VpIconFont,{"data-id":a.iid,className:"cursor m-lr-xs f16",type:"vpicon-wait-x",onClick:function(e){return e.stopPropagation()}}))):null)}}),e.setState({table_headers:r,tableloading:!1})}}})["catch"](function(t){e.setState({tableloading:!1})})}},{key:"onExpand",value:function(e,t){if("pjtree"==this.state.viewtype&&"7"==t.ientityid&&e){var a=t.iid;(0,x.vpAdd)("/{vpplat}/vfrm/entity/subList",{iid:a.substr(0,a.length-1)}).then(function(e){var a;t.children.splice(0);var n=e.data;(a=t.children).push.apply(a,(0,r["default"])(n))})}if(e)this.setState({expandedRowKeys:[].concat((0,r["default"])(this.state.expandedRowKeys),[t.key])});else{var n=this.state.expandedRowKeys.findIndex(function(e){return t.key===e});this.setState({expandedRowKeys:[].concat((0,r["default"])(this.state.expandedRowKeys.slice(0,n)),(0,r["default"])(this.state.expandedRowKeys.slice(n+1)))})}}},{key:"handleDropDown",value:function(e){try{e.stopPropagation()}catch(e){}}},{key:"exTypeData",value:function(){var e=this;(0,x.vpQuery)("/{vpplat}/vfrm/entity/exListType",{entityid:this.state.entityid}).then(function(t){e.setState({exList:t.data})})}},{key:"handlesearch",value:function(e){var t=e.replace(/\s/g,"");this.setState({quickvalue:t})}},{key:"onShowSizeChange",value:function(e){}},{key:"showModal",value:function(e){e.target.dataset.id;this.setState({showRightBox:!0,isAdd:!1})}},{key:"closeRightModal",value:function(){this.setState({showRightBox:!1,tabs_array:[],add:!1,istatusid:"",row_id:"",currentclassname:""}),this.props.setBreadCrumb()}},{key:"handleStatusCancel",value:function(){this.setState({visible:!1,entityVisible:!1,varilsForm:{}})}},{key:"cancelModal",value:function(){this.setState({visible:!1,entityVisible:!1,varilsForm:{}})}},{key:"handleOk",value:function(){this.setState({showRightBox:!1}),this.saveRowData(this.props.form.getFieldsValue())}},{key:"handleVisibleChange",value:function(){if(!this.chooseVisible){this.state.SearchFormData.groups.length>0?this.setState({s_visible:!this.state.s_visible}):(0,x.VpAlertMsg)({message:"消息提示",description:"暂无可搜索项，请配置搜索表单！",type:"error",onClose:this.onClose,closeText:"关闭",showIcon:!0},5)}}},{key:"onRowClick",value:function(e,t){var a=e.iid,n=e.sname,i=e.scode,l=e.ientityid;this.setState({showRightBox:!0,subItemProjectId:e.iprojectid,add:!1,entityiid:a,row_entityid:l,row_id:a,s_visible:!1,defaultActiveKey:"",sname:n,scode:i}),this.props.setBreadCrumb(n)}},{key:"handleMenuClick",value:function(e){var t=e.item.props.type;e.key;if(5==t)this.setState({entityVisible:!0});else{(0,x.vpDownLoad)("/{vpplat}/vfrm/ent/exportfile",{quickvalue:this.state.quickvalue,ientityid:this.state.entityid,type:"expdata",viewcode:"expexcel",filtervalue:this.state.filtervalue,currentkey:this.state.currentkey,condition:(0,s["default"])(this.state.searchData)})}}},{key:"handleSubmit",value:function(e){"upload"==e?this.inputUploader.upload.upload():(0,x.vpDownLoad)("/{vpplat}/vfrm/ent/exportfile",{ientityid:this.state.entityid,type:""})}},{key:"render",value:function(){var e=this,t=this,a=[];"edit"==this.state.viewtype&&(a=[{title:"新增",tooltip:!1,className:"cursor blue",type:"plus-circle-o",iconClickFunction:this.handleEditAdd},{title:"保存",tooltip:!1,className:"cursor green",type:"save",iconClickFunction:this.handleEditSave},{title:"刷新",tooltip:!1,className:"cursor sky_blue",type:"reload",iconClickFunction:this.handleReload}]);var n=k["default"].createElement(x.VpMenu,{onClick:this.handleMenuClick},t.state.exList.map(function(e,t){return k["default"].createElement(x.VpMenuItem,{key:e.iid,type:e.iviewtype},e.sname)})),i=k["default"].createElement("div",{className:"search-form bg-white ant-dropdown-menu"},k["default"].createElement(C["default"],{chooseModalVisible:this.chooseModalVisible,cancelSearch:this.cancelSearch,handleSearchForm:this.handleSearchForm,formData:this.state.SearchFormData})),l=k["default"].createElement(x.VpMenu,{onClick:this.handleNewClick},this.state.classList.map(function(e,t){return k["default"].createElement(x.VpMenuItem,{key:e.iid+","+e.scode},k["default"].createElement(x.VpIconFont,{type:e.icon})," ",e.sname)}));return k["default"].createElement("div",{className:"business-container pr full-height task"},k["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},k["default"].createElement(x.VpRow,{gutter:10},k["default"].createElement(x.VpCol,{className:"gutter-row",span:4},k["default"].createElement("div",{className:"m-b-sm search"},k["default"].createElement(D.SeachInput,{onSearch:this.handlesearch}))),k["default"].createElement(x.VpCol,{className:"gutter-row text-right",span:20},"card"==this.state.view?k["default"].createElement(x.VpTooltip,{placement:"top",title:"看板配置"},k["default"].createElement(x.VpDropdown,{onClick:this.handleStatusConfig,trigger:["click"],overlay:this.statusDom(),visible:this.state.cardconfig,onVisibleChange:this.handleStatusConfig},k["default"].createElement("div",{style:{display:"inline-block"}},k["default"].createElement(x.VpButton,{shape:"circle",icon:"setting",className:"m-l-xs"})))):"",this.state.entityaddrole&&this.state.classList.length>0?k["default"].createElement(x.VpTooltip,{placement:"top",title:"快速创建"},k["default"].createElement(x.VpDropdown,{trigger:["click"],overlay:l},k["default"].createElement("div",{style:{display:"inline-block"}},k["default"].createElement(x.VpButton,{type:"primary",shape:"circle",icon:"plus",className:"m-l-xs"})))):"","tree"==this.state.view?k["default"].createElement(x.VpDropdown,{trigger:["click"],overlay:n},k["default"].createElement("div",{style:{display:"inline-block"}},k["default"].createElement(x.VpTooltip,{placement:"top",title:"导入导出"},k["default"].createElement(x.VpButton,{type:"ghost",shape:"circle",className:"m-l-xs"},k["default"].createElement(x.VpIcon,{type:"cloud-upload"}))))):"",k["default"].createElement(x.VpDropdown,{onClick:this.handleVisibleChange,trigger:["click"],overlay:i,onVisibleChange:this.handleVisibleChange,visible:this.state.s_visible},k["default"].createElement("div",{style:{display:"inline-block"},id:"searchbox"},k["default"].createElement(D.FindCheckbox,null))),k["default"].createElement("div",{className:"fr m-l-xs"},k["default"].createElement(x.VpRadioGroup,{defaultValue:"tree",className:"radio-tab",onChange:this.handleViewChange},vp.config.vpplat!=undefined&&vp.config.vpplat.viewlist!=undefined&&1==vp.config.vpplat.viewlist.card?k["default"].createElement(x.VpRadioButton,{value:"card"},k["default"].createElement(x.VpTooltip,{placement:"top",title:"看板视图"},k["default"].createElement(x.VpIconFont,{type:"vpicon-file-tree"}))):null,vp.config.vpplat!=undefined&&vp.config.vpplat.viewlist!=undefined&&1==vp.config.vpplat.viewlist.tree?k["default"].createElement(x.VpRadioButton,{value:"tree"},k["default"].createElement(x.VpTooltip,{placement:"top",title:"树视图"},k["default"].createElement(x.VpIconFont,{type:"vpicon-navlist"}))):null,vp.config.vpplat!=undefined&&vp.config.vpplat.viewlist!=undefined&&1==vp.config.vpplat.viewlist.editList?k["default"].createElement(x.VpRadioButton,{value:"edit"},k["default"].createElement(x.VpTooltip,{placement:"top",title:"编辑视图"},k["default"].createElement(x.VpIconFont,{type:"vpicon-fenlei"}))):null))))),"card"!=this.state.view?k["default"].createElement("div",{className:"business-wrapper p-t-sm full-height",id:"table"},k["default"].createElement("div",{className:"bg-white p-sm entity-list full-height"},k["default"].createElement(x.VpRow,{gutter:16,className:"full-height"},k["default"].createElement(x.VpCol,{span:this.state.shrinkShow?"4":"0",className:"full-height pr menuleft"},k["default"].createElement(x.VpMenu,{className:"full-height scroll-y",onClick:this.handleClick,openKeys:this.state.openKeys,onOpen:this.onToggle,onClose:this.onToggle,selectedKeys:[this.state.filtervalue],mode:"inline"},k["default"].createElement(x.VpSubMenu,{key:"filter",title:k["default"].createElement("span",null,k["default"].createElement(x.VpIconFont,{type:"vpicon-filter",className:"m-r-xs"}),k["default"].createElement("span",{className:"f14"},"过滤器"))},this.state.filters.map(function(e,t){return k["default"].createElement(x.VpMenuItem,{className:"menu-text-overflow",key:e.value},k["default"].createElement("span",{className:"f14"},e.name))})),k["default"].createElement(x.VpSubMenu,{key:"status",title:k["default"].createElement("span",null,k["default"].createElement(x.VpIconFont,{type:"vpicon-loading",className:"m-r-xs"}),k["default"].createElement("span",{className:"f14"},"状态"))},this.state.statusFilters.map(function(e,t){return k["default"].createElement(x.VpMenuItem,{className:"menu-text-overflow",key:e.value},k["default"].createElement("span",{className:"f14"},e.name))}),k["default"].createElement(x.VpMenuItem,{className:"f14",key:"0"},k["default"].createElement("span",{className:"f14"},"全部"))),k["default"].createElement(x.VpSubMenu,{key:"class",title:k["default"].createElement("span",null,k["default"].createElement(x.VpIconFont,{type:"vpicon-fenlei",className:"m-r-xs"}),k["default"].createElement("span",{className:"f14"},"类别"))},this.state.classFilters.map(function(e,t){return k["default"].createElement(x.VpMenuItem,{className:"menu-text-overflow",key:e.value},k["default"].createElement("span",{className:"f14"},e.name))}),k["default"].createElement(x.VpMenuItem,{className:"f14",key:"0"},k["default"].createElement("span",{className:"f14"},"全部")))),this.state.shrinkShow?k["default"].createElement("div",{className:"navswitch cursor text-center",onClick:this.shrinkLeft},k["default"].createElement(x.VpIconFont,{type:"vpicon-navclose"})):""),k["default"].createElement(x.VpCol,{span:this.state.shrinkShow?"20":"24",className:"full-height scroll-y"},this.state.shrinkShow?"":k["default"].createElement("div",{className:"shrink p-tb-sm cursor text-center",onClick:this.shrinkLeft},k["default"].createElement(x.VpIconFont,{type:"vpicon-navopen"})),this.state.filtervalue!=undefined?k["default"].createElement("div",{className:"edit"==this.state.viewtype?"batch-table":""},k["default"].createElement(D.VpDTable,{loading:this.state.tableloading,ref:function(t){return e.tableRef=t},queryMethod:"POST",onExpand:this.onExpand,expandedRowKeys:this.state.expandedRowKeys,controlAddButton:function(t,a){e.controlAddButton(t,a)},dataUrl:"/{vpplat}/vfrm/entity/dynamicListData",params:{entityid:this.state.entityid,currentkey:this.state.currentkey,condition:(0,s["default"])(this.state.searchData),filtervalue:this.state.filtervalue,quickSearch:this.state.quickvalue,viewtype:"edit"==this.state.viewtype?"initeditlist":this.state.viewtype,datafilter:"auth"},className:"taskTable",expandIconColumnIndex:1,columns:this.state.table_headers,onRowClick:"edit"==this.state.viewtype?null:this.onRowClick,tableOptions:a,bindThis:this,showTotal:"tree"==this.state.viewtype,rowKey:"iid",scroll:{y:this.state.tableHeight},resize:!0})):null)))):k["default"].createElement(N["default"],{cardStatusList:this.state.cardStatusList,entityaddrole:this.state.entityaddrole,onRef:this.onRef,initView:this.defaultConfig,flowtype:this.state.flowtype}),k["default"].createElement("div",{className:"drawer-fixed p-sm hide"},k["default"].createElement("div",{className:"pr full-height"},k["default"].createElement("div",{className:"spin-icon",onclick:"closeDrawer"},k["default"].createElement(x.VpIcon,{type:"verticle-left"})),k["default"].createElement("div",{className:"drawer-box"}))),k["default"].createElement(D.RightBox,{max:!this.state.isAdd,button:k["default"].createElement("div",{className:"icon p-xs",onClick:this.closeRightModal},k["default"].createElement(x.VpTooltip,{placement:"top",title:""},k["default"].createElement(x.VpIcon,{type:"right"}))),tips:k["default"].createElement("div",{className:"tips p-xs"},k["default"].createElement(x.VpTooltip,{placement:"top",title:this.state.sname+"("+this.state.scode+")"},k["default"].createElement(x.VpIcon,{type:"exclamation-circle text-muted m-r-xs"}))),show:this.state.showRightBox},this.state.showRightBox?k["default"].createElement(R["default"],{param:{entityid:this.state.row_entityid,iid:this.state.row_id,type:this.state.add,viewtype:this.state.viewtype,entitytype:this.state.entitytype,defaultActiveKey:this.state.defaultActiveKey},data:{currentclassid:this.state.currentclassid,viewcode:this.state.viewcode},setBreadCrumb:function(t){return e.props.setBreadCrumb(t+e.state.currentclassname)},closeRightModal:function(){return e.closeRightModal()},refreshList:function(){return e.tableRef.getTableData()}}):null),k["default"].createElement(x.VpModal,{title:"实体导入",visible:this.state.entityVisible,onCancel:function(){return e.cancelModal()},width:"70%",footer:null,wrapClassName:"modal-no-footer"},this.state.entityVisible?k["default"].createElement("div",{onClick:this.uploadClick},k["default"].createElement(x.VpInputUploader,{form:this.props.form,item:{field_name:"xls",widget_type:"inputupload",field_label:"选择文件",all_line:2,tips:"请选择文件（*.xls,*.xlsx)",auto:!1,widget:{accept:{title:"Xls",extensions:"xlsx,xls"},upload_url:window.vp.config.URL.localHost+"/zuul/{vpplat}/vfrm/ent/importfile?entityid="+this.state.entityid}},ref:function(t){return e.inputUploader=t},onUploadAccept:this.uploadSuccess})):null,k["default"].createElement("div",{className:"footFixed p-sm b-t text-center"},k["default"].createElement(x.VpButton,{type:"primary",onClick:function(){return e.handleSubmit("upload")}},"导入数据"),k["default"].createElement(x.VpButton,{style:{marginLeft:"10px"},type:"primary",onClick:function(){return e.handleSubmit("download")}},"下载模板"))),k["default"].createElement(x.VpModal,{title:"选择附件",visible:this.state.VpUploader,onOk:this.handleFileCancel,onCancel:this.handleFileCancel,width:"70%",height:"80%",wrapClassName:"modal-no-footer dynamic-modal"},this.state.VpUploader?k["default"].createElement(x.VpUploader,{server:"/zuul/{vpplat}/file/uploadfile",onUploadAccept:this.onUploadAccept,fileTypes:this.state.doctypelist,selectType:this.state.selectType}):null))}}]),t}(E.Component);t["default"]=I=(0,x.VpFormCreate)(I)},1003:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(14),l=n(i),r=a(363),o=n(r),s=a(395),c=n(s),d=a(802),u=n(d),p=a(688),f=n(p),m=a(54),h=n(m),v=a(55),y=n(v),g=a(59),b=n(g),w=a(93),E=n(w),k=a(8),x=n(k),S=a(103),C=n(S),V=a(4),N=a(652),T=a(1004),R=n(T);a(1014);var D=function(e){function t(e){(0,h["default"])(this,t);var a=(0,b["default"])(this,(t.__proto__||(0,f["default"])(t)).call(this,e));return a.queryCardData=function(e){var t={statusList:e};(0,V.vpAdd)("/{vpplat}/vfrm/tasks/boardView",{param:(0,u["default"])(t)}).then(function(e){a.setState({cardData:e.data,cardlen:e.data.length},function(){a.setState({boxWidth:240*e.data.length})})})},a.dragula=function(e){var t=e.target,n=t.getAttribute("class");if(n)if(n.indexOf("toolkit-content-header")>=0&&!t.getAttribute("data-moved"))(0,R["default"])([a.refs.box],{moves:function(e,t,a){return a.classList.contains("toolkit-content-header")}}).on("drop",function(e){var t=$(".rowdata"),a=[];$.each(t,function(e,n){if(e<t.length-1){var i={};i.istatusid=$(n).attr("data-statusid"),i.title=$(n).children().children().attr("title"),a.push(i)}});var n={arrSortable:a};(0,V.vpAdd)("/{vpplat}/vfrm/tasks/arrSortable",{param:(0,u["default"])(n)}).then(function(e){})}),$(".toolkit-content-header").attr("data-moved","true");else if(2!=a.props.flowtype&&n.indexOf("toolkit-dragula-header")>=0&&!t.getAttribute("data-moved")){var i=[];a.state.cardData.map(function(e,t){i.push(a.refs["box"+t])});var l="",r=(0,R["default"])(i,{moves:function(e,t,a){return $(e).parent().prev().prev().find(".rowsCount").text()!=undefined&&(l=$(e).parent().prev().prev().find(".rowsCount")),a.classList.contains("ant-checkbox-group")},revertOnSpill:!0});r.on("drop",function(e){var t=$(e).prev().prev().parent().attr("data-statusid")||$(e).parent().prev().prev().parent().attr("data-statusid"),a=$(e).attr("data-istatusid"),n=$(e).attr("data-iid");if(t!=a){var i={iid:n,newstatusid:t,oldstatus:a};(0,V.vpAdd)("/{vpplat}/vfrm/tasks/cardSort",{param:(0,u["default"])(i)}).then(function(a){$(e).attr("data-istatusid",t);var n=parseInt($(l).text().replace("(","").replace(")",""))-1;$(l).text("("+n+")");var i=$(e).parent().prev().prev().find(".rowsCount"),r=parseInt($(i).text().replace("(","").replace(")",""))+1;$(i).text("("+r+")")})}}),$(".toolkit-dragula-header").attr("data-moved","true")}},a.handleCreate=function(e,t){C["default"].findDOMNode(a.refs[t]).setAttribute("class","p-sm block")},a.handleCreateClose=function(e,t){C["default"].findDOMNode(a.refs[t]).setAttribute("class","p-sm hide")},a.showRightBox=function(e,t){a.handleAdd(114,t),a.queryEntityRole(114,t)},a.queryEntityRole=function(e,t){(0,V.vpQuery)("/{vpplat}/vfrm/entity/entityRole",{entityid:e,iid:t}).then(function(e){a.setState({entityRole:e.data.entityRole})})},a.handleCreateSave=function(e,t,n){a.setState({cardData:[]});var i=a,l=$("#"+t).val(),r={};r.sname=l,r.istatusid=n,r.scode="",(0,V.vpAdd)("/{vpplat}/vfrm/entity/saveFormData",{sparam:(0,u["default"])(r),entityid:114}).then(function(e){e.data.iid;i.queryCardData(),$("#"+t).val("")})},a.handleAdd=function(e,t){(0,V.vpQuery)("/{vpplat}/vfrm/entity/getform",{entityid:e,iid:t,formType:"board",mainentityid:a.props.entityid,mainiid:a.props.row_id}).then(function(n){a.setState({entityformdata:n.data.form,showRightBox:!0,bentityid:e,biid:t,a_visible:!1})})},a.handleSave=function(e,t){a.saveRowData(e)},a.handleCancel=function(){a.setState({showRightBox:!1})},a.saveRowData=function(e){var t=a,n={};(0,c["default"])(e).forEach(function(t,a){e[t]==undefined?e[t]="":null==e[t]&&(e[t]=0),-1==t.indexOf("_label")&&(n[t]=e[t])}),(0,V.vpAdd)("/{vpplat}/vfrm/entity/saveFormData",{sparam:(0,u["default"])(n),entityid:a.state.bentityid,iid:a.state.biid}).then(function(e){e.data.iid;t.setState({cardData:[],showRightBox:!1,entityformdata:{},bentityid:"",biid:""}),t.queryCardData()})},a.handleMore=function(e,t,n,i,l,r){var s=a;if(1==e.key)a.setState({titleVisible:!0,cardtitle:t,ibentityid:114,istatusid:n,index:i,countSize:l});else{var c={ibentityid:114,istatusid:n};(0,V.vpAdd)("/{vpplat}/vfrm/tasks/deleteCol",{param:(0,u["default"])(c)}).then(function(e){var t=s.state.cardData.length-1;if(t>0){var a=void 0;s.state.cardData.map(function(e,t){e.istatusid===n&&(a=t)});var i=[].concat((0,o["default"])(s.state.cardData.slice(0,a)),(0,o["default"])(s.state.cardData.slice(a+1)));s.setState({cardData:i,cardlen:t})}else s.queryCardData();s.props.initView()})}},a.cancelModal=function(){a.setState({titleVisible:!1,cardtitle:""})},a.handleSubmit=function(){var e=$("#stitle").val(),t=a.state.index,n={ibentityid:114,istatusid:a.state.istatusid,newTitle:e};(0,V.vpAdd)("/{vpplat}/vfrm/tasks/updateTitle",{param:(0,u["default"])(n)}).then(function(e){}),$("#row"+t).text(e),a.setState({titleVisible:!1})},a.state={changeIconTitle:"收起",showRightBox:!1,statuslist:[],entityformdata:{},biid:"",bentityid:"",boxWidth:"auto",config:[],cardData:[],searchValue:"",titleVisible:!1,entityRole:!0,cardtitle:"",cardlen:"",cardStatusList:[]},a}return(0,E["default"])(t,e),(0,y["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({cardStatusList:this.props.cardStatusList},function(){e.queryCardData(e.state.cardStatusList)})}},{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillReceiveProps",value:function(e){}},{key:"closeRightModal",value:function(){this.setState({showRightBox:!1})}},{key:"render",value:function(){var e=this,t=this,a=t.props.form.getFieldProps;return x["default"].createElement("div",{className:"business-wrapper p-t-sm full-height job-board"},x["default"].createElement("div",{className:"bg-white p-sm full-height"},x["default"].createElement(V.VpRow,{ref:"menu",gutter:18,className:"full-height"},x["default"].createElement(V.VpCol,{span:24,className:"full-height scroll-x"},this.state.cardData?x["default"].createElement("div",{ref:"box",style:{width:this.state.boxWidth},className:"toolkit-content full-height",onMouseOver:this.dragula},t.state.cardData.map(function(t,a){var n=t;return x["default"].createElement(V.VpCol,{id:"rows"+a,key:"t"+a,span:6,className:"p-sm"},x["default"].createElement("div",{"data-statusid":t.istatusid,className:"rowdata toolkit-content-box bg-white p-b-sm"},x["default"].createElement("div",{className:"toolkit-content-header b-b p-sm clearfix"},x["default"].createElement("span",{className:"f14 fw fl rows",id:"row"+a,title:t.title,count:t.count},t.title),x["default"].createElement("span",{style:{marginTop:2},className:"f14 fw fl rowsCount"},"(",t.count,")"),x["default"].createElement("span",{className:"f14 fw fr cursor"},e.props.entityaddrole?x["default"].createElement(V.VpTooltip,{placement:"top",title:"快速创建"},x["default"].createElement(V.VpIconFont,{type:"vpicon-plus",className:"m-lr-sm",onClick:function(t){return e.handleCreate(t,"input"+a)}})):"",x["default"].createElement(V.VpTooltip,{placement:"top",title:"更多操作"},x["default"].createElement(V.VpDropdown,{trigger:["click"],overlay:x["default"].createElement(V.VpMenu,{onClick:function(n){return e.handleMore(n,t.title,t.istatusid,a,t.count,"rows"+a)}},x["default"].createElement(V.VpMenuItem,{key:"1"},"修改卡片名称"),x["default"].createElement(V.VpMenuItem,{key:"2"},"删除")),type:"ghost"},x["default"].createElement(V.VpIconFont,{type:"vpicon-navlist"}))))),x["default"].createElement("div",{className:"p-sm hide",ref:"input"+a},x["default"].createElement(V.VpInput,{id:"input"+a,suffix:x["default"].createElement("span",{className:"inline-display p-t-xs"},x["default"].createElement(V.VpIconFont,{type:"vpicon-check",onClick:function(n){return e.handleCreateSave(n,"input"+a,t.istatusid)}}),x["default"].createElement(V.VpIconFont,{className:"m-l-xs",type:"vpicon-close",onClick:function(t){return e.handleCreateClose(t,"input"+a)}}))})),x["default"].createElement("div",{ref:"box"+a,className:"gu-box"},t.carddata?t.carddata.map(function(t,a){return x["default"].createElement("div",{"data-istatusid":n.istatusid,"data-iid":t.iid,id:"sortableCard",key:"card"+a,className:"full-height m-t-sm b p-sm b-success",onClick:function(a){return e.showRightBox(a,t.iid)}},x["default"].createElement("div",{className:"gu-move"},x["default"].createElement(V.VpRow,{className:"p-b-xs toolkit-dragula-header"},x["default"].createElement(V.VpCol,{span:22},x["default"].createElement(V.VpCheckbox,{options:[{label:t.scode,value:t.iid}]})),x["default"].createElement(V.VpCol,{span:2},x["default"].createElement(V.VpIconFont,{className:"cursor",type:"vpicon-demand"}))),x["default"].createElement("p",{className:"p-tb-xs cursor"},t.sname),x["default"].createElement("div",null,x["default"].createElement(V.VpProgress,{percent:50,strokeWidth:5})),x["default"].createElement(V.VpRow,{className:"p-t-xs"},x["default"].createElement(V.VpCol,{span:22},x["default"].createElement(V.VpIconFont,{type:"vpicon-lishijilu"})," ",t.dcreatordate),x["default"].createElement(V.VpCol,{span:2},x["default"].createElement(V.VpTooltip,{placement:"top",title:t.icreator},x["default"].createElement(V.VpIconFont,{className:"cursor",type:"vpicon-user"}))))))}):"")))})):"")),x["default"].createElement(N.RightBox,{onClose:this.closeRightModal.bind(this),show:this.state.showRightBox,mask:!0},this.state.showRightBox?x["default"].createElement(V.VpTabs,{defaultActiveKey:"0"},x["default"].createElement(V.VpTabPane,{tab:"属性",key:0},x["default"].createElement(N.VpDynamicForm,{className:"p-sm full-height scroll p-b-xxlg",ref:function(t){return e.dynamic=t},bindThis:this,formData:this.state.entityformdata,handleOk:this.state.entityRole?this.handleSave:"",handleCancel:this.handleCancel,okText:"保 存"}))):""),x["default"].createElement(V.VpModal,{title:"修改名称",visible:this.state.titleVisible,onCancel:function(){return e.cancelModal()},width:"30%",height:"50%",footer:null,wrapClassName:"modal-no-footer"},x["default"].createElement(V.VpFInput,(0,l["default"])({label:"名称"},{labelCol:{span:3},wrapperCol:{span:19}},a("stitle",{initialValue:this.state.cardtitle}),{readOnly:!1})),x["default"].createElement("div",{className:"footFixed p-sm b-t text-center"},x["default"].createElement(V.VpButton,{className:"vp-btn-br",type:"primary",onClick:function(){return e.handleSubmit()}},"确定"),x["default"].createElement(V.VpButton,{className:"vp-btn-br",style:{marginLeft:"10px"},type:"ghost",onClick:function(){return e.cancelModal()}},"取消")))))}}]),t}(x["default"].Component);t["default"]=D=(0,V.VpFormCreate)(D)},1004:function(e,t,a){"use strict";function n(){function e(e){t(e),l(e.getElementsByTagName("*")).forEach(t)}function t(e){e.removeAttribute("data-reactid")}return i.apply(this,l(arguments)).on("cloned",e)}var i=a(1005),l=a(1007);e.exports=n},1005:function(e,t,a){(function(t){"use strict";function n(e,t){function a(e){return-1!==ce.containers.indexOf(e)||se.isContainer(e)}function n(e){var t=e?"remove":"add";i(x,t,"mousedown",C),i(x,t,"mouseup",F)}function o(e){i(x,e?"remove":"add","mousemove",V)}function h(e){var t=e?"remove":"add";w[t](x,"selectstart",S),w[t](x,"click",S)}function y(){n(!0),F({})}function S(e){re&&e.preventDefault()}function C(e){if(ee=e.clientX,te=e.clientY,!(1!==l(e)||e.metaKey||e.ctrlKey)){var t=e.target,a=N(t);a&&(re=a,o(),"mousedown"===e.type&&(m(t)?t.focus():e.preventDefault()))}}function V(e){if(re){if(0===l(e))return void F({});if(void 0===e.clientX||e.clientX!==ee||void 0===e.clientY||e.clientY!==te){if(se.ignoreInputTextSelection){var t=g("clientX",e),a=g("clientY",e);if(m(k.elementFromPoint(t,a)))return}var n=re;o(!0),h(),M(),D(n);var i=r(G);J=g("pageX",e)-i.left,Z=g("pageY",e)-i.top,E.add(ie||G,"gu-transit"),U(),K(e)}}}function N(e){if(!(ce.dragging&&W||a(e))){for(var t=e;f(e)&&!1===a(f(e));){if(se.invalid(e,t))return;if(!(e=f(e)))return}var n=f(e);if(n&&!se.invalid(e,t)){if(se.moves(e,n,t,v(e)))return{item:e,source:n}}}}function T(e){return!!N(e)}function R(e){var t=N(e);t&&D(t)}function D(e){Y(e.item,e.source)&&(ie=e.item.cloneNode(!0),ce.emit("cloned",ie,e.item,"copy")),z=e.source,G=e.item,ae=ne=v(e.item),ce.dragging=!0,ce.emit("drag",G,z)}function I(){return!1}function M(){if(ce.dragging){var e=ie||G;B(e,f(e))}}function _(){re=!1,o(!0),h(!0)}function F(e){if(_(),ce.dragging){var t=ie||G,a=g("clientX",e),n=g("clientY",e),i=s(W,a,n),l=q(i,a,n);l&&(ie&&se.copySortSource||!ie||l!==z)?B(t,l):se.removeOnSpill?A():L()}}function B(e,t){var a=f(e);ie&&se.copySortSource&&t===z&&a.removeChild(G),P(t)?ce.emit("cancel",e,z,z):ce.emit("drop",e,t,z,ne),O()}function A(){if(ce.dragging){var e=ie||G,t=f(e);t&&t.removeChild(e),ce.emit(ie?"cancel":"remove",e,t,z),O()}}function L(e){if(ce.dragging){var t=arguments.length>0?e:se.revertOnSpill,a=ie||G,n=f(a),i=P(n);!1===i&&t&&(ie?n&&n.removeChild(ie):z.insertBefore(a,ae)),i||t?ce.emit("cancel",a,z,z):ce.emit("drop",a,n,z,ne),O()}}function O(){var e=ie||G;_(),H(),e&&E.rm(e,"gu-transit"),le&&clearTimeout(le),ce.dragging=!1,oe&&ce.emit("out",e,oe,z),ce.emit("dragend",e),z=G=ie=ae=ne=le=oe=null}function P(e,t){var a;return a=void 0!==t?t:W?ne:v(ie||G),e===z&&a===ae}function q(e,t,n){for(var i=e;i&&!function(){if(!1===a(i))return!1;var l=Q(i,e),r=X(i,l,t,n);return!!P(i,r)||se.accepts(G,i,z,r)}();)i=f(i);return i}function K(e){function t(e){ce.emit(e,r,oe,z)}if(W){e.preventDefault();var a=g("clientX",e),n=g("clientY",e),i=a-J,l=n-Z;W.style.left=i+"px",W.style.top=l+"px";var r=ie||G,o=s(W,a,n),c=q(o,a,n),d=null!==c&&c!==oe;(d||null===c)&&(function(){oe&&t("out")}(),oe=c,function(){d&&t("over")}());var u=f(r);if(c===z&&ie&&!se.copySortSource)return void(u&&u.removeChild(r));var p,m=Q(c,o);if(null!==m)p=X(c,m,a,n);else{if(!0!==se.revertOnSpill||ie)return void(ie&&u&&u.removeChild(r));p=ae,c=z}(null===p&&d||p!==r&&p!==v(r))&&(ne=p,c.insertBefore(r,p),ce.emit("shadow",r,c,z))}}function j(e){E.rm(e,"gu-hide")}function $(e){ce.dragging&&E.add(e,"gu-hide")}function U(){if(!W){var e=G.getBoundingClientRect();W=G.cloneNode(!0),W.style.width=u(e)+"px",W.style.height=p(e)+"px",E.rm(W,"gu-transit"),E.add(W,"gu-mirror"),se.mirrorContainer.appendChild(W),i(x,"add","mousemove",K),E.add(se.mirrorContainer,"gu-unselectable"),ce.emit("cloned",W,G,"mirror")}}function H(){W&&(E.rm(se.mirrorContainer,"gu-unselectable"),i(x,"remove","mousemove",K),f(W).removeChild(W),W=null)}function Q(e,t){for(var a=t;a!==e&&f(a)!==e;)a=f(a);return a===x?null:a}function X(e,t,a,n){function i(e){return e?v(t):t}var l="horizontal"===se.direction;return t!==e?function(){var e=t.getBoundingClientRect();return i(l?a>e.left+u(e)/2:n>e.top+p(e)/2)}():function(){var t,i,r,o=e.children.length;for(t=0;t<o;t++){if(i=e.children[t],r=i.getBoundingClientRect(),l&&r.left+r.width/2>a)return i;if(!l&&r.top+r.height/2>n)return i}return null}()}function Y(e,t){return"boolean"==typeof se.copy?se.copy:se.copy(e,t)}1===arguments.length&&!1===Array.isArray(e)&&(t=e,e=[]);var W,z,G,J,Z,ee,te,ae,ne,ie,le,re,oe=null,se=t||{};void 0===se.moves&&(se.moves=d),void 0===se.accepts&&(se.accepts=d),void 0===se.invalid&&(se.invalid=I),void 0===se.containers&&(se.containers=e||[]),void 0===se.isContainer&&(se.isContainer=c),void 0===se.copy&&(se.copy=!1),void 0===se.copySortSource&&(se.copySortSource=!1),void 0===se.revertOnSpill&&(se.revertOnSpill=!1),void 0===se.removeOnSpill&&(se.removeOnSpill=!1),void 0===se.direction&&(se.direction="vertical"),void 0===se.ignoreInputTextSelection&&(se.ignoreInputTextSelection=!0),void 0===se.mirrorContainer&&(se.mirrorContainer=k.body);var ce=b({containers:se.containers,start:R,end:M,cancel:L,remove:A,destroy:y,canMove:T,dragging:!1});return!0===se.removeOnSpill&&ce.on("over",j).on("out",$),n(),ce}function i(e,a,n,i){var l={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},r={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},o={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};t.navigator.pointerEnabled?w[a](e,r[n],i):t.navigator.msPointerEnabled?w[a](e,o[n],i):(w[a](e,l[n],i),w[a](e,n,i))}function l(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var t=e.button;return void 0!==t?1&t?1:2&t?3:4&t?2:0:void 0}function r(e){var t=e.getBoundingClientRect();return{left:t.left+o("scrollLeft","pageXOffset"),top:t.top+o("scrollTop","pageYOffset")}}function o(e,a){return"undefined"!=typeof t[a]?t[a]:x.clientHeight?x[e]:k.body[e]}function s(e,t,a){var n,i=e||{},l=i.className;return i.className+=" gu-hide",n=k.elementFromPoint(t,a),i.className=l,n}function c(){return!1}function d(){return!0}function u(e){return e.width||e.right-e.left}function p(e){return e.height||e.bottom-e.top}function f(e){return e.parentNode===k?null:e.parentNode}function m(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||h(e)}function h(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||h(f(e))))}function v(e){return e.nextElementSibling||function(){var t=e;do{t=t.nextSibling}while(t&&1!==t.nodeType);return t}()}function y(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function g(e,t){var a=y(t),n={pageX:"clientX",pageY:"clientY"};return e in n&&!(e in a)&&n[e]in a&&(e=n[e]),a[e]}var b=a(1006),w=a(1010),E=a(1013),k=document,x=k.documentElement;e.exports=n}).call(t,function(){return this}())},1006:function(e,t,a){"use strict";var n=a(1007),i=a(1008);e.exports=function(e,t){var a=t||{},l={};return e===undefined&&(e={}),e.on=function(t,a){return l[t]?l[t].push(a):l[t]=[a],e},e.once=function(t,a){return a._once=!0,e.on(t,a),e},e.off=function(t,a){var n=arguments.length;if(1===n)delete l[t];else if(0===n)l={};else{var i=l[t];if(!i)return e;i.splice(i.indexOf(a),1)}return e},e.emit=function(){var t=n(arguments);return e.emitterSnapshot(t.shift()).apply(this,t)},e.emitterSnapshot=function(t){var r=(l[t]||[]).slice(0);return function(){var l=n(arguments),o=this||e;if("error"===t&&!1!==a["throws"]&&!r.length)throw 1===l.length?l[0]:l;return r.forEach(function(n){a.async?i(n,l,o):n.apply(o,l),n._once&&e.off(t,n)}),e}},e}},1007:function(e,t){e.exports=function(e,t){return Array.prototype.slice.call(e,t)}},1008:function(e,t,a){"use strict";var n=a(1009);e.exports=function(e,t,a){e&&n(function(){e.apply(a||null,t||[])})}},1009:function(e,t,a){(function(t){var a,n="function"==typeof t;a=n?function(e){t(e)}:function(e){setTimeout(e,0)},e.exports=a}).call(t,a(563).setImmediate)},1010:function(e,t,a){(function(t){"use strict";function n(e,t,a,n){return e.addEventListener(t,a,n)}function i(e,t,a){return e.attachEvent("on"+t,c(e,t,a))}function l(e,t,a,n){return e.removeEventListener(t,a,n)}function r(e,t,a){var n=d(e,t,a);if(n)return e.detachEvent("on"+t,n)}function o(e,t,a){var n=-1===f.indexOf(t)?function(){return new p(t,{detail:a})}():function(){var e;return m.createEvent?(e=m.createEvent("Event"),e.initEvent(t,!0,!0)):m.createEventObject&&(e=m.createEventObject()),e}();e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)}function s(e,a,n){return function(a){var i=a||t.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},i.which=i.which||i.keyCode,n.call(e,i)}}function c(e,t,a){var n=d(e,t,a)||s(e,t,a);return y.push({wrapper:n,element:e,type:t,fn:a}),n}function d(e,t,a){var n=u(e,t,a);if(n){var i=y[n].wrapper;return y.splice(n,1),i}}function u(e,t,a){var n,i;for(n=0;n<y.length;n++)if(i=y[n],i.element===e&&i.type===t&&i.fn===a)return n}var p=a(1011),f=a(1012),m=t.document,h=n,v=l,y=[];t.addEventListener||(h=i,v=r),e.exports={add:h,remove:v,fabricate:o}}).call(t,function(){return this}())},1011:function(e,t){(function(t){var a=t.CustomEvent;e.exports=function(){try{var e=new a("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(t){}return!1}()?a:"function"==typeof document.createEvent?function(e,t){var a=document.createEvent("CustomEvent");return t?a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):a.initCustomEvent(e,!1,!1,void 0),a}:function(e,t){var a=document.createEventObject();return a.type=e,t?(a.bubbles=Boolean(t.bubbles),a.cancelable=Boolean(t.cancelable),a.detail=t.detail):(a.bubbles=!1,a.cancelable=!1,a.detail=void 0),a}}).call(t,function(){return this}())},1012:function(e,t){(function(t){"use strict";var a=[],n="",i=/^on/;for(n in t)i.test(n)&&a.push(n.slice(2));e.exports=a}).call(t,function(){return this}())},1013:function(e,t){"use strict";function a(e){var t=l[e];return t?t.lastIndex=0:l[e]=t=new RegExp(r+e+o,"g"),t}function n(e,t){var n=e.className;n.length?a(t).test(n)||(e.className+=" "+t):e.className=t}function i(e,t){e.className=e.className.replace(a(t)," ").trim()}var l={},r="(?:^|\\s)",o="(?:\\s|$)";e.exports={add:n,rm:i}},1014:function(e,t,a){var n=a(1015);"string"==typeof n&&(n=[[e.id,n,""]]);var i={hmr:!0};i.transform=void 0;a(439)(n,i);n.locals&&(e.exports=n.locals)},1015:function(e,t){},1016:function(e,t,a){var n=a(1017);"string"==typeof n&&(n=[[e.id,n,""]]);var i={hmr:!0};i.transform=void 0;a(439)(n,i);n.locals&&(e.exports=n.locals)},1017:function(e,t){}});