webpackJsonp([2],{963:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(14),r=l(n),i=a(687),d=l(i),o=a(54),s=l(o),c=a(55),u=l(c),m=a(59),p=l(m),f=a(93),h=l(f),v=a(8),g=l(v),E=a(4);a(964);var y=function(e){function t(e){(0,s["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.selectree=function(e,t){a.rightClick=!1,a.state.isDisabled=!0,a.formContent(t.node.props.item)},a.handleClick=function(e){a.rightClick=!0,"1"===e.key?(a.formContent(),a.addPlace=0):"2"===e.key?(a.formContent(),a.addPlace=1):"4"===e.key&&(0,E.vpRemove)("{vpodm}/odm/doc/docOper/deleteDocOper/"+a.state.selectId).then(function(e){"VP000000"==e.infocode&&(a.treeRef.removeTreeNode(a.state.selectId),(0,E.VpMsgSuccess)("删除成功！"))})},a.onRightClick=function(e){var t=(e.event,e.node);a.setState({isDisabled:!1,selectId:t.props.id})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t,l){e||(a.rightClick?(t.selectId=a.state.selectId,t.addPlace=a.addPlace,(0,E.vpEdit)("{vpodm}/odm/doc/docOper/saveDocOper",t).then(function(e){if(a.setState({showRightBox:!1}),"VP000000"==e.infocode){var l=e.data;(0,E.VpMsgSuccess)("添加成功！"),t.operId=l,a.treeRef.addTreeNode(a.state.selectId,a.changeToTreeData(t),a.addPlace)}})):(t.tid=a.state.item.tid,t.operId=a.state.item.tid,(0,E.vpEdit)("{vpodm}/odm/doc/docOper/editDocOper",t).then(function(e){a.setState({showRightBox:!1}),"VP000000"==e.infocode&&((0,E.VpMsgSuccess)("修改成功！"),a.treeRef.editTreeData(t.tid,a.changeToTreeData(t)))})))})},a.state={treeData:[],form_content:!1,selectId:"",item:"",parentId:"",isDisabled:!1},a}return(0,h["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this;(0,E.vpQuery)("{vpodm}/odm/doc/docOper/listOperTree","","",5e6).then(function(t){var a=t.data;e.setState({treeData:a,spinStatus:!1})})}},{key:"formContent",value:function(e){this.props.form.resetFields(),this.setState({item:e,form_content:!0})}},{key:"changeToTreeData",value:function(e){var t={};return t.tid=e.operId,t.name=e.name,t.displayIndex=e.dispIndx,t.propertys={code:e.operCode,desc:e.descr},t}},{key:"render",value:function(){var e=this,t=this,a=t.state.item?t.state.item.tid:"",l=g["default"].createElement(E.VpMenu,{onClick:this.handleMenuClick},g["default"].createElement(E.VpMenuItem,{key:"1"},g["default"].createElement("a",{onClick:function(){return e.treeRef.expandedAll()}},"展开全部")),g["default"].createElement(E.VpMenuItem,{key:"2"},g["default"].createElement("a",{onClick:function(){return e.treeRef.closeAll()}},"关闭全部")),g["default"].createElement(E.VpMenuItem,{key:"3"},g["default"].createElement("a",{onClick:function(){return e.treeRef.checkedAll()}},"勾选全部")),g["default"].createElement(E.VpMenuItem,{key:"4"},g["default"].createElement("a",{onClick:function(){return e.treeRef.unCheckedAll()}},"取消全部勾选"))),n=[{key:"1",title:"新增操作【内部】"},{key:"2",title:"新增操作【同级下方】"},{key:"4",title:"删除菜单"}],i=this.props.form.getFieldProps,d={labelCol:{span:5},wrapperCol:{span:17}},o={disabled:t.state.isDisabled};return g["default"].createElement("div",{className:"menu-manage full-height overflow"},g["default"].createElement(E.VpRow,{gutter:16,className:"full-height"},g["default"].createElement(E.VpCol,{span:6,className:"full-height"},g["default"].createElement("div",null,g["default"].createElement("div",{className:"fr"},g["default"].createElement(E.VpDropdown,{overlay:l,type:"ghost"},g["default"].createElement(E.VpIcon,{type:"bars"}))),g["default"].createElement("h4",{className:"p-b-sm fw b-b",style:{lineHeight:2}},"操作树")),g["default"].createElement("div",{className:"full-height bg-white p-sm"},g["default"].createElement("div",{style:{height:"90%"}},g["default"].createElement(E.VpTree,{onSelect:this.selectree,ref:function(t){return e.treeRef=t},treeData:this.state.treeData,filterFn:function(e){return!0},rightItemList:n,rightMenuClick:this.handleClick,onRightClick:this.onRightClick,hasSearch:!0})))),g["default"].createElement(E.VpCol,{span:18,className:"full-height"},g["default"].createElement("div",{className:"bg-white p-sm full-height pr"},g["default"].createElement("h4",{className:"p-b-sm fw b-b"},"菜单详情信息"),g["default"].createElement("div",{className:"p-tb-sm full-height"},this.state.form_content?g["default"].createElement(E.VpForm,{className:"scroll m-b-xxlg",style:{height:"80%"}},g["default"].createElement(E.VpRow,null,g["default"].createElement(E.VpCol,{span:24},g["default"].createElement(E.VpFInput,(0,r["default"])({label:"业务操作名称"},d,i("name",{initialValue:this.state.item?this.state.item.name:"",rules:[{required:!0,message:"请输入业务操作名称"},{validator:function(e,t,l){""!=t?setTimeout(function(){(0,E.vpQuery)("{vpodm}/odm/doc//docOper/vaidName?name="+t+"&operId="+a,"","",5e6).then(function(e){e.data?l():l("业务操作名称重复")})},800):l()}}]}),{placeholder:"请输入业务操作名称"}))),g["default"].createElement(E.VpCol,{span:24},g["default"].createElement(E.VpFInput,(0,r["default"])({label:"业务操作编码"},o,d,i("operCode",{initialValue:this.state.item?this.state.item.propertys.code:"",rules:[{required:!0,message:"请输入业务操作编码"},{validator:function(e,t,l){""!=t?(0,E.vpQuery)("{vpodm}/odm/doc/docOper/vaidCode?operCode="+t+"&operId="+a,"","",5e6).then(function(e){e.data?l():l("业务操作名称重复")}):l()}}]}),{placeholder:"请输入菜单编码"}))),g["default"].createElement(E.VpCol,{span:24},g["default"].createElement(E.VpFInputNumber,(0,r["default"])({label:"显示顺序"},d,i("number"),i("dispIndx",{initialValue:this.state.item?this.state.item.displayIndex:"",rules:[{required:!0,message:"请输入显示显示顺序"}]}),{placeholder:"请输入显示顺序"}))),g["default"].createElement(E.VpCol,{span:24},g["default"].createElement(E.VpFInput,(0,r["default"])({label:"描述",type:"textarea"},d,i("descr",{initialValue:this.state.item?this.state.item.propertys.desc:""}),{placeholder:"请输入描述内容"}))))):"",g["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer",style:{position:"absolute"}},g["default"].createElement(E.VpButton,{style:{marginTop:2},type:"primary",htmlType:"submit",onClick:this.handleSubmit},"保存")))))))}}]),t}(g["default"].Component);y=(0,E.VpFormCreate)(y),t["default"]=y},964:function(e,t,a){var l=a(965);"string"==typeof l&&(l=[[e.id,l,""]]);var n={hmr:!0};n.transform=void 0;a(439)(l,n);l.locals&&(e.exports=l.locals)},965:function(e,t){}});