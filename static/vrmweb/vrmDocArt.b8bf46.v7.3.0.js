webpackJsonp([14],{1021:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(796),s=i(n),l=a(687),r=i(l),c=a(54),o=i(c),h=a(55),u=i(h),d=a(59),f=i(d),p=a(93),m=i(p),y=a(8),v=i(y),k=a(4),g=a(652),b=a(784),S=a(813),w=a(786),V=a(918),C=i(V);a(1022);var E=function(e){function t(e){(0,o["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.renderHeight=function(e,t){var i=vp.computedHeight(t.length,".rsreqTable");a.setState({maxHeight:i,spinStatus:!1})},a.handleClick=function(e){a.state.filtervalue!=e.key&&a.setState({filtervalue:e.key,openKeys:e.keyPath.slice(1),currentkey:e.keyPath.slice(1)[0],spinStatus:!0})},a.onToggle=function(e){a.setState({openKeys:e.open?e.keyPath:e.keyPath.slice(1)})},a.shrinkLeft=function(e){a.setState({shrinkShow:!a.state.shrinkShow})},a.handleLike=function(e,t,i){e.stopPropagation(),(0,k.vpAdd)(b.entityHandLikeUrl,{ientityid:t,iid:i}).then(function(e){a.VpTable.getTableData()})},a.discuss=function(e,t){e.stopPropagation();var i=a.state.entityid,n="entity"+i+"_discuss";a.setState({iid:t.iid,record:t,showWorkSpace:!0,defaultActiveKey:n})},a.rowClick=function(e,t){a.setState({record:e}),a.setState({iid:e.iid,showWorkSpace:!0,defaultActiveKey:"entity"+a.state.entityid+"_attr"},function(){a.props.setBreadCrumb(e.sname)})},a.querySearchFormData=function(){(0,k.vpQuery)("/{vpplat}/vfrm/entity/searchForm",{entityid:a.state.entityid,scode:"search"}).then(function(e){a.setState({SearchFormData:e.data.form})})},a.state={table_headers:[],spinStatus:!1,url:b.entityDataUrl,showWorkSpace:!1,operType:"",loading:!1,searchStr:"",increaseData:"",entityid:56,iid:"",filtervalue:"0",currentkey:"filter",openKeys:["filter"],filters:[],statusFilters:[],classFilters:[],shrinkShow:!0,defaultActiveKey:"0",SearchFormData:{},searchData:[],s_visible:!1,maxHeight:"auto"},a.handlesearch=a.handlesearch.bind(a),a.handleChange=a.handleChange.bind(a),a.saveRowData=a.saveRowData.bind(a),a.handleClick=a.handleClick.bind(a),a.getFilter=a.getFilter.bind(a),a.discuss=a.discuss.bind(a),a.handleLike=a.handleLike.bind(a),a.shrinkLeft=a.shrinkLeft.bind(a),a.getHeader=a.getHeader.bind(a),a.handleMenuClick=a.handleMenuClick.bind(a),a.handleVisibleChange=a.handleVisibleChange.bind(a),a.chooseModalVisible=a.chooseModalVisible.bind(a),a.cancelSearch=a.cancelSearch.bind(a),a.handleSearchForm=a.handleSearchForm.bind(a),a.closeWorkSpace=a.closeWorkSpace.bind(a),a}return(0,m["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.getHeader(),this.getFilter(),this.querySearchFormData(),this.components={},this.components.SearchForm=(0,S.requireFile)("vfm/DynamicForm/SearchForm")}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){return""}}},{key:"getHeader",value:function(){var e=this;(0,k.vpQuery)(b.entityHeaderUrl,{entityid:this.state.entityid,viewcode:"list"}).then(function(t){var a=e.initHeaders(t.data.grid.fields);e.setState({table_headers:a})})}},{key:"getFilter",value:function(){var e=this;(0,k.vpQuery)(b.entityFilterConfigUrl,{entityid:e.state.entityid}).then(function(t){if(t.hasOwnProperty("data")&&t.data.hasOwnProperty("search")){var a=t.data.search.filters,i=t.data.search.statusFilters,n=t.data.search.classFilters;e.setState({filters:a,statusFilters:i||[],classFilters:n||[]})}})}},{key:"initHeaders",value:function(e){var t=this,a=e.map(function(e,t){var a={title:e.field_label,dataIndex:e.field_name,key:e.field_name,sorter:!0,width:e.iwidth};return"istatusid"==e.field_name&&(a.render=function(e,t){return v["default"].createElement("div",{className:"indic-wrapper"},v["default"].createElement(k.VpIconFont,{type:"vpicon-circle-o text-primary",className:"m-r-xs"}),e)}),a}),i={title:"操作",key:"operation",fixed:"right",width:"100",render:function(e,a,i){return v["default"].createElement("div",null,v["default"].createElement(k.VpTooltip,{placement:"top",title:0==a.ilike?"关注":"取消关注"},v["default"].createElement(k.VpIconFont,{onClick:function(e){return t.handleLike(e,a.ientityid,a.iid)},className:"text-primary m-lr-xs cursor",type:1==a.ilike?"vpicon-star":"vpicon-star-o"})),v["default"].createElement(k.VpTooltip,{placement:"top",title:"评论"},v["default"].createElement(k.VpIconFont,{onClick:function(e){return t.discuss(e,a)},className:"text-primary m-lr-xs cursor",type:"vpicon-pinglun"})))}};return a.push(i),a}},{key:"saveRowData",value:function(){alert(1)}},{key:"stopEvent",value:function(e){var t=e;t&&t.stopPropagation?(t.stopPropagation(),t.preventDefault()):window.event&&(t.cancelBubble=!0,t.returnValue=!1)}},{key:"handleMenuClick",value:function(e){(0,k.vpDownLoad)(b.entityExportfileUrl,{filtervalue:this.state.filtervalue,currentkey:this.state.currentkey,quickvalue:this.state.searchStr,ientityid:this.state.entityid,type:"expdata"})}},{key:"handlesearch",value:function(){this.setState({searchData:[],searchStr:this.searchValue,s_visible:!1})}},{key:"handleChange",value:function(e){this.searchValue=e.target.value}},{key:"closeWorkSpace",value:function(e){var t=this;this.setState({showWorkSpace:!1,iid:""},function(){t.props.setBreadCrumb()})}},{key:"handleVisibleChange",value:function(){if(!this.chooseVisible){this.state.SearchFormData.groups.length>0?this.setState({s_visible:!this.state.s_visible}):w.RestAlertMsg.showWarning({msg:"暂无可搜索项，请配置搜索表单！"})}}},{key:"chooseModalVisible",value:function(e){this.chooseVisible=e}},{key:"cancelSearch",value:function(){this.setState({s_visible:!1})}},{key:"handleSearchForm",value:function(e){var t=this;this.setState({searchData:e,searchStr:this.searchValue,s_visible:!1},function(){t.VpTable.getTableData()})}},{key:"render",value:function(){var e=this,t=this.components.SearchForm,a=v["default"].createElement("div",{className:"search-form bg-white ant-dropdown-menu"},v["default"].createElement(t,{chooseModalVisible:this.chooseModalVisible,cancelSearch:this.cancelSearch,handleSearchForm:this.handleSearchForm,formData:this.state.SearchFormData}));return v["default"].createElement("div",{className:"business-container pr full-height entity-docart"},v["default"].createElement("div",{className:"subAssembly b-b bg-white",style:this.props.style},v["default"].createElement(k.VpRow,{gutter:10},v["default"].createElement(k.VpCol,{className:"gutter-row text-right",span:4},v["default"].createElement("div",{className:"m-b-sm search"},v["default"].createElement(g.VpSearchInput,{onPressEnter:this.handlesearch,searchButton:this.handlesearch,onChange:this.handleChange,placeholder:"请输入名称或编号搜索..."}))),v["default"].createElement(k.VpCol,{className:"gutter-row text-right",span:20},v["default"].createElement(k.VpTooltip,{placement:"top",title:"导出"},v["default"].createElement(k.VpButton,{type:"primary",shape:"circle",icon:"cloud-download",className:"m-l-xs",onClick:this.handleMenuClick})),v["default"].createElement(k.VpDropdown,{onClick:this.handleVisibleChange,trigger:["click"],overlay:a,onVisibleChange:this.handleVisibleChange,visible:this.state.s_visible},v["default"].createElement("div",{style:{display:"inline-block"},id:"searchbox"},v["default"].createElement(g.FindCheckbox,null)))))),v["default"].createElement("div",{className:"business-wrapper p-t-sm full-height"},v["default"].createElement("div",{className:"bg-white p-sm full-height entity-rsreqlist"},v["default"].createElement(k.VpRow,{gutter:16,className:"full-height"},v["default"].createElement(k.VpCol,{span:this.state.shrinkShow?"4":"0",className:"full-height menuleft"},v["default"].createElement(k.VpMenu,{className:"full-height scroll-y",onClick:this.handleClick,openKeys:this.state.openKeys,onOpen:this.onToggle,onClose:this.onToggle,selectedKeys:[this.state.filtervalue],mode:"inline"},v["default"].createElement(k.VpSubMenu,{key:"filter",title:v["default"].createElement("span",null,v["default"].createElement(k.VpIconFont,{type:"vpicon-filter",className:"m-r-xs"}),v["default"].createElement("span",null,"过滤器"))},this.state.filters.map(function(e,t){return v["default"].createElement(k.VpMenuItem,{key:e.value},e.name)}))),this.state.shrinkShow?v["default"].createElement("div",{className:"navswitch cursor text-center",onClick:this.shrinkLeft},v["default"].createElement(k.VpIconFont,{type:"vpicon-navclose"})):null),v["default"].createElement(k.VpCol,{span:this.state.shrinkShow?"20":"24",className:"full-height scroll-y"},this.state.shrinkShow?"":v["default"].createElement("div",{className:"shrink p-tb-sm cursor text-center",onClick:this.shrinkLeft},v["default"].createElement(k.VpIconFont,{type:"vpicon-navopen"})),v["default"].createElement(k.VpTable,{ref:function(t){return e.VpTable=t},resize:!0,className:"docArtTable",columns:this.state.table_headers,loading:this.state.spinStatus,controlAddButton:this.renderHeight,scroll:{y:this.state.maxHeight},onRowClick:this.rowClick,dataUrl:"{vpvrm}/vrm/docArt/listPage",params:{condition:(0,s["default"])(this.state.searchData.concat([{field_name:"idata_status",field_value:"0"}])),quickSearch:this.state.searchStr,viewtype:"list",entityid:this.state.entityid,filtervalue:this.state.filtervalue,currentkey:this.state.currentkey}}))))),this.state.showWorkSpace?v["default"].createElement(C["default"],{entityid:this.state.entityid,iid:this.state.iid,defaultActiveKey:this.state.defaultActiveKey,onClose:this.closeWorkSpace,iframeShow:!1}):null)}}]),t}(v["default"].Component);t["default"]=E=(0,k.VpFormCreate)(E)},1022:function(e,t,a){var i=a(1023);"string"==typeof i&&(i=[[e.id,i,""]]);var n={hmr:!0};n.transform=void 0;a(439)(i,n);i.locals&&(e.exports=i.locals)},1023:function(e,t){}});