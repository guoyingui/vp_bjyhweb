webpackJsonp([11],{1009:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(14),s=n(i),r=a(796),l=n(r),o=a(395),c=n(o),d=a(1010),u=n(d),f=a(687),p=n(f),m=a(54),y=n(m),h=a(55),v=n(h),b=a(59),k=n(b),g=a(93),S=n(g),E=a(8),T=n(E),V=a(4),q=a(652),w=a(804),D=n(w),F=a(784);a(922);var x=a(813),_=a(786),R=function(e){function t(e){(0,y["default"])(this,t);var a=(0,k["default"])(this,(t.__proto__||(0,p["default"])(t)).call(this,e));return a.getFormData=function(e,t){var n=a;n.getDynamicTabs(t,e),(0,V.vpQuery)(F.entityFormDataUrl,{entityid:n.state.entityid,iid:e}).then(function(e){n.setState({isAdd:!0,increaseData:e.data.form})})},a.handleViewChange=function(e){var t=e.target.value;a.setState({url:"treelist"==t?"{vpvrm}/vrm/busReq/getTableListData":"list"==t?F.entityDataUrl:"",spinStatus:!0},function(){a.state.viewcode=t,a.state.spinStatus=!1,a.getHeader()})},a.openSelectedTab=function(e,t,n){e.preventDefault();var i=[],s="",r=[];if(t.ientityid==a.state.entityid){r=a.state.busreq_tabs;var l=a.reqTabskey;"reqAnalyse"==n&&(i=[l.reqattr,l.reqdoc,l.reqanalyse,l.reqschedule],s=l.reqanalyse),"reqSplit"==n&&(i=[l.reqattr,l.reqsplit],s=l.reqsplit),"reqAssessMent"==n&&(i=[l.reqattr,l.reqassessment],s=l.reqassessment),"reqAllotTask"==n&&(i=[l.reqattr,l.allottask],s=l.allottask),"reqSysSplit"==n&&(i=[l.reqattr,l.reqsyssplit],s=l.reqsyssplit)}if(t.ientityid==a.state.sysentityid){r=a.state.sysreq_tabs;var o=a.sysReqTabskey;"srReqAnalyse"==n&&(i=[o.sysreqattr,o.sysreqdoc,o.sysreqanalyse],s=o.sysreqanalyse),"srReqEstimation"==n&&(i=[o.sysreqattr,o.estimation],s=o.estimation),"srReqSchedule"==n&&(i=[o.sysreqattr,o.milestone],s=o.milestone)}if(t.ientityid==a.state.taskentityid){r=a.state.task_tabs;var c=a.taskTabskey;"viewDetails"==n&&(i=[c.taskattr],s=c.taskattr)}a.openTabs(t,i,r,s)},a.getTargetTab=function(e,t){var a=[],n=!0,i=!1,s=undefined;try{for(var r,l=(0,u["default"])(e);!(n=(r=l.next()).done);n=!0){var o=r.value;t.indexOf(o.skey)>-1&&(o.iaccesslevel="1",a.push(o))}}catch(c){i=!0,s=c}finally{try{!n&&l["return"]&&l["return"]()}finally{if(i)throw s}}return a},a.openTabs=function(e,t,n,i){var s=a.getTargetTab(n,t);a.loadTabPage(e,s,i)},a.loadTabPage=function(e,t,n){a.setState({iid:e.iid,record:e,tabs_array:t,showRightBox:!0,defaultActiveKey:n})},a.createSysReq=function(e,t){a.restForm(),a.setState({record:t}),e.preventDefault(),a.setState({showRightBox:!0,createType:"sysreq"}),a.getFormDataSys("",t)},a.getFormDataSys=function(e,t){var n=a;n.setState({tabs_array:[]}),(0,V.vpQuery)(F.entityFormDataUrl,{entityid:n.state.sysentityid,iid:e}).then(function(e){var a=!0,i=!1,s=undefined;try{for(var r,l=(0,u["default"])(e.data.form.groups[0].fields);!(a=(r=l.next()).done);a=!0){var o=r.value;if("rbusreq"==o.field_name){o.widget.default_label=t.sname,o.widget.default_value=t.iid;break}}}catch(c){i=!0,s=c}finally{try{!a&&l["return"]&&l["return"]()}finally{if(i)throw s}}n.setState({isAdd:!0,increaseData:e.data.form})})},a.createTask=function(e,t){a.restForm(),a.setState({record:t}),e.preventDefault,a.setState({showRightBox:!0,createType:"task"}),a.getFormDataTask("",t)},a.getFormDataTask=function(e,t){var n=a;n.setState({tabs_array:[]}),(0,V.vpQuery)(F.entityFormDataUrl,{entityid:n.state.taskentityid,iid:e}).then(function(e){var a=!0,i=!1,s=undefined;try{for(var r,l=(0,u["default"])(e.data.form.groups[1].fields);!(a=(r=l.next()).done);a=!0){var o=r.value;if("rlinkxtxq"==o.field_name){o.widget.default_label=t.sname,o.widget.default_value=t.iid;break}}}catch(h){i=!0,s=h}finally{try{!a&&l["return"]&&l["return"]()}finally{if(i)throw s}}var c=!0,d=!1,f=undefined;try{for(var p,m=(0,u["default"])(e.data.form.groups[0].fields);!(c=(p=m.next()).done);c=!0){var y=p.value;if("istatusid"==y.field_name){y.widget.default_label="开发未开始",y.widget.default_value="224";break}}}catch(h){d=!0,f=h}finally{try{!c&&m["return"]&&m["return"]()}finally{if(d)throw f}}n.setState({isAdd:!0,increaseData:e.data.form})})},a.renderTable=function(e,t){var n=vp.computedHeight(t.length,".busreqTable");t.length>0?a.setState({maxHeight:n,spinStatus:!1}):a.setState({spinStatus:!1})},a.restForm=function(){var e=a.props.form,t=[0];e.setFieldsValue({keys:t})},a.add=function(){a.uuid++;var e=a.props.form,t=e.getFieldValue("keys");t=t.concat(a.uuid),e.setFieldsValue({keys:t})},a.remove=function(e){var t=a.props.form,n=t.getFieldValue("keys");n=n.filter(function(t){return t!==e}),t.setFieldsValue({keys:n})},a.handleClick=function(e){a.state.filtervalue!=e.key&&a.setState({filtervalue:e.key,openKeys:e.keyPath.slice(1),currentkey:e.keyPath.slice(1)[0],spinStatus:!0})},a.onToggle=function(e){a.setState({openKeys:e.open?e.keyPath:e.keyPath.slice(1)})},a.shrinkLeft=function(e){a.setState({shrinkShow:!a.state.shrinkShow})},a.handleLike=function(e,t,n){e.stopPropagation(),(0,V.vpAdd)(F.entityHandLikeUrl,{ientityid:t,iid:n}).then(function(e){a.VpTable.getTableData()})},a.discuss=function(e,t){e.stopPropagation();var n=a.state.entityid,i="entity"+n+"_discuss";a.setState({iid:t.iid,record:t,showRightBox:!0,defaultActiveKey:i}),a.getFormData(t.iid,!0)},a.handleButtonSubmitStatus=function(e,t,n){var i=a;if(!n){var s={};(0,c["default"])(t).forEach(function(e,a){t[e]==undefined?t[e]="":null==t[e]&&(t[e]=0),t[e]instanceof Date&&(t[e]=(0,x.formatDateTime)(t[e])),s[e]=t[e]}),a.props.form.validateFields(function(e,t){e||(i.setState({loading_buttonList:!0}),(0,V.vpAdd)("{vpvrm}/vrm/busReq/save",{sparam:(0,l["default"])(s),entityid:i.state.entityid,viewcode:"all"},"",5e9).then(function(e){i.setState({showRightBox:!1,loading_buttonList:!1,startflowFlag:!0,newiid:e.data},function(){i.VpTable.getTableData()})})["catch"](function(e){i.setState({loading:!1})}))})}},a.handleModal=function(e,t){a.restForm(),a.setState({record:t}),e.preventDefault;var n=e.target.getAttribute("data");a.setState({showRightBox:!0,operType:n,createType:"req"}),"add"==n?a.getFormData("",!1):(n="edit")&&a.getFormData(t.iid,!0)},a.rowClick=function(e,t){if(a.setState({record:e}),"list"==a.state.viewcode&&(a.setState({showRightBox:!0,defaultActiveKey:"entity"+a.state.entityid+"_reqoverview"},function(){a.props.setBreadCrumb(e.sname)}),a.getFormData(e.iid,!0)),"treelist"==a.state.viewcode){var n=[],i=[],s="";e.ientityid==a.state.entityid&&(n=[a.reqTabskey.reqattr],i=a.state.busreq_tabs,s=a.reqTabskey.reqattr),e.ientityid==a.state.sysentityid&&(n=[a.sysReqTabskey.sysreqattr],i=a.state.sysreq_tabs,s=a.sysReqTabskey.sysreqattr),e.ientityid==a.state.taskentityid&&(n=[a.taskTabskey.taskattr],i=a.state.task_tabs,s=a.taskTabskey.taskattr),a.openTabs(e,n,i,s)}},a.querySearchFormData=function(){(0,V.vpQuery)("/{vpplat}/vfrm/entity/searchForm",{entityid:a.state.entityid,scode:"search"}).then(function(e){a.setState({SearchFormData:e.data.form})})},a.chooseModalVisible=function(e){a.chooseVisible=e},a.cancelSearch=function(){a.setState({s_visible:!1})},a.handleSearchForm=function(e){a.setState({searchData:e,searchStr:a.searchValue,s_visible:!1},function(){a.VpTable.getTableData()})},a.destoryDom=function(e){a.setState({startflowFlag:!1}),"startflow"==e||a.props.closeRightModal()},a.state={table_headers:[],tabs_array:[],spinStatus:!1,uploader:"",rightBox_type:"",url:F.entityDataUrl,showRightBox:!1,item:"",operType:"",uploadUrl:F.uploadUrl,loading:!1,searchStr:"",increaseData:"",entityid:41,sysentityid:42,taskentityid:114,iid:"",filtervalue:"0",currentkey:"filter",openKeys:["filter"],filters:[],statusFilters:[],classFilters:[],shrinkShow:!0,record:"",defaultActiveKey:"0",SearchFormData:{},searchData:[],s_visible:!1,loading_buttonList:!1,maxHeight:"auto",startflowFlag:!1,newiid:null,viewcode:"list",busreq_tabs:[],sysreq_tabs:[],task_tabs:[],createType:"req"},a.uuid=0,a.reqTabskey={reqattr:"entity41_attr",reqdoc:"entity41_reqdoc",reqanalyse:"entity41_reqanalyse",reqschedule:"entity41_reqschedule",reqsplit:"entity41_reqsplit",reqassessment:"entity41_reqassessment",allottask:"entity41_allottask",reqsyssplit:"entity41_reqsyssplit"},a.sysReqTabskey={sysreqattr:"entity42_attr",sysreqanalyse:"entity42_reqanalyse",sysreqdoc:"entity42_sysreqdoc",estimation:"entity42_estimation",milestone:"entity42_milestone"},a.taskTabskey={taskattr:"entity114_attr"},a.handlesearch=a.handlesearch.bind(a),a.handleChange=a.handleChange.bind(a),a.saveRowData=a.saveRowData.bind(a),a.handleDeletefunction=a.handleDeletefunction.bind(a),a.getDynamicTabs=a.getDynamicTabs.bind(a),a.handleModal=a.handleModal.bind(a),a.handleClick=a.handleClick.bind(a),a.getFilter=a.getFilter.bind(a),a.discuss=a.discuss.bind(a),a.handleLike=a.handleLike.bind(a),a.shrinkLeft=a.shrinkLeft.bind(a),a.getHeader=a.getHeader.bind(a),a.handleMenuClick=a.handleMenuClick.bind(a),a.handleVisibleChange=a.handleVisibleChange.bind(a),a.chooseModalVisible=a.chooseModalVisible.bind(a),a.cancelSearch=a.cancelSearch.bind(a),a.handleSearchForm=a.handleSearchForm.bind(a),a.handleButtonSubmitStatus=a.handleButtonSubmitStatus.bind(a),a.getBusReqTabsArray=a.getBusReqTabsArray.bind(a),a.getSysReqTabsArray=a.getSysReqTabsArray.bind(a),a.getTaskTabsArray=a.getTaskTabsArray.bind(a),a.createSysReq=a.createSysReq.bind(a),a.createTask=a.createTask.bind(a),a.saveSysReq=a.saveSysReq.bind(a),a.saveTask=a.saveTask.bind(a),a.openSelectedTab=a.openSelectedTab.bind(a),a}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentWillMount",value:function(){this.getHeader(),this.getFilter(),this.getBusReqTabsArray(),this.getSysReqTabsArray(),this.getTaskTabsArray(),this.querySearchFormData(),this.components={},this.components.SearchForm=(0,x.requireFile)("vfm/DynamicForm/SearchForm"),this.components.FirstFlow=(0,x.requireFile)("vfm/DynamicForm/firstflow")}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){return""}}},{key:"getHeader",value:function(){var e=this,t=this;(0,V.vpQuery)(F.entityHeaderUrl,{entityid:this.state.entityid,scode:t.state.viewcode}).then(function(t){var a=e.initHeaders(t.data.grid.fields);e.setState({table_headers:a})})}},{key:"getBusReqTabsArray",value:function(){var e=this;(0,V.vpAdd)(F.entityDynamicTabsUrl,{entityid:e.state.entityid,iid:null,functionid:-100}).then(function(t){var a=t.data.tabs;e.setState({busreq_tabs:a})})}},{key:"getSysReqTabsArray",value:function(){var e=this;(0,V.vpAdd)(F.entityDynamicTabsUrl,{entityid:e.state.sysentityid,iid:null,functionid:-100}).then(function(t){var a=t.data.tabs;e.setState({sysreq_tabs:a})})}},{key:"getTaskTabsArray",value:function(){var e=this;(0,V.vpAdd)(F.entityDynamicTabsUrl,{entityid:this.state.taskentityid,iid:null,functionid:-100}).then(function(t){var a=t.data.tabs;e.setState({task_tabs:a})})}},{key:"saveSysReq",value:function(e,t){t.preventDefault();var a=this,n={};(0,c["default"])(e).forEach(function(t,a){e[t]==undefined?e[t]="":null==e[t]&&(e[t]=0),e[t]instanceof Date&&(e[t]=(0,x.formatDateTime)(e[t])),n[t]=e[t]}),this.props.form.validateFields(function(e,t){e||(a.setState({loading:!0}),(0,V.vpAdd)("{vpvrm}/vrm/busReq/save",{sparam:(0,l["default"])(n),entityid:a.state.sysentityid,viewcode:"all"},"",5e9).then(function(e){a.setState({showRightBox:!1,loading:!1},a.VpTable.getTableData())})["catch"](function(e){a.setState({loading:!1})}))})}},{key:"saveTask",value:function(e,t){t.preventDefault();var a=this,n={};(0,c["default"])(e).forEach(function(t,a){e[t]==undefined?e[t]="":null==e[t]&&(e[t]=0),e[t]instanceof Date&&(e[t]=(0,x.formatDateTime)(e[t])),n[t]=e[t]}),this.props.form.validateFields(function(e,t){e||(a.setState({loading:!0}),(0,V.vpAdd)("/{vpplat}/vfrm/entity/saveFormData",{sparam:(0,l["default"])(n),entityid:a.state.taskentityid,viewcode:"form",variid:0},"",5e9).then(function(e){a.setState({showRightBox:!1,loading:!1},a.VpTable.getTableData())})["catch"](function(e){a.setState({loading:!1})}))})}},{key:"getFilter",value:function(){var e=this;(0,V.vpQuery)(F.entityFilterConfigUrl,{entityid:e.state.entityid}).then(function(t){if(t.hasOwnProperty("data")&&t.data.hasOwnProperty("search")){var a=t.data.search.filters,n=t.data.search.statusFilters,i=t.data.search.classFilters;e.setState({filters:a,statusFilters:n||[],classFilters:i||[]})}})}},{key:"initHeaders",value:function(e){var t=this,a=this,n=e.map(function(e,t){var a={title:e.field_label,dataIndex:e.field_name,key:e.field_name,sorter:!0,width:e.iwidth};return"istatusid"==e.field_name&&(a.render=function(e,t){return T["default"].createElement("div",{className:"indic-wrapper"},T["default"].createElement(V.VpIconFont,{type:"vpicon-circle-o text-primary",className:"m-r-xs"}),e)}),a}),i={title:"操作",key:"operation",fixed:"right",width:"120",render:function(e,n,i){var s=T["default"].createElement(V.VpMenu,null,T["default"].createElement(V.VpMenuItem,{key:"0"},T["default"].createElement("div",{onClick:function(e){return t.createSysReq(e,n)}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"新建系统需求")),T["default"].createElement(V.VpMenuItem,{key:"2"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"reqAnalyse")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"需求分析")),T["default"].createElement(V.VpMenuItem,{key:"3"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"reqSplit")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary"}),"需求拆分")),T["default"].createElement(V.VpMenuItem,{key:"5"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"reqAssessMent")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"需求评估")),T["default"].createElement(V.VpMenuItem,{key:"6"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"reqAllotTask")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"需求评审")),T["default"].createElement(V.VpMenuItem,{key:"7"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"reqSysSplit")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"下发具体需求分析任务"))),r=T["default"].createElement(V.VpMenu,null,T["default"].createElement(V.VpMenuItem,{key:"0"},T["default"].createElement("div",{onClick:function(e){return t.createTask(e,n)}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"新建任务")),T["default"].createElement(V.VpMenuItem,{key:"1"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"srReqAnalyse")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"具体需求分析")),T["default"].createElement(V.VpMenuItem,{key:"2"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"srReqEstimation")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"系统需求评估")),T["default"].createElement(V.VpMenuItem,{key:"3"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"srReqSchedule")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"系统需求排期"))),l=T["default"].createElement(V.VpMenu,null,T["default"].createElement(V.VpMenuItem,{key:"0"},T["default"].createElement("div",{onClick:function(e){return t.openSelectedTab(e,n,"viewDetails")}},T["default"].createElement(V.VpIconFont,{className:"cursor m-r-xs f16 text-primary",type:""}),"查看详情")));return T["default"].createElement("div",null,T["default"].createElement(V.VpTooltip,{placement:"top",title:0==n.ilike?"关注":"取消关注"},T["default"].createElement(V.VpIconFont,{onClick:function(e){return a.handleLike(e,n.ientityid,n.iid)},className:"text-primary m-lr-xs cursor",type:1==n.ilike?"vpicon-star":"vpicon-star-o"})),T["default"].createElement(V.VpTooltip,{placement:"top",title:"评论"},T["default"].createElement(V.VpIconFont,{onClick:function(e){return a.discuss(e,n)},className:"text-primary m-lr-xs cursor",type:"vpicon-pinglun"})),T["default"].createElement(V.VpTooltip,{placement:"top",title:"删除","data-id":n.iid},T["default"].createElement(V.VpPopconfirm,{title:"确定删除?",onConfirm:function(){return t.handleDeletefunction(n)}},T["default"].createElement(V.VpIcon,{type:"vpicon-shanchu",onClick:function(e){return t.stopEvent(e)},className:"cursor m-lr-xs f16 text-danger"}))),"treelist"==a.state.viewcode?T["default"].createElement(V.VpTooltip,{placement:"top",title:"更多"},T["default"].createElement("span",{className:"m-lr-xs cursor"},T["default"].createElement(V.VpDropdown,{overlay:n.ientityid==a.state.entityid?s:n.ientityid==a.state.sysentityid?r:n.ientityid==a.state.taskentityid?l:null,trigger:["click"],getPopupContainer:function(e){return document.getElementById("table")}},T["default"].createElement(V.VpIcon,{"data-id":n.iid,className:"cursor",type:"ellipsis",onClick:function(e){return e.stopPropagation()}})))):"list"==a.state.viewcode?T["default"].createElement(V.VpTooltip,{placement:"top",title:"更多"},T["default"].createElement("span",{className:"m-lr-xs cursor"},T["default"].createElement(V.VpDropdown,{overlay:s,trigger:["click"],getPopupContainer:function(e){return document.getElementById("table")}},T["default"].createElement(V.VpIcon,{"data-id":n.iid,className:"cursor",type:"ellipsis",onClick:function(e){return e.stopPropagation()}})))):null)}};return n.push(i),n}},{key:"stopEvent",value:function(e){var t=e;t&&t.stopPropagation?(t.stopPropagation(),t.preventDefault()):window.event&&(t.cancelBubble=!0,t.returnValue=!1)}},{key:"saveRowData",value:function(e,t){t.preventDefault();var a=this,n=(a.props.irelationentity,{});(0,c["default"])(e).forEach(function(t,a){e[t]==undefined?e[t]="":null==e[t]&&(e[t]=0),e[t]instanceof Date&&(e[t]=(0,x.formatDateTime)(e[t])),n[t]=e[t]}),this.props.form.validateFields(function(e,t){e||(a.setState({loading:!0}),(0,V.vpAdd)("{vpvrm}/vrm/busReq/save",{sparam:(0,l["default"])(n),entityid:a.state.entityid,viewcode:"all"},"",5e9).then(function(e){a.setState({showRightBox:!1,loading:!1},a.VpTable.getTableData())})["catch"](function(e){a.setState({loading:!1})}))})}},{key:"handleDeletefunction",value:function(e){var t=this;e.ientityid==t.state.entityid&&(t.setState({spinStatus:!0}),(0,V.vpRemove)("{vpvrm}/vrm/busReq/delete",{iid:e.iid,entityid:t.state.entityid},"",5e9).then(function(e){t.setState({spinStatus:!1}),t.VpTable.getTableData(),_.RestAlertMsg.showSuccess({msg:"删除成功！"})})["catch"](function(e){t.setState({spinStatus:!1})})),e.ientityid==t.state.sysentityid&&(t.setState({spinStatus:!0}),(0,V.vpRemove)("{vpvrm}/vrm/busReq/delete",{iid:e.iid,entityid:t.state.sysentityid},"",5e9).then(function(e){t.setState({spinStatus:!1}),t.VpTable.getTableData(),_.RestAlertMsg.showSuccess({msg:"删除成功！"})})["catch"](function(e){t.setState({spinStatus:!1})})),e.ientityid==t.state.taskentityid&&(t.setState({spinStatus:!0}),(0,V.vpAdd)(F.entityDeleteDataUrl,{iid:e.iid,entityid:t.state.taskentityid},"",5e9).then(function(e){t.setState({spinStatus:!1}),t.VpTable.getTableData(),_.RestAlertMsg.showSuccess({msg:"删除成功！"})})["catch"](function(e){t.setState({spinStatus:!1})}))}},{key:"handleMenuClick",value:function(e){(0,V.vpDownLoad)(F.entityExportfileUrl,{filtervalue:this.state.filtervalue,currentkey:this.state.currentkey,quickvalue:this.state.searchStr,ientityid:this.state.entityid,type:"expdata"})}},{key:"getDynamicTabs",value:function(e,t){var a=this;e?(0,V.vpAdd)(F.entityDynamicTabsUrl,{entityid:this.state.entityid,iid:t}).then(function(e){var t=e.data.tabs;a.setState({tabs_array:t})}):this.setState({tabs_array:[]})}},{key:"editDom",value:function(){var e=this;if(this.state.showRightBox){var t=(this.uuid,this.props.form),a=t.getFieldProps,n=t.getFieldValue;a("keys",{initialValue:[0]});var i={labelCol:{span:6},wrapperCol:{span:14}};n("keys").map(function(t,n){return T["default"].createElement(V.VpCol,{key:t,span:12},T["default"].createElement("div",{className:"p-tb-sm pr accessoy-box"},T["default"].createElement(V.VpTooltip,{placement:"top",title:"删除"},T["default"].createElement(V.VpIconFont,{className:"cursor delete",type:"vpicon-close",onClick:function(){return e.remove(t)}})),T["default"].createElement(V.VpFSelect,(0,s["default"])({label:"附件类型"},i,a("atch_type"+n,{initialValue:"1"})),T["default"].createElement(V.VpSelect,{defaultValue:"1",className:"block"},T["default"].createElement(V.VpOption,{value:"1"},"业务需求说明书"))),T["default"].createElement(V.VpFInput,(0,s["default"])({label:"版本"},i,{placeholder:"请输入版本号"},a("name"+n,{initialValue:"1.0",rules:[{required:!0,message:"请输入版本号"}]}))),T["default"].createElement(V.VpInputUploader,(0,s["default"])({key:t,form:e.props.form,item:{field_name:"doc"+n,widget_type:"inputupload",validator:{required:!0},field_label:"选择文档",all_line:2,tips:"请选择文档（*.doc,*.docx)",widget:{accept:{title:"Doc",extensions:"docx,doc",mimeTypes:".docx,.doc"},upload_url:e.state.uploadUrl}},placeholder:"请输入描述内容"},i)),T["default"].createElement(V.VpFInput,(0,s["default"])({label:"描述",type:"textarea"},i))))});return T["default"].createElement(V.VpTabs,{defaultActiveKey:this.state.defaultActiveKey,destroyInactiveTabPane:!0},this.state.tabs_array.length?this.state.tabs_array.map(function(t,a){var n=e;if(t.staburl){if("1"==t.ilinktype)return T["default"].createElement(V.VpTabPane,{tab:t.sname,key:t.skey},T["default"].createElement(V.VpIframe,{url:t.staburl+"?entityid="+n.state.entityid+"&iid="+n.state.record.iid}));var i=t.staburl.split("?"),s=i[0],r="";i.length>1&&(r=i[1]);var l=(0,x.requireFile)(s);return T["default"].createElement(V.VpTabPane,{tab:t.sname,key:t.skey},l?T["default"].createElement(l,{skey:t.skey,stabparam:r,isflow:!1,formData:n.state.increaseData,entityid:n.state.record.ientityid,iid:n.state.record.iid,reqname:n.state.record.sname,scode:n.state.record.scode,iaccesslevel:t.iaccesslevel,entityrole:"1"==t.iaccesslevel,add:!1,row_id:n.state.record.iid,row_entityid:n.state.record.ientityid,closeRightModal:function(){return n.closeRightModal()},refreshList:function(){return n.VpTable.getTableData()},busObjType:2,inamerole:n.state.record.inamerole,rbr_proposer_person:n.state.record.rbr_proposer_person,brname:n.state.record.sname+"-"+n.state.record.scode}):null)}return T["default"].createElement(V.VpTabPane,{tab:t.sname,key:a+"tabs"})}):"req"==this.state.createType?T["default"].createElement(V.VpTabPane,{tab:"属性",key:0},T["default"].createElement(q.VpDynamicForm,{formData:this.state.increaseData,form:this.props.form,okText:"保存",buttonList:[{loading:this.state.loading_buttonList,sname:"保存&提交",type:"primary",iid:"saveStartFlow",visible:!0,disabled:!1}],handleOk:this.saveRowData,handleStatus:this.handleButtonSubmitStatus,loading:this.state.loading})):"sysreq"==this.state.createType?T["default"].createElement(V.VpTabPane,{tab:"新建系统需求",key:0},T["default"].createElement(q.VpDynamicForm,{formData:this.state.increaseData,form:this.props.form,okText:"保存",handleOk:this.saveSysReq,loading:this.state.loading})):"task"==this.state.createType?T["default"].createElement(V.VpTabPane,{tab:"新建任务",key:0},T["default"].createElement(q.VpDynamicForm,{formData:this.state.increaseData,form:this.props.form,okText:"保存",handleOk:this.saveTask,loading:this.state.loading})):null)}return""}},{key:"handlesearch",value:function(){this.setState({searchData:[],searchStr:this.searchValue,s_visible:!1})}},{key:"handleChange",value:function(e){this.searchValue=e.target.value}},{key:"closeRightModal",value:function(e){var t=this;t.setState({showRightBox:!1,rightBox_type:""},function(){t.props.setBreadCrumb()}),t.state.defaultActiveKey==this.taskTabskey.taskattr&&t.VpTable.getTableData()}},{key:"handleVisibleChange",value:function(){if(!this.chooseVisible){this.state.SearchFormData.groups.length>0?this.setState({s_visible:!this.state.s_visible}):_.RestAlertMsg.showWarning({msg:"暂无可搜索项，请配置搜索表单！"})}}},{key:"render",value:function(){var e=this,t=this,a=this.components.SearchForm,n=this.components.FirstFlow,i=T["default"].createElement("div",{className:"search-form bg-white ant-dropdown-menu"},T["default"].createElement(a,{clearSearch:this.clearSearch,chooseModalVisible:this.chooseModalVisible,cancelSearch:this.cancelSearch,handleSearchForm:this.handleSearchForm,formData:this.state.SearchFormData}));return T["default"].createElement("div",{className:"business-container pr full-height entity-bsreq"},T["default"].createElement("div",{className:"subAssembly b-b bg-white",style:t.props.style},T["default"].createElement(V.VpRow,{gutter:10},T["default"].createElement(V.VpCol,{span:4},T["default"].createElement("div",{className:"m-b-sm search"},T["default"].createElement(q.VpSearchInput,{onPressEnter:t.handlesearch,searchButton:t.handlesearch,onChange:t.handleChange,placeholder:"请输入名称或编号搜索..."}))),T["default"].createElement(V.VpCol,{className:"gutter-row text-right",span:20},T["default"].createElement(V.VpTooltip,{placement:"top",title:"快速创建"},T["default"].createElement(V.VpButton,{onClick:t.handleModal,data:"add",type:"primary",className:"m-l-xs",shape:"circle"},T["default"].createElement(V.VpIcon,{data:"add",type:"plus"}))),T["default"].createElement(V.VpTooltip,{placement:"top",title:"导出"},T["default"].createElement(V.VpButton,{type:"primary",shape:"circle",icon:"cloud-download",className:"m-l-xs",onClick:this.handleMenuClick})),T["default"].createElement(V.VpDropdown,{onClick:this.handleVisibleChange,trigger:["click"],overlay:i,onVisibleChange:this.handleVisibleChange,visible:this.state.s_visible},T["default"].createElement("div",{style:{display:"inline-block"},id:"searchbox"},T["default"].createElement(q.FindCheckbox,null))),T["default"].createElement("div",{className:"fr m-l-xs"},T["default"].createElement(V.VpRadioGroup,{defaultValue:"list",className:"radio-tab",onChange:this.handleViewChange},T["default"].createElement(V.VpRadioButton,{value:"treelist"},T["default"].createElement(V.VpTooltip,{placement:"top",title:"树表视图"},T["default"].createElement(V.VpIconFont,{type:"vpicon-file-tree"}))),T["default"].createElement(V.VpRadioButton,{value:"list"},T["default"].createElement(V.VpTooltip,{placement:"top",title:"列表视图"},T["default"].createElement(V.VpIconFont,{type:"vpicon-navlist"})))))))),T["default"].createElement("div",{className:"business-wrapper p-t-sm full-height"},T["default"].createElement("div",{className:"bg-white p-sm full-height entity-bsreqlist"},T["default"].createElement(V.VpRow,{gutter:16,className:"full-height"},T["default"].createElement(V.VpCol,{span:t.state.shrinkShow?"4":"0",className:"full-height pr menuleft"},T["default"].createElement("div",{className:"full-height scroll"},T["default"].createElement(V.VpMenu,{className:"full-height",onClick:t.handleClick,openKeys:t.state.openKeys,onOpen:t.onToggle,onClose:t.onToggle,selectedKeys:[t.state.filtervalue],style:{fontSize:14},mode:"inline"},T["default"].createElement(V.VpSubMenu,{key:"filter",title:T["default"].createElement("span",null,T["default"].createElement(V.VpIconFont,{type:"vpicon-filter",className:"m-r-xs"}),T["default"].createElement("span",null,"过滤器"))},t.state.filters.map(function(e,t){return T["default"].createElement(V.VpMenuItem,{key:e.value},e.name)})),T["default"].createElement(V.VpSubMenu,{key:"status",title:T["default"].createElement("span",null,T["default"].createElement(V.VpIconFont,{type:"vpicon-loading",className:"m-r-xs"}),T["default"].createElement("span",null,"状态"))},t.state.statusFilters.map(function(e,t){return T["default"].createElement(V.VpMenuItem,{key:e.value},e.name)}),T["default"].createElement(V.VpMenuItem,{key:"0"},"全部")),T["default"].createElement(V.VpSubMenu,{key:"class",title:T["default"].createElement("span",null,T["default"].createElement(V.VpIconFont,{type:"vpicon-fenlei",className:"m-r-xs"}),T["default"].createElement("span",null,"类别"))},this.state.classFilters.map(function(e,t){return T["default"].createElement(V.VpMenuItem,{key:e.value},e.name)}),T["default"].createElement(V.VpMenuItem,{key:"0"},"全部")))),t.state.shrinkShow?T["default"].createElement("div",{className:"navswitch cursor text-center",onClick:t.shrinkLeft},T["default"].createElement(V.VpIconFont,{type:"vpicon-navclose"})):null),T["default"].createElement(V.VpCol,{span:t.state.shrinkShow?"20":"24",className:"full-height scroll-y",id:"table"},t.state.shrinkShow?null:T["default"].createElement("div",{className:"shrink p-tb-sm cursor text-center",onClick:t.shrinkLeft},T["default"].createElement(V.VpIconFont,{type:"vpicon-navopen"})),T["default"].createElement(V.VpTable,{ref:function(e){return t.VpTable=e},resize:!0,className:"busreqTable",controlAddButton:t.renderTable,loading:t.state.spinStatus,columns:t.state.table_headers,onRowClick:t.rowClick,scroll:{y:t.state.maxHeight},dataUrl:t.state.url,params:{condition:(0,l["default"])(t.state.searchData),quickSearch:t.state.searchStr,viewtype:"list",entityid:t.state.entityid,filtervalue:t.state.filtervalue,currentkey:t.state.currentkey}}))))),T["default"].createElement(q.RightBox,{max:"true",button:T["default"].createElement("div",{className:"icon p-xs",onClick:t.closeRightModal.bind(t)},T["default"].createElement(V.VpTooltip,{placement:"top",title:D["default"].drawerSpinIcon[window.LOCALE]},T["default"].createElement(V.VpIcon,{type:"right"}))),show:t.state.showRightBox},t.editDom()),this.state.startflowFlag?T["default"].createElement(n,{showfirstnodepage:!1,flowtype:!1,entityid:this.state.entityid,iid:this.state.newiid,destoryDom:function(t){return e.destoryDom(t)}}):null)}}]),t}(T["default"].Component);t["default"]=R=(0,V.VpFormCreate)(R)},1010:function(e,t,a){e.exports={"default":a(1011),__esModule:!0}},1011:function(e,t,a){a(75),a(63),e.exports=a(1012)},1012:function(e,t,a){var n=a(25),i=a(370);e.exports=a(20).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}}});