webpackJsonp([3],{966:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(14),c=l(n),s=a(687),d=l(s),r=a(54),o=l(r),i=a(55),u=l(i),h=a(59),f=l(h),m=a(93),p=l(m),b=a(8),v=l(b),S=a(4),E=a(652);a(967);var y=function(e){function t(e){(0,o["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.handlesearch=function(){a.setState({searchStr:a.searchValue},function(){a.VpTable.getTableData()})},a.selectree=function(e,t){console.log(e)},a.handleModal=function(e){a.props.form.resetFields();var t=e.target.getAttribute("data");a.event_obj=t,"add"==t?(a.title="新增业务场景",a.record="",a.setState({visible:!0,isDisabled:!1})):a.record&&(a.title="编辑业务场景",a.setState({visible:!0,isDisabled:!0}))},a.handleSubmit=function(e){e.preventDefault();a.props.form.validateFields(function(e,t){if(e)return void console.log("Errors in form!!!");"add"==a.event_obj?(0,S.vpEdit)("{vpodm}/odm/doc/docBusScene/saveBusScene",t).then(function(e){"VP000000"==e.infocode&&(a.VpTable.getTableData(),(0,S.VpMsgSuccess)("添加成功！"))}):(t.busSceneId=a.record.bussceneid,(0,S.vpEdit)("{vpodm}/odm/doc/docBusScene/editBusScene",t).then(function(e){"VP000000"==e.infocode&&(a.VpTable.getTableData(),(0,S.VpMsgSuccess)("修改成功！"))})),a.setState({visible:!1})})},a.handleCancel=function(e){a.setState({visible:!1})},a.handleSaveBusOper=function(e){var t=a,l=t.state.checkedKeys;(0,S.vpAdd)("{vpodm}/odm/doc/docBusSceneOper/saveBusSceneOper",{busSceneCode:t.state.record.busscenecode,operIds:l},"",6e5).then(function(e){(0,S.VpMsgSuccess)("保存成功！")})},a.handleDelete=function(){var e=a;a.record&&(0,S.VpConfirm)({title:"您是否确认要删除这项内容?",onOk:function(){(0,S.vpRemove)("{vpodm}/odm/doc/docBusScene/deleteBusScene/"+e.record.bussceneid).then(function(t){if("VP000000"==t.infocode){t.data;e.VpTable.getTableData(),(0,S.VpMsgSuccess)("删除成功！")}})},onCancel:function(){}})},a.onChange=function(e,t){a.state.selectedRowKeys=e},a.onSelect=function(e,t,l){a.record=e,a.setState({record:e}),a.getTreeData(e.busscenecode)},a.state={treeData:[],tableHeader:[],tableDate:[],visible:!1,selectedRowKeys:"",defaultCheckedKeys:[],checkedKeys:[],record:"",url:"{vpodm}/odm/doc/docBusScene/listBusScene",searchStr:"",isDisabled:!1},a.num=0,a.handlesearch=a.handlesearch.bind(a),a.handleChange=a.handleChange.bind(a),a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.getColumns()}},{key:"getColumns",value:function(e){var t=[{title:"序号",width:"50",dataIndex:"row_id",key:"row_id"},{title:"业务场景名称",dataIndex:"name",key:"name"},{title:"业务场景编码",dataIndex:"busscenecode",key:"busscenecode"}];this.setState({tableHeader:t})}},{key:"getTreeData",value:function(e){var t=this;console.log(e),(0,S.vpQuery)("{vpodm}/odm/doc/docOper/listOperTree","","",5e6).then(function(a){t.setState({treeData:a.data},function(){t.treeRef.setNewData(t.state.treeData),(0,S.vpQuery)("{vpodm}/odm/doc/docBusSceneOper/getBusSceneOperIds",{busSceneCode:e},"",5e6).then(function(e){t.setState({defaultCheckedKeys:e.data},function(){t.treeRef.checkedTree(t.state.defaultCheckedKeys)})})})})}},{key:"handleChange",value:function(e){this.searchValue=e.target.value}},{key:"onCheck",value:function(e,t){var a=t.halfCheckedKeys.concat(e);this.setState({checkedKeys:a})}},{key:"render",value:function(){var e=this,t=this.state.record?this.state.record.bussceneid:"",a=[{key:"1",title:"菜单项"}],l={type:"radio",onSelect:this.onSelect,onChange:this.onChange,selectedRowKeys:this.state.selectedRowKeys},n={labelCol:{span:6},wrapperCol:{span:14}},s=this.props.form.getFieldProps,d=v["default"].createElement(S.VpMenu,{onClick:this.handleMenuClick},v["default"].createElement(S.VpMenuItem,{key:"1"},v["default"].createElement("a",{onClick:function(){return e.treeRef.expandedAll()}},"展开全部")),v["default"].createElement(S.VpMenuItem,{key:"2"},v["default"].createElement("a",{onClick:function(){return e.treeRef.closeAll()}},"关闭全部")),v["default"].createElement(S.VpMenuItem,{key:"3"},v["default"].createElement("a",{onClick:function(){return e.treeRef.checkedAll()}},"勾选全部")),v["default"].createElement(S.VpMenuItem,{key:"4"},v["default"].createElement("a",{onClick:function(){return e.treeRef.unCheckedAll()}},"取消全部勾选"))),r={disabled:this.state.isDisabled};return v["default"].createElement("div",{className:"role-manage full-height overflow"},v["default"].createElement(S.VpRow,{gutter:16,className:"full-height"},v["default"].createElement(S.VpCol,{span:16,className:"full-height"},v["default"].createElement("div",{className:"full-height bg-white p-sm"},v["default"].createElement(S.VpRow,{className:"p-b-sm b-b"},v["default"].createElement(S.VpCol,{span:4},v["default"].createElement("h4",{className:"fw",style:{lineHeight:2}},"业务场景列表")),v["default"].createElement(S.VpCol,{span:8},v["default"].createElement(S.VpInputGroup,{className:"inline-block"},v["default"].createElement(E.VpSearchInput,{onPressEnter:this.handlesearch,searchButton:this.handlesearch,onChange:this.handleChange,placeholder:"请输入场景名称搜索..."}))),v["default"].createElement(S.VpCol,{span:12,className:"text-right"},v["default"].createElement(S.VpButton,{onClick:this.handleModal,data:"add",type:"primary",className:"m-l-xs",shape:"circle"},v["default"].createElement(S.VpIcon,{data:"add",type:"plus"})),v["default"].createElement(S.VpButton,{onClick:this.handleModal,data:"edit",className:"m-l-xs",shape:"circle"},v["default"].createElement(S.VpIcon,{data:"edit",type:"edit"})),v["default"].createElement(S.VpButton,{onClick:this.handleDelete,className:"m-l-xs",shape:"circle",icon:"delete"}))),v["default"].createElement("div",{className:"p-tb-sm"},v["default"].createElement(S.VpTable,{ref:function(t){return e.VpTable=t},rowSelection:l,columns:this.state.tableHeader,dataUrl:this.state.url,queryMethod:"GET",params:{searchStr:this.state.searchStr}}),v["default"].createElement(S.VpModal,{title:this.title,visible:this.state.visible,onCancel:this.handleCancel,footer:v["default"].createElement("div",{className:"text-center"},v["default"].createElement(S.VpButton,{onClick:this.handleSubmit,type:"primary",className:"m-l-xs"},"确定"),v["default"].createElement(S.VpButton,{onClick:this.handleCancel,className:"m-l-xs"},"取消"))},v["default"].createElement(S.VpForm,{horizontal:!0,onSubmit:this.handleSubmit},v["default"].createElement(S.VpFInput,(0,c["default"])({label:"业务场景名称"},s("name",{initialValue:this.record?this.record.name:"",rules:[{required:!0,message:"请输入业务场景名称"},{validator:function(e,a,l){""!=a?(0,S.vpQuery)("{vpodm}/odm/doc/docBusScene/vaidName?name="+a+"&busSceneId="+t,"","",5e6).then(function(e){e.data?l():setTimeout(function(){l("业务场景名称重复")},100)}):l()}}]}),n,{placeholder:"请输入业务场景名称"})),v["default"].createElement(S.VpFInput,(0,c["default"])({label:"业务场景编码"},r,s("busSceneCode",{initialValue:this.record?this.record.busscenecode:"",rules:[{required:!0,message:"请输入业务场景编码"},{validator:function(e,a,l){a?l():setTimeout(function(){(0,S.vpQuery)("{vpodm}/odm/doc/docBusScene/vaidCode?busSceneCode="+a+"&busSceneId="+t,"","",5e6).then(function(e){e.data?l():l("业务场景编码重复")})},800)}}]}),n,{placeholder:"请输入业务场景编码"})),v["default"].createElement(S.VpFInput,(0,c["default"])({label:"业务场景描述"},s("descr",{initialValue:this.record?this.record.descr:""}),{type:"textarea"},n,{placeholder:"请输入角色描述"}))))))),v["default"].createElement(S.VpCol,{span:8,className:"full-height"},v["default"].createElement("div",{className:"full-height bg-white p-sm  pr"},v["default"].createElement("div",null,v["default"].createElement("div",{className:"fr"},v["default"].createElement(S.VpDropdown,{overlay:d,type:"ghost"},v["default"].createElement(S.VpIcon,{type:"bars"}))),v["default"].createElement("h4",{className:"p-b-sm fw b-b",style:{lineHeight:2}},"操作树")),v["default"].createElement("div",{className:"role-tree",style:{height:"80%"}},v["default"].createElement(S.VpTree,{checkable:!0,onSelect:this.selectree,ref:function(t){return e.treeRef=t},treeData:this.state.treeData,filterFn:function(e){return!0},rightItemList:a,onCheck:this.onCheck.bind(this),hasSearch:!0}),v["default"].createElement("div",{className:"footer-button-wrap ant-modal-footer",style:{position:"absolute"}},v["default"].createElement(S.VpButton,{style:{marginTop:2},type:"primary",onClick:this.handleSaveBusOper},"保存")))))))}}]),t}(v["default"].Component);y=(0,S.VpFormCreate)(y),t["default"]=y},967:function(e,t,a){var l=a(968);"string"==typeof l&&(l=[[e.id,l,""]]);var n={hmr:!0};n.transform=void 0;a(439)(l,n);l.locals&&(e.exports=l.locals)},968:function(e,t){}});